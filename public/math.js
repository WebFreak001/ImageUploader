/* MathLib.min.js */
/*! MathLib v0.7.3 MathLib.de | MathLib.de/en/license */
var MathLib;!function(MathLib){"use strict";MathLib.version="0.7.3",MathLib.apery=1.2020569031595942,MathLib.e=Math.E,MathLib.epsilon=Number.EPSILON||function(){var next,result;for(next=1;1+next!==1;next/=2)result=next;return result}(),MathLib.eulerMascheroni=.5772156649015329,MathLib.goldenRatio=1.618033988749895,MathLib.pi=Math.PI,"undefined"!=typeof window&&(window.console||(window.console={log:function(){},info:function(){},warn:function(){}})),MathLib.isNative=function(fn){return fn&&/^[^{]+\{\s*\[native \w/.test(fn.toString())?fn:!1},MathLib.argToRgba=function(h){function hue2rgb(t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?6*t:.5>t?1:2/3>t?4-6*t:0}var r,g,b;return h=-h/(2*Math.PI),r=hue2rgb(h+1/3),g=hue2rgb(h),b=hue2rgb(h-1/3),[255*r,255*g,255*b,255]},MathLib.extendObject=function(dest,src){for(var prop in src)dest[prop]="object"==typeof dest[prop]&&"object"==typeof src[prop]?MathLib.extendObject(dest[prop],src[prop]):src[prop];return dest},MathLib.colorConvert=function(n){return"number"==typeof n?(n=Math.max(Math.min(Math.floor(n),16777215),0),"#"+("00000"+n.toString(16)).slice(-6)):n},MathLib.coerceTo=function(obj,type){if("object"==typeof obj)return obj.coerceTo(type);if("number"==typeof obj){if("integer"===type)return new MathLib.Integer(obj);if("rational"===type)return new MathLib.Rational(obj);if("number"===type)return obj;if("complex"===type)return new MathLib.Complex(obj)}},MathLib.coerce=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];var type=function(x){return x.type||typeof x},numberTypes=["integer","rational","number","complex"],numberType=numberTypes[Math.max.apply(null,args.map(function(x){return numberTypes.indexOf(type(x))}))];return args.map(function(x){return MathLib.coerceTo(x,numberType)})};var errors=[],warnings=[];MathLib.on=function(type,callback){"error"===type?(console.warn('MathLib.on("error", fn) is deprecated'),errors.push(callback)):"warning"===type&&warnings.push(callback)},MathLib.off=function(type,callback){"error"===type?errors=errors.filter(function(x){return x!==callback}):"warning"===type&&(warnings=warnings.filter(function(x){return x!==callback}))},MathLib.error=function(details){errors.forEach(function(cb){cb(details)})},MathLib.warning=function(details){warnings.forEach(function(cb){cb(details)})},MathLib.toString=function(x,options){"undefined"==typeof options&&(options={});var str,base=options.base||10;return Array.isArray(x)?"["+x.map(function(entry){return MathLib.toString(entry,options)}).join()+"]":"object"==typeof x?x.toString(options):"number"==typeof x?MathLib.isFinite(x)?(str=Math.abs(x).toString(base),0>x?str="-"+str:options.sign&&(str="+"+str),options.baseSubscript&&(base>9&&(str+="&#x208"+Math.floor(base/10)+";"),str+="&#x208"+base%10+";"),str):x.toString():"boolean"==typeof x?x.toString():"string"==typeof x?options.quotes?options.quotes[0]+x+options.quotes[1]:'"'+x+'"':void 0},MathLib.toContentMathML=function(x,options){"undefined"==typeof options&&(options={});var base=options.base||10;return Array.isArray(x)?options.strict?'<apply><csymbol cd="list1">list</csymbol>'+x.map(function(entry){return MathLib.toContentMathML(entry,options)}).join("")+"</apply>":"<list>"+x.map(function(entry){return MathLib.toContentMathML(entry,options)}).join("")+"</list>":"object"==typeof x&&"toContentMathML"in x?x.toContentMathML(options):"number"==typeof x?MathLib.isNaN(x)?options.strict?'<csymbol cd="nums1">NaN</csymbol>':"<notanumber/>":MathLib.isFinite(x)?10===base?'<cn type="double">'+MathLib.toString(x)+"</cn>":options.strict?'<apply><csymbol cd="nums1">based_float</csymbol><cn type="integer">'+base+"</cn><cs>"+MathLib.toString(x,{base:base})+"</cs></apply>":'<cn type="real" base="'+base+'">'+MathLib.toString(x,{base:base})+"</cn>":1/0===x?options.strict?'<csymbol cd="nums1">infinity</csymbol>':"<infinity/>":options.strict?'<apply><csymbol cd="arith1">times</csymbol><cn>-1</cn><csymbol cd="nums1">infinity</csymbol></apply>':"<apply><times/><cn>-1</cn><infinity/></apply>":"boolean"==typeof x?options.strict?'<csymbol cd="logic1">'+x+"</csymbol>":"<"+x+"/>":"string"==typeof x?"<cs>"+x+"</cs>":void 0},MathLib.toLaTeX=function(x,options){"undefined"==typeof options&&(options={});var base=options.base||10,str=MathLib.toString(x,{base:base,sign:options.sign}),stringToLaTeX=function(str){return str.replace(/\\/g,"\\textbackslash").replace(/#/g,"\\#").replace(/\$/g,"\\$").replace(/%/g,"\\%").replace(/&/g,"\\&").replace(/_/g,"\\_").replace(/\{/g,"\\{").replace(/\}/g,"\\}").replace(/\^/g,"\\^{}").replace(/\\textbackslash/g,"\\textbackslash{}").replace(/~/g,"\\~{}").replace(/\"/g,'\\texttt{"}').replace(/'/g,"{\\ttfamily\\char'15}")};return Array.isArray(x)?"["+x.map(function(entry){return MathLib.toLaTeX(entry,options)}).join()+"]":"object"==typeof x&&"toLaTeX"in x?x.toLaTeX(options):"number"==typeof x?MathLib.isNaN(x)?"\\text{ NaN }":1/0===x?"\\infty":x===-1/0?"-\\infty":(options.baseSubscript&&(str+="_{"+base+"}"),str):"boolean"==typeof x?"\\text{ "+x+" }":"string"==typeof x?(x=stringToLaTeX(x),options.quotes?stringToLaTeX(options.quotes[0])+"\\texttt{"+x+"}"+stringToLaTeX(options.quotes[1]):'\\texttt{"'+x+'"}'):void 0},MathLib.toMathML=function(x,options){"undefined"==typeof options&&(options={});var str,base=options.base||10;return Array.isArray(x)?"<mrow><mo>[</mo>"+x.map(function(entry){return MathLib.toMathML(entry,options)}).join("<mo>,</mo>")+"<mo>]</mo></mrow>":"object"==typeof x&&"toMathML"in x?x.toMathML(options):"number"==typeof x?(str=options.sign?MathLib.toString(Math.abs(x),{base:base}):MathLib.toString(x,{base:base}),str="<mn>"+str+"</mn>",MathLib.isNaN(x)?"<mi>NaN</mi>":1/0===x?"<mi>&#x221e;</mi>":x===-1/0?"<mrow><mo>-</mo><mi>&#x221e;</mi></mrow>":(options.baseSubscript&&(str="<msub>"+str+"<mn>"+base+"</mn></msub>"),options.sign&&(str=0>x?"<mo>-</mo>"+str:"<mo>+</mo>"+str),str)):"boolean"==typeof x?"<mi>"+x+"</mi>":"string"==typeof x?options.quotes?'<ms lquote="'+options.quotes[0]+'" rquote="'+options.quotes[1]+'">'+x+"</ms>":"<ms>"+x+"</ms>":void 0}}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";MathLib.CoercionError=function(message,options){var tmp=Error.apply(this,arguments);this.name="CoercionError",this.constructor=MathLib.CoercionError,this.message=message,this.method=options.method,this.stack=tmp.stack,this.type="coercionError"},MathLib.CoercionError.prototype=new Error}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";MathLib.EvaluationError=function(message,options){var tmp=Error.apply(this,arguments);this.name="EvaluationError",this.constructor=MathLib.EvaluationError,this.message=message,this.method=options.method,this.stack=tmp.stack,this.type="evaluationError"},MathLib.EvaluationError.prototype=new Error}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Expression=function(){function Expression(expr){"undefined"==typeof expr&&(expr={}),this.type="expression";var prop;"string"==typeof expr&&(expr=MathLib.Expression.parse(expr));for(prop in expr)expr.hasOwnProperty(prop)&&(this[prop]=expr[prop])}return Expression.constant=function(n){return new MathLib.Expression({subtype:"constant",value:n})},Expression.number=function(n){return new MathLib.Expression({subtype:"number",value:n})},Expression.parseContentMathML=function(MathMLString){var MathMLdoc,tokenizer=new DOMParser;MathMLString=MathMLString.split("cs>").map(function(x,i){return i%2===0?x.replace(/\s+/g," ").replace(/ </g,"<").replace(/> /g,">"):x}).join("cs>"),MathMLdoc=tokenizer.parseFromString(MathMLString,"application/xml");var handler={apply:function(node){var functnName,expr,cd,children=Array.prototype.slice.call(node.childNodes),functnNameNode=children.shift(),isMethod=!0,functnNames={arccosh:"arcosh",arccoth:"arcoth",arccsch:"arcsch",arcsech:"arsech",arcsinh:"arsinh",arctanh:"artanh",ceiling:"ceil",ident:"identity",power:"pow",remainder:"rem",setdifference:"without",unary_minus:"negative"};if("csymbol"===functnNameNode.nodeName?(functnName=functnNameNode.textContent,cd=functnNameNode.getAttribute("cd")):functnName=functnNameNode.nodeName,functnName in functnNames?functnName=functnNames[functnName]:"minus"===functnName&&1===children.length?functnName="negative":"arctan"===functnName&&"transc2"===cd&&(functnName="arctan2"),"list"===functnName)return parser(children);if("rational"===functnName){var parsedChildren=parser(children);return new MathLib.Rational(parsedChildren[0],parsedChildren[1])}if("based_integer"===functnName){var parsedChildren=parser(children);return new MathLib.Integer(parsedChildren[1],{base:parsedChildren[0]})}return MathLib[functnName]&&(isMethod=!1),expr=new MathLib.Expression({subtype:"functionCall",value:functnName,isMethod:isMethod,content:parser(children)}),functnName in MathLib&&"functn"===MathLib[functnName].type&&(MathLib[functnName].expression.content[0].hasOwnProperty("cdgroup")&&(expr.cdgroup=MathLib[functnName].expression.content[0].cdgroup),MathLib[functnName].expression.content[0].hasOwnProperty("contentMathMLName")&&(expr.contentMathMLName=MathLib[functnName].expression.content[0].contentMathMLName),MathLib[functnName].expression.content[0].hasOwnProperty("toContentMathML")&&(expr.toContentMathML=MathLib[functnName].expression.content[0].toContentMathML),MathLib[functnName].expression.content[0].hasOwnProperty("toLaTeX")&&(expr.toLaTeX=MathLib[functnName].expression.content[0].toLaTeX),MathLib[functnName].expression.content[0].hasOwnProperty("toMathML")&&(expr.toMathML=MathLib[functnName].expression.content[0].toMathML),MathLib[functnName].expression.content[0].hasOwnProperty("toString")&&(expr.toString=MathLib[functnName].expression.content[0].toString)),expr},ci:function(node){return new MathLib.Expression({subtype:"variable",value:node.textContent})},cn:function(node){var type=node.getAttribute("type");if("integer"===type){var base=null!==node.getAttribute("base")?Number(node.getAttributes("base")):10;return new MathLib.Integer(node.textContent.trim(),{base:base})}return"real"===type||null===type||""===type?Number(node.textContent):"double"===type?Number(node.textContent):"rational"===type?new MathLib.Rational(new MathLib.Integer(node.childNodes[0].textContent),new MathLib.Integer(node.childNodes[2].textContent)):"complex-cartesian"===type?new MathLib.Complex(Number(node.childNodes[0].textContent),Number(node.childNodes[2].textContent)):"complex-polar"===type?MathLib.Complex.polar(Number(node.childNodes[0].textContent),Number(node.childNodes[2].textContent)):void 0},cs:function(node){return node.textContent},csymbol:function(node){var cd=node.getAttribute("cd");if("logic1"===cd){if("true"===node.textContent)return!0;if("false"===node.textContent)return!1}},lambda:function(node){for(var doa,apply,bvar=[],i=0;"bvar"===node.childNodes[i].nodeName;)bvar.push(MathLib.Expression.variable(node.childNodes[i].childNodes[0].textContent)),i++;return"domainofapplication"===node.childNodes[i].nodeName&&(doa=node.childNodes[i].childNodes[0].nodeName,"integers"===doa?doa=MathLib.Integer:"rationals"===doa?doa=MathLib.Rational:"complexes"===doa&&(doa=MathLib.Complex),i++),apply=node.childNodes[i],new MathLib.Expression(doa?{subtype:"functionDefinition",domain:doa,args:bvar,content:[parser(apply)]}:{subtype:"functionDefinition",args:bvar,content:[parser(apply)]})},list:function(node){return parser(Array.prototype.slice.call(node.childNodes))},math:function(node){return parser(node.childNodes[0])},matrix:function(node){return new MathLib.Matrix(Array.prototype.slice.call(node.childNodes).map(handler.matrixrow))},matrixrow:function(node){return Array.prototype.map.call(node.childNodes,parser)},set:function(node){return new MathLib.Set(parser(Array.prototype.slice.call(node.childNodes)))},"#text":function(node){return node.nodeValue},vector:function(node){return new MathLib.Vector(parser(Array.prototype.slice.call(node.childNodes)))},"false":function(){return!1},pi:function(){return MathLib.Expression.constant("pi")},"true":function(){return!0}},parser=function(node){if(Array.isArray(node)){var nodes=node.map(parser);return nodes}return handler[node.nodeName](node)};return parser(MathMLdoc.childNodes[0])},Expression.variable=function(n){return new MathLib.Expression({subtype:"variable",value:n})},Expression.prototype.compare=function(expr){return MathLib.sign(this.toString().localeCompare(expr.toString()))},Expression.prototype.copy=function(){return this.map(function(x){return x})},Expression.prototype.evaluate=function(){if("assignment"===this.subtype){var value=this.value;return this.content.forEach(function(variable){MathLib.Expression.variables[variable.value]=value}),this.value}if("binaryOperator"===this.subtype)return MathLib[this.name].apply(null,this.content.map(function(x){return MathLib.evaluate(x)}));if("brackets"===this.subtype)return MathLib.evaluate(this.content);if("complexNumber"===this.subtype){if("cartesian"===this.mode)return new MathLib.Complex(this.value[0].evaluate(),this.value[1].evaluate());if("polar"===this.mode)return MathLib.Complex.polar(this.value[0].evaluate(),this.value[1].evaluate())}if("constant"===this.subtype&&"pi"===this.value)return Math.PI;if("functionCall"===this.subtype){if(this.isMethod){var args=this.content.map(function(x){return MathLib.evaluate(x)}),_this=args.shift();return _this[this.value].apply(_this,args)}return MathLib[this.value].apply(null,this.content.map(function(x){return MathLib.evaluate(x)}))}return"functionDefinition"===this.subtype?MathLib.Functn(this.content[0].evaluate(),{name:"f",expression:this}):"number"===this.subtype?parseFloat(this.value):"naryOperator"===this.subtype?MathLib[this.name].apply(null,this.content.map(function(x){return MathLib.evaluate(x)})):"variable"===this.subtype?this.value in MathLib.Expression.variables?MathLib.evaluate(MathLib.Expression.variables[this.value]):this:"unaryOperator"===this.subtype?"-"===this.value?MathLib.negative(this.content.evaluate()):this.content.evaluate():void 0},Expression.prototype.map=function(f){var prop,mappedProperties,properties={};for(prop in this)this.hasOwnProperty(prop)&&"content"!==prop&&(properties[prop]=Array.isArray(this[prop])?this[prop].map(f):this[prop]);return mappedProperties=f(properties),Array.isArray(this.content)?mappedProperties.content=this.content.map(function(expr){return"expression"===expr.type?expr.map(f):f(expr)}):this.content&&(mappedProperties.content=this.content.map(f)),"object"==typeof mappedProperties?new MathLib.Expression(mappedProperties):mappedProperties},Expression.prototype.toContentMathML=function(){if("assignment"===this.subtype){var str,i,ii;for(str='<apply><csymbol cd="prog1">assignment</csymbol>'+this.content.map(MathLib.toContentMathML).join('<apply><csymbol cd="prog1">assignment</csymbol>')+MathLib.toContentMathML(this.value),i=0,ii=this.content.length;ii>i;i++)str+="</apply>";return str}if("binaryOperator"===this.subtype){var op="pow"===this.name?"power":this.name;return'<apply><csymbol cd="arith1">'+op+"</csymbol>"+this.content[0].toContentMathML()+this.content[1].toContentMathML()+"</apply>"}if("brackets"===this.subtype)return this.content.toContentMathML();if("number"===this.subtype)return"<cn>"+this.value+"</cn>";if("variable"===this.subtype)return"<ci>"+this.value+"</ci>";if("naryOperator"===this.subtype)return'<apply><csymbol cd="arith1">'+this.name+"</csymbol>"+this.content.map(function(expr){return expr.toContentMathML()}).join("")+"</apply>";if("unaryOperator"===this.subtype)return"-"===this.value?'<apply><csymbol cd="arith1">unary_minus</csymbol>'+this.content.toContentMathML()+"</apply>":this.content.toContentMathML();if("functionCall"===this.subtype){var funcName,conversion={arcosh:"arccosh",arcoth:"arccoth",arcsch:"arccsch",arsech:"arcsech",arsinh:"arcsinh",artanh:"arctanh",identity:"ident"};return funcName=this.value in conversion?conversion[this.value]:this.value,'<apply><csymbol cd="'+this.cdgroup+'">'+this.contentMathMLName+"</csymbol>"+this.content.map(function(expr){return expr.toContentMathML()}).join("")+"</apply>"}return"functionDefinition"===this.subtype?"<lambda><bvar><ci>"+this.args.join("</ci></bvar><bvar><ci>")+"</ci></bvar>"+this.content.map(function(expr){return expr.toContentMathML()})+"</lambda>":void 0},Expression.prototype.toLaTeX=function(){var op,amsmath;if("assignment"===this.subtype)return this.content.map(MathLib.toLaTeX).join(" := ")+" := "+MathLib.toLaTeX(this.value);if("binaryOperator"===this.subtype){var str;return str="/"===this.value?"\\frac{"+this.content[0].toLaTeX()+"}":this.content[0].toLaTeX()+this.value,str+="-"!==this.value?"{":"",str+=this.content[1].toLaTeX(),str+="-"!==this.value?"}":""}if("brackets"===this.subtype)return"\\left("+this.content.toLaTeX()+"\\right)";if("complexNumber"===this.subtype){if("cartesian"===this.mode)return this.value[0]+"+"+this.value[1]+"i";if("polar"===this.mode)return this.value[0]+" \\cdot e^{"+this.value[1]+"i}"}return"constant"===this.subtype&&"pi"===this.value?"\\pi":"number"===this.subtype||"variable"===this.subtype?this.value:"naryOperator"===this.subtype?(op="*"===this.value?"\\cdot":this.value,this.content.reduce(function(old,cur,idx){return old+(idx?op:"")+cur.toLaTeX()},"")):"string"===this.subtype?'\\texttt{"{}'+this.value+'"}':"unaryOperator"===this.subtype?"-"===this.value?"-"+this.content.toLaTeX():this.content.toLaTeX():"functionCall"===this.subtype?(amsmath=["arccos","arcsin","arctan","arg","cos","cosh","cot","coth","csc","deg","det","dim","gcd","lg","ln","log","max","min","sec","sin","sinh","tan","tanh"],amsmath.indexOf(this.value)+1?"\\"+this.value+"\\left("+(this.content.length?this.content.reduce(function(old,cur,idx){return old+(idx?", ":"")+MathLib.toLaTeX(cur)},""):"x")+"\\right)":"\\operatorname{"+this.value+"}\\left("+(this.content.length?this.content.reduce(function(old,cur,idx){return old+(idx?", ":"")+cur.toLaTeX()},""):"x")+"\\right)"):"functionDefinition"===this.subtype?(1===this.args.length?this.args[0]:"\\left("+this.args.join(", ")+"\\right)")+" \\longmapsto "+(1===this.content.length?this.content[0].toLaTeX():"\\left("+this.content.map(function(expr){return expr.toLaTeX()}).join(", ")+"\\right)"):void 0},Expression.prototype.toMathML=function(){if("assignment"===this.subtype)return this.content.map(MathLib.toMathML).join("<mo>:=</mo>")+"<mo>:=</mo>"+MathLib.toMathML(this.value);if("binaryOperator"===this.subtype){if("-"===this.value)return this.content[0].toMathML()+"<mo>-</mo>"+this.content[1].toMathML();if("/"===this.value)return"<mfrac>"+this.content[0].toMathML()+this.content[1].toMathML()+"</mfrac>";if("^"===this.value)return"<msup>"+this.content[0].toMathML()+this.content[1].toMathML()+"</msup>"}if("brackets"===this.subtype)return"<mrow><mo>(</mo>"+this.content.toMathML()+"<mo>)</mo></mrow>";if("complexNumber"===this.subtype){if("cartesian"===this.mode)return"<mrow>"+this.value[0].toMathML()+"<mo>+</mo>"+this.value[1].toMathML()+"<mi>i</mi></mrow>";if("polar"===this.mode)return this.value[0].toMathML()+"<msup><mi>e</mi><mrow>"+this.value[1].toMathML()+"<mi>i</mi></mrow></msup>"}return"constant"===this.subtype&&"pi"===this.value?"<mi>&pi;</mi>":"number"===this.subtype?"<mn>"+this.value+"</mn>":"variable"===this.subtype?"<mi>"+this.value+"</mi>":"naryOperator"===this.subtype?"<mrow>"+this.content.map(function(expr){return expr.toMathML()}).join("<mo>"+("*"===this.value?"&middot;":this.value)+"</mo>")+"</mrow>":"unaryOperator"===this.subtype?"-"===this.value?"<mo>-</mo>"+this.content.toMathML():this.content.toMathML():"functionCall"===this.subtype?"<mrow><mi>"+this.value+"</mi><mo>&af;</mo><mrow><mo>(</mo>"+(this.content.length?this.content.map(function(expr){return expr.toMathML()}).join("<mo>,</mo>"):"<mi>x</mi>")+"<mo>)</mo></mrow></mrow>":"functionDefinition"===this.subtype?"<mrow>"+(1===this.args.length?"<mi>"+this.args[0]+"</mi>":"<mrow><mo>(</mo><mi>"+this.args.join("</mi><mo>,</mo><mi>")+"</mi><mo>)</mo></mrow>")+"<mo>&#x27FC;</mo>"+(1===this.content.length?this.content[0].toMathML():"<mrow><mo>(</mo>"+this.content.map(function(expr){return expr.toMathML()})+"<mo>)</mo></mrow>")+"</mrow>":void 0},Expression.prototype.toString=function(){var _this=this;if("assignment"===this.subtype)return this.content.map(MathLib.toString).join(" := ")+" := "+MathLib.toString(this.value);if("binaryOperator"===this.subtype)return this.content[0].toString()+this.value+this.content[1].toString();if("brackets"===this.subtype)return"("+this.content.toString()+")";if("complexNumber"===this.subtype){if("cartesian"===this.mode)return this.value[0]+"+"+this.value[1]+"i";if("polar"===this.mode)return this.value[0]+"*e^"+this.value[1]+"i"}return"constant"===this.subtype&&"pi"===this.value?"π":"number"===this.subtype||"variable"===this.subtype?this.value:"naryOperator"===this.subtype?this.content.reduce(function(old,cur){return old+_this.value+cur}):"unaryOperator"===this.subtype?"-"===this.value?"-"+this.content.toString():this.content.toString():"functionCall"===this.subtype?this.value+"("+(this.content.length?this.content.map(function(expr){return expr.toString()}).join(", "):"x")+")":"functionDefinition"===this.subtype?(1===this.args.length?this.args[0]:"("+this.args.join(", ")+")")+" ⟼ "+(1===this.content.length?this.content[0].toString():"("+this.content.map(function(expr){return expr.toString()}).join(", ")+")"):void 0},Expression.parse=function(str){var Token,Lexer,Parser;return Token={Operator:"Operator",Identifier:"Identifier",Number:"Number"},Lexer=function(){function peekNextChar(n){"undefined"==typeof n&&(n=1);var idx=index;return length>idx?expression.substr(idx,n):"\x00"}function getNextChar(){var ch="\x00",idx=index;return length>idx&&(ch=expression.charAt(idx),index+=1),ch}function isWhiteSpace(ch){return"	"===ch||" "===ch||" "===ch}function isLetter(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch}function isDecimalDigit(ch){return ch>="0"&&"9">=ch}function createToken(type,value){return{type:type,value:value,start:marker,end:index-1}}function skipSpaces(){for(var ch;length>index&&(ch=peekNextChar(),isWhiteSpace(ch));)getNextChar()}function scanOperator(){var ch=peekNextChar();return"+-*/()^%=;,".indexOf(ch)>=0?createToken(T.Operator,getNextChar()):":="===peekNextChar(2)?(index+=2,createToken(T.Operator,":=")):void 0}function isIdentifierStart(ch){return"_"===ch||isLetter(ch)}function isIdentifierPart(ch){return isIdentifierStart(ch)||isDecimalDigit(ch)}function scanIdentifier(){var ch,id;if(ch=peekNextChar(),!isIdentifierStart(ch))return void 0;for(id=getNextChar();;){if(ch=peekNextChar(),!isIdentifierPart(ch))break;id+=getNextChar()}return createToken(T.Identifier,id)}function scanNumber(){var ch,number;if(ch=peekNextChar(),!isDecimalDigit(ch)&&"."!==ch)return void 0;if(number="","."!==ch)for(number=getNextChar();;){if(ch=peekNextChar(),!isDecimalDigit(ch))break;number+=getNextChar()}if("."===ch)for(number+=getNextChar();;){if(ch=peekNextChar(),!isDecimalDigit(ch))break;number+=getNextChar()}if("e"===ch||"E"===ch){if(number+=getNextChar(),ch=peekNextChar(),"+"!==ch&&"-"!==ch&&!isDecimalDigit(ch))throw ch="character "+ch,index>=length&&(ch="<end>"),new SyntaxError("Unexpected "+ch+" after the exponent sign");for(number+=getNextChar();;){if(ch=peekNextChar(),!isDecimalDigit(ch))break;number+=getNextChar()}}if("."===number)throw new SyntaxError("Expecting decimal digits after the dot sign");return createToken(T.Number,number)}function reset(str){expression=str,length=str.length,index=0}function next(){var token;if(skipSpaces(),index>=length)return void 0;if(marker=index,token=scanNumber(),"undefined"!=typeof token)return token;if(token=scanOperator(),"undefined"!=typeof token)return token;if(token=scanIdentifier(),"undefined"!=typeof token)return token;throw new SyntaxError("Unknown token from character "+peekNextChar())}function peek(){var token,idx;idx=index;try{token=next(),delete token.start,delete token.end}catch(e){token=void 0}return index=idx,token}var expression="",length=0,index=0,marker=0,T=Token;return{reset:reset,next:next,peek:peek}},Parser=function(){function matchOp(token,op){return"undefined"!=typeof token&&token.type===T.Operator&&token.value===op}function parseArgumentList(){for(var token,expr,args=[];;){if(expr=parseExpression(),"undefined"==typeof expr)break;if(args.push(expr),token=lexer.peek(),!matchOp(token,","))break;lexer.next()}return args}function parseFunctionCall(name){var token,expr,args=[];if(token=lexer.next(),!matchOp(token,"("))throw new SyntaxError('Expecting ( in a function call "'+name+'"');if(token=lexer.peek(),matchOp(token,")")||(args=parseArgumentList()),token=lexer.next(),!matchOp(token,")"))throw new SyntaxError('Expecting ) in a function call "'+name+'"');return expr=new MathLib.Expression({subtype:"functionCall",value:name,content:args}),name in MathLib&&"functn"===MathLib[name].type&&(MathLib[name].expression.content[0].hasOwnProperty("cdgroup")&&(expr.cdgroup=MathLib[name].expression.content[0].cdgroup),MathLib[name].expression.content[0].hasOwnProperty("contentMathMLName")&&(expr.contentMathMLName=MathLib[name].expression.content[0].contentMathMLName),MathLib[name].expression.content[0].hasOwnProperty("toContentMathML")&&(expr.toContentMathML=MathLib[name].expression.content[0].toContentMathML),MathLib[name].expression.content[0].hasOwnProperty("toLaTeX")&&(expr.toLaTeX=MathLib[name].expression.content[0].toLaTeX),MathLib[name].expression.content[0].hasOwnProperty("toMathML")&&(expr.toMathML=MathLib[name].expression.content[0].toMathML),MathLib[name].expression.content[0].hasOwnProperty("toString")&&(expr.toString=MathLib[name].expression.content[0].toString)),expr}function parsePrimary(){var token,expr;if(token=lexer.peek(),"undefined"==typeof token)throw new SyntaxError("Unexpected termination of expression");if(token.type===T.Identifier)return token=lexer.next(),matchOp(lexer.peek(),"(")?parseFunctionCall(token.value):MathLib.Expression.variable(token.value);if(token.type===T.Number)return token=lexer.next(),MathLib.Expression.number(token.value);if(matchOp(token,"(")){if(lexer.next(),expr=parseAssignment(),token=lexer.next(),!matchOp(token,")"))throw new SyntaxError("Expecting )");return new MathLib.Expression({subtype:"brackets",value:"brackets",content:expr})}throw new SyntaxError("Parse error, can not process token "+token.value)}function parseUnary(){var token,expr;return token=lexer.peek(),matchOp(token,"-")||matchOp(token,"+")?(token=lexer.next(),expr=parseUnary(),new MathLib.Expression({subtype:"unaryOperator",value:token.value,content:expr})):parsePrimary()}function parseExponentiation(){var token,left,right;return left=parseUnary(),token=lexer.peek(),matchOp(token,"^")?(token=lexer.next(),right=parseExponentiation(),new MathLib.Expression({subtype:"binaryOperator",value:"^",content:[left,right],name:"pow"})):left}function parseMultiplicative(){var token,left,right,r;if(left=parseExponentiation(),token=lexer.peek(),matchOp(token,"*")||matchOp(token,"/")){if(token=lexer.next(),right=parseMultiplicative(),"naryOperator"===right.subtype||"binaryOperator"===right.subtype){for(r=right;"naryOperator"===r.content[0].subtype||"binaryOperator"===r.content[0].subtype;)r=r.content[0];return r.content[0]=new MathLib.Expression({subtype:"*"===token.value?"naryOperator":"binaryOperator",content:[left,r.content[0]],value:token.value,name:"*"===token.value?"times":"divide"}),right}return new MathLib.Expression({subtype:"*"===token.value?"naryOperator":"binaryOperator",value:token.value,name:"*"===token.value?"times":"divide",content:[left,right]})}return left}function parseAdditive(){var token,left,right,r;if(left=parseMultiplicative(),token=lexer.peek(),matchOp(token,"+")||matchOp(token,"-")){if(token=lexer.next(),right=parseAdditive(),"+"===right.value||"-"===right.value){for(r=right;"naryOperator"===r.content[0].subtype;)r=r.content[0];return r.content[0]=new MathLib.Expression({subtype:"+"===token.value?"naryOperator":"binaryOperator",content:[left,r.content[0]],value:token.value,name:"+"===token.value?"plus":"minus"}),right}return new MathLib.Expression({subtype:"+"===token.value?"naryOperator":"binaryOperator",value:token.value,name:"+"===token.value?"plus":"minus",content:[left,right]})}return left}function parseAssignment(){var expr,value,token,content=[];if(expr=parseAdditive(),"undefined"!=typeof expr&&"variable"===expr.subtype){if(token=lexer.peek(),matchOp(token,":=")){for(lexer.next(),content.push(expr),value=parseAssignment();"assignment"===value.subtype;)content=content.concat(value.content),value=value.value;return new MathLib.Expression({subtype:"assignment",content:content,value:value})}return expr}return expr}function parseExpression(){return parseAssignment()}function parse(expression){var expr,token;if(lexer.reset(expression),expr=parseExpression(),token=lexer.next(),"undefined"!=typeof token)throw new SyntaxError("Unexpected token "+token.value);return new MathLib.Expression(expr)}var lexer=new Lexer,T=Token;return{parse:parse}},(new Parser).parse(str)},Expression.variables={},Expression}();MathLib.Expression=Expression}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var functnPrototype={};MathLib.Functn=function(f,options){options=options||{};var functn=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];var firstArg,i,ii,x=args[0],arity=options.arity,isNumeric=function(arg){return-1!==["complex","integer","number","rational"].indexOf(MathLib.type(arg))};if(args.length>1&&args.every(isNumeric)&&(args=MathLib.coerce.apply(null,args)),firstArg=args[0],args.length<arity||args.length===arity&&args.some(function(arg){return void 0===arg||"functn"===arg.type||"expression"===arg.type})){var bvar,partialAppliedExpression=options.expression.copy(),bvarIndex=0;for(i=0,ii=args.length;ii>i;i++)void 0===args[i]?bvarIndex++:"functn"===args[i].type?(bvar=partialAppliedExpression.args[bvarIndex].value,partialAppliedExpression=partialAppliedExpression.map(function(expr){return"variable"===expr.subtype&&expr.value===bvar?args[i].expression.content[0]:expr}),partialAppliedExpression.args.splice(bvarIndex,1,args[i].expression.args),bvarIndex+=args[i].expression.args.length):"expression"===args[i].type&&"variable"===args[i].subtype?(bvar=partialAppliedExpression.args[bvarIndex].value,partialAppliedExpression=partialAppliedExpression.map(function(expr){return"variable"===expr.subtype&&expr.value===bvar?args[i]:expr}),partialAppliedExpression.args.splice(bvarIndex,1,[args[i]]),bvarIndex++):(bvar=partialAppliedExpression.args[bvarIndex].value,partialAppliedExpression=partialAppliedExpression.map(function(expr){return"variable"===expr.subtype&&expr.value===bvar?args[i]:expr}),partialAppliedExpression.args.splice(bvarIndex,1));return MathLib.Functn(function(){var j,jj,argus=[],argumentsIndex=0;for(j=0,jj=args.length;jj>j;j++)void 0===args[j]||"expression"===args[j].type?(argus.push(arguments[argumentsIndex]),argumentsIndex++):"functn"===args[j].type?(argus.push(args[j](arguments[argumentsIndex])),argumentsIndex++):argus.push(args[j]);return argus=argus.concat(Array.prototype.slice.call(arguments,argumentsIndex)),f.apply(this,argus)},{expression:partialAppliedExpression})}if("complex"===firstArg.type)return firstArg[options.name].apply(firstArg,Array.prototype.slice.call(arguments,1));if(args.every(function(arg){return-1===["function","undefined","object"].indexOf(typeof arg)}))return f.apply(null,args);if("functn"===x.type){var bvar=options.expression.args[0].value,composition=options.expression.map(function(expr){return"variable"===expr.subtype&&expr.value===bvar&&(expr=x.expression.content[0]),expr});return new MathLib.Functn(function(y){return f(x(y))},{expression:new MathLib.Expression({subtype:"functionDefinition",args:x.expression.args,content:composition.content})})}if("function"==typeof x)return function(y){return f(x(y))};if("integer"===firstArg.type||"rational"===firstArg.type)return firstArg[options.name]?firstArg[options.name].apply(firstArg,Array.prototype.slice.call(arguments,1)):f(firstArg.coerceTo("number"));
if("set"===x.type)return x.map(f);if("array"===MathLib.type(firstArg)){var ff,res=[];for(i=0,ii=firstArg.length;ii>i;i++)ff=f(firstArg[i]),res.push("function"==typeof ff?ff.apply(null,args.slice(1)):ff);return res}return x[options.name]()};for(var name in functnPrototype)functnPrototype.hasOwnProperty(name)&&(functn[name]=functnPrototype[name]);return functn.type="functn",functn.constructor=MathLib.Functn,Object.defineProperties(functn,{args:{value:options.args},id:{value:options.name},expression:{value:options.expression}}),functn};var exports={},fns={};fns.abs={functn:Math.abs,cdgroup:"arith1",toLaTeX:["\\left|","\\right|"],toMathML:["<mo>|</mo>","<mo>|</mo>"],toString:["|","|"]},fns.arccos={functn:Math.acos,cdgroup:"transc1"},fns.arccot={functn:function(x){return 1.5707963267948966-Math.atan(x)},cdgroup:"transc1"},fns.arccsc={functn:function(x){return Math.asin(1/x)},cdgroup:"transc1"},fns.arcosh={functn:MathLib.isNative(Math.acosh)||function(x){return Math.log(x+Math.sqrt(x*x-1))},cdgroup:"transc1",toContentMathMLName:"arccosh"},fns.arcoth={functn:function(x){return MathLib.isFinite(x)?.5*Math.log((x+1)/(x-1)):1/x},cdgroup:"transc1",toContentMathMLName:"arccoth"},fns.arcsch={functn:function(x){return 0!==x&&MathLib.isFinite(x)?Math.log(1/x+Math.sqrt(1/(x*x)+1)):1/x},cdgroup:"transc1",toContentMathMLName:"arccsch"},fns.arcsec={functn:function(x){return Math.acos(1/x)},cdgroup:"transc1"},fns.arcsin={functn:Math.asin,cdgroup:"transc1"},fns.arctan={functn:Math.atan,cdgroup:"transc1"},fns.arctan2={functn:Math.atan2,arity:2,cdgroup:"transc2",contentMathMLName:"arctan"},fns.arsech={functn:function(x){return Math.log((1+Math.sqrt(1-x*x))/x)},cdgroup:"transc1",toContentMathMLName:"arcsech"},fns.arsinh={functn:MathLib.isNative(Math.asinh)||function(x){return 0!==x&&MathLib.isFinite(x)?Math.log(x+Math.sqrt(x*x+1)):x},cdgroup:"transc1",toContentMathMLName:"arcsinh"},fns.artanh={functn:MathLib.isNative(Math.atanh)||function(x){return 0===x?x:.5*Math.log((1+x)/(1-x))},cdgroup:"transc1",toContentMathMLName:"arctanh"},fns.binomial={functn:function(n,k){var i,sign,binomial=1;if(MathLib.isNaN(n)||!MathLib.isFinite(k))return 0/0;if(n>=0&&-1>=k||n>=0&&k>n||0>k&&k>n)return 0;if(0>n){if(0>k)return((n+k)%2*2+1)*MathLib.binomial(-k-1,-n-1);sign=0===k?1:-(k%2*2-1),binomial=sign*MathLib.binomial(k-n-1,k)}for(k>n/2&&(k=n-k),i=1;k>=i;i++)binomial*=(n+1-i)/i;return binomial},args:["n","k"],cdgroup:"combinat1",toLaTeX:["{"," \\choose ","}"],toMathML:['<mfenced><mfrac linethickness="0">',"","</mfrac></mfenced>"]},fns.cbrt={functn:function(x){var a3,a3x,an,a;if(0===x||x!==x||1/0===x||x===-1/0)return x;for(a=MathLib.sign(x)*Math.pow(Math.abs(x),1/3);;){if(a3=Math.pow(a,3),a3x=a3+x,an=a*(a3x+x)/(a3x+a3),MathLib.isZero(an-a))break;a=an}return an},cdgroup:"arith1",toContentMathML:['<csymbol cd="arith1">root</csymbol>',"<cn>3</cn>"],toLaTeX:["\\sqrt[3]{","}"],toMathML:["<mroot>","<mn>3</mn></mroot>"]},fns.ceil={functn:function(x){return 0===x?x:Math.ceil(x)},cdgroup:"rounding1",contentMathMLName:"ceiling",toLaTeX:["\\lceil","\\rceil"],toMathML:["<mo>&lceil;</mo>","<mo>&rceil;</mo>"],toString:["⌈","⌉"]},fns.conjugate={functn:function(x){return x},cdgroup:"complex1",toLaTeX:["\\overline{","}"],toMathML:["<mover>","<mo>‾</mo></mover>"]},fns.copy={functn:function(x){return x},toContentMathML:["<ci>copy</ci>"]},fns.cos={functn:Math.cos,cdgroup:"transc1"},fns.cosh={functn:function(x){var ex=Math.exp(x);return(ex+1/ex)/2},cdgroup:"transc1"},fns.cot={functn:function(x){return 0===x?1/x:Math.tan(1.5707963267948966-x)},cdgroup:"transc1"},fns.coth={functn:function(x){return 0===x?1/x:MathLib.isFinite(x)?(Math.exp(x)+Math.exp(-x))/(Math.exp(x)-Math.exp(-x)):MathLib.sign(x)},cdgroup:"transc1"},fns.csc={functn:function(x){return 1/Math.sin(x)},cdgroup:"transc1"},fns.csch={functn:function(x){return 0===x?1/x:2/(Math.exp(x)-Math.exp(-x))},cdgroup:"transc1"},fns.degToRad={functn:function(x){return.017453292519943295*x},toContentMathML:['<csymbol cd="arith1">times</csymbol><apply><csymbol cd="arith1">divide</csymbol><csymbol cd="nums1">pi</csymbol><cn>180</cn></apply>',""],toLaTeX:["\\frac{\\pi}{180}",""],toMathML:["<mfrac><mi>&pi;</mi><mn>180</mn></mfrac><mo>&#x2062;</mo>",""],toString:["π/180*",""]},fns.divide={functn:function(x,y){return MathLib.times(x,MathLib.inverse(y))},arity:2,cdgroup:"arith1",toLaTeX:["\\frac{","}{","}"],toMathML:["<mfrac>","","</mfrac>"],toString:["","/",""]},fns.equivalent={functn:function(x,y){return Boolean(x)===Boolean(y)},arity:2,cdgroup:"logic1",toLaTeX:[""," \\Leftrightarrow ",""],toMathML:["","<mo>&#x21D4;</mo>",""],toString:[""," ⇔ ",""]},fns.exp={functn:Math.exp,cdgroup:"transc1",toLaTeX:["e^{","}"]},fns.factorial={functn:function(x){var i,factorial=1;if(x>170&&MathLib.isInt(x)||1/0===x)return 1/0;if(0>x||!MathLib.isInt(x)||MathLib.isNaN(x))return 0/0;for(i=1;x>=i;i++)factorial*=i;return factorial},args:["n"],cdgroup:"integer1",toLaTeX:["","!"],toMathML:["","<mo>!</mo>"],toString:["","!"]},fns.floor={functn:Math.floor,cdgroup:"rounding1",toLaTeX:["\\lfloor","\\rfloor"],toMathML:["<mo>&lfloor;</mo>","<mo>&rfloor;</mo>"],toString:["⌊","⌋"]},fns.identity={functn:function(x){return x},cdgroup:"fns1",toLaTeX:["",""],toMathML:["",""],toString:["",""]},fns.implies={functn:function(x,y){return Boolean(x)&&!Boolean(y)?!1:!0},arity:2,cdgroup:"logic1",toLaTeX:[""," \\Rightarrow ",""],toMathML:["","<mo>&#x21D2;</mo>",""],toString:[""," ⇒ ",""]},fns.inverse={functn:function(x){return 1/x},toContentMathML:['<csymbol cd="arith1">divide</csymbol><cn>1</cn>',""],toLaTeX:["\\frac{1}{","}"],toMathML:["<mfrac><mn>1</mn>","</mfrac>"],toString:["1/",""]},fns.isNaN={functn:function(x){return x!==x},toContentMathML:['<csymbol cd="relation1">eq</csymbol>','<csymbol cd="nums1">NaN</csymbol>']},fns.isPrime={functn:function(x){var i,sqrt=Math.sqrt(x);if(x%1===0&&x>1){if(2===x)return!0;if(x%2===0)return!1;for(i=3;sqrt>=i;i+=2)if(x%i===0)return!1;return!0}return!1},toContentMathML:['<csymbol cd="set1">in</csymbol>','<csymbol cd="setname1">P</csymbol>']},fns.lg={functn:function(x){return Math.log(x)/Math.LN10},toContentMathML:['<csymbol cd="transc1">log</csymbol><cn>10</cn>',""],toLaTeX:["\\lg\\left(","\\right)"],toMathML:["<mi>lg</mi><mo>&#x2061;</mo><mo>(</mo>","<mo>)</mo>"],toString:["lg(",")"]},fns.ln={functn:Math.log,cdgroup:"transc1"},fns.log={functn:function(b,x){return Math.log(x)/Math.log(b)},args:["b","x"],cdgroup:"transc1",toLaTeX:["\\log_{","}\\left(","\\right)"],toMathML:["<msub><mi>log</mi>","</msub><mo>&#x2061;</mo><mo>(</mo>","<mo>)</mo>"],toString:["log_","(",")"]},fns.logGamma={functn:function(x){var j,tmp,y,ser,cof=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(1/0===x)return 1/0;for(y=x,tmp=x+5.2421875,tmp=(x+.5)*Math.log(tmp)-tmp,ser=.9999999999999971,j=0;14>j;j++)ser+=cof[j]/++y;return tmp+Math.log(2.5066282746310007*ser/x)},toContentMathML:['<csymbol cd="transc1">ln</csymbol><apply><ci>Gamma</ci>',"</apply>"],toLaTeX:["\\log\\left(\\Gamma\\left(","\\right)\\right)"],toMathML:['<mi>log</mi><mo>&#x2061;</mo><mo>(</mo><mi mathvariant="normal">&#x0393;</mi><mo>&#x2061;</mo><mo>(</mo>',"<mo>)</mo><mo>)</mo>"],toString:["log(Γ(","))"]},fns.minus={functn:function(x,y){return MathLib.plus(x,MathLib.negative(y))},arity:2,cdgroup:"arith1",toLaTeX:["","-",""],toMathML:["","<mo>-</mo>",""],toString:[""," - ",""]},fns.mod={functn:function(n,m){return n-m*Math.floor(n/m)},args:["n","m"],toContentMathML:["<ci>mod</ci>","",""],toLaTeX:[""," \\mod ",""],toMathML:["","<mi>mod</mi>",""],toString:[""," mod ",""]},fns.negative={functn:function(x){return-x},cdgroup:"arith1",contentMathMLName:"unary_minus",toLaTeX:["-",""],toMathML:["<mo>&#x2212;</mo>",""],toString:["-",""]},fns.not={functn:function(x){return!x},cdgroup:"logic1",toLaTeX:["\\neg ",""],toMathML:["<mo>&#xac;</mo>",""],toString:["¬",""]},fns.pow={functn:function(x,y){return 1===x||-1===x&&(1/0===y||y===-1/0)?1:MathLib.isNegZero(x)&&1===Math.abs(y%2)?0>y?-1/0:-0:Math.pow(x,y)},arity:2,cdgroup:"arith1",toContentMathML:['<csymbol cd="arith1">power</csymbol>',"",""],toLaTeX:["\\left(","\\right)^{","}"],toMathML:["<msup>","","</msup>"],toString:["(",")^(",")"]},fns.radToDeg={functn:function(x){return 57.29577951308232*x},toContentMathML:['<csymbol cd="arith1">times</csymbol><apply><csymbol cd="arith1">divide</csymbol><cn>180</cn><csymbol cd="nums1">pi</csymbol></apply>',""],toLaTeX:["\\frac{180}{\\pi}",""],toMathML:["<mfrac><mn>180</mn><mi>&pi;</mi></mfrac><mo>&#x2062;</mo>",""],toString:["180/π*",""]},fns.rem={functn:function(n,m){var x=4,y=-3;return MathLib.isFinite(m)?x%y===-1&&n>0&&0>m?-(n%m):n%m:0/0},args:["n","m"],cdgroup:"integer1",contentMathMLName:"remainder",toLaTeX:[""," \\operatorname{rem} ",""],toMathML:["","<mi>rem</mi>",""],toString:[""," rem ",""]},fns.root={functn:function(x,y){return Math.pow(x,1/y)},arity:2,cdgroup:"arith1",toLaTeX:["\\left(","\\right)^{\\frac{1}{","}}"],toMathML:["<mroot>","","</mroot>"],toString:["(",")^(1/",")"]},fns.sec={functn:function(x){return 1/Math.cos(x)},cdgroup:"transc1"},fns.sech={functn:function(x){var ex=Math.exp(x);return 2/(ex+1/ex)},cdgroup:"transc1"},fns.sign={functn:function(x){return x&&(0>x?-1:1)},toContentMathML:["<ci>sign</ci>"]},fns.sin={functn:Math.sin,cdgroup:"transc1"},fns.sinh={functn:MathLib.isNative(Math.sinh)||function(x){var ex;return 0===x?x:(ex=Math.exp(x),(ex-1/ex)/2)},cdgroup:"transc1"},fns.sqrt={functn:Math.sqrt,cdgroup:"arith1",toContentMathML:['<csymbol cd="arith1">root</csymbol>',"<cn>2</cn>"],toLaTeX:["\\sqrt{","}"],toMathML:["<msqrt>","</msqrt>"]},fns.tan={functn:Math.tan,cdgroup:"transc1"},fns.tanh={functn:MathLib.isNative(Math.tanh)||function(x){var p;return 0!==x&&MathLib.isFinite(x)?(p=Math.exp(x),(p*p-1)/(p*p+1)):MathLib.sign(x)},cdgroup:"transc1"},functnPrototype.diff=function(x,h){return"undefined"==typeof h&&(h=1e-5),(this(x+h)-this(x-h))/(2*h)},functnPrototype.draw=function(screen,options){"undefined"==typeof options&&(options={});var functn=this;return Array.isArray(screen)?screen.forEach(function(x){x.path(functn,options)}):screen.path(functn,options),this};var quadstep=function(f,a,b,fa,fc,fb,options){var h=b-a,c=(a+b)/2,fd=f((a+c)/2),fe=f((c+b)/2),Q1=h/6*(fa+4*fc+fb),Q2=h/12*(fa+4*fd+2*fc+4*fe+fb),Q=Q2+(Q2-Q1)/15;return options.calls=options.calls+2,MathLib.isFinite(Q)?options.calls>options.maxCalls?(options.warn=Math.max(options.warn,2),Q):Math.abs(Q2-Q)<=options.tolerance?Q:Math.abs(h)<options.minStep||c===a||c===b?(options.warn=Math.max(options.warn,1),Q):quadstep(f,a,c,fa,fd,fc,options)+quadstep(f,c,b,fc,fe,fb,options):(options.warn=Math.max(options.warn,3),Q)};functnPrototype.quad=function(a,b,options){"undefined"==typeof options&&(options={});var Q,f=this,warnMessage=["Calculation succeded","Minimum step size reached","Maximum function count exceeded","Infinite or NaN function value encountered"];return options.calls=3,options.warn=0,a===-1/0&&(a=-Number.MAX_VALUE),1/0===b&&(b=Number.MAX_VALUE),"minStep"in options||(options.minStep=1e-15),"maxCalls"in options||(options.maxCalls=1e4),"tolerance"in options||(options.tolerance=1e-5),Q=quadstep(f,a,b,f(a),f((a+b)/2),f(b),options),options.warnMessage=warnMessage[options.warn],Q},functnPrototype.toContentMathML=function(){return this.expression.toContentMathML()},functnPrototype.toLaTeX=function(){return this.expression.toLaTeX()},functnPrototype.toMathML=function(){return this.expression.toMathML()},functnPrototype.toString=function(){return this.expression.toString()};var func,cur,functionList1={fallingFactorial:function(n,m,s){var j,factorial=1;for(s=s||1,j=0;m>j;j++)factorial*=n-j*s;return factorial},fibonacci:function(n){return Math.floor(Math.pow(MathLib.goldenRatio,n)/Math.sqrt(5))},isFinite:function(x){return Math.abs(x)<1/0},isInt:function(x){return x%1===0},isNegZero:function(x){return 1/x===-1/0},isOne:function(a){return Math.abs(a-1)<MathLib.epsilon},isPosZero:function(x){return 1/x===1/0},isReal:function(x){return Math.abs(x)<1/0},isZero:function(x){return Math.abs(x)<MathLib.epsilon},random:Math.random,risingFactorial:function(n,m,s){var j,factorial=1;for(s=s||1,j=0;m>j;j++)factorial*=n+j*s;return factorial},round:function(x){return 0===x?x:Math.round(x)},trunc:function(x,n){return x.toFixed(n||0)}},createFunction1=function(f,name){return function(x){return"number"==typeof x?f.apply(null,arguments):"function"==typeof x?function(y){return f(x(y))}:"set"===x.type?new MathLib.Set(x.map(f)):"complex"===x.type||"integer"===x.type||"rational"===x.type?x[name].apply(x,Array.prototype.slice.call(arguments,1)):Array.isArray(x)?x.map(f):x[name]()}};for(func in functionList1)functionList1.hasOwnProperty(func)&&(cur=functionList1[func],Object.defineProperty(exports,func,{value:createFunction1(functionList1[func],func)}));MathLib.compare=function(a,b){return MathLib.type(a)!==MathLib.type(b)?MathLib.sign(MathLib.type(a).localeCompare(MathLib.type(b))):"number"==typeof a?MathLib.sign(a-b):"string"==typeof a?a.localeCompare(b):a.compare(b)},MathLib.evaluate=function(x){return Array.isArray(x)?x.map(MathLib.evaluate):"object"==typeof x&&"evaluate"in Object.getPrototypeOf(x)?x.evaluate():x},MathLib.type=function(x){return null===x?"null":void 0===x?"undefined":x.type?x.type:(x.constructor.name||Object.prototype.toString.call(x).slice(8,-1)).toLowerCase()},MathLib.is=function(obj,type){var ucfirst=function(str){return str.slice(0,1).toUpperCase()+str.slice(1)},glbl={Object:Object,Function:Function,RegExp:RegExp,Array:Array},classes=["circle","complex","conic","expression","functn","integer","line","matrix","permutation","point","polynomial","rational","screen","screen2d","screen3d","set","vector"];return MathLib.type(obj)===type?!0:-1!==classes.indexOf(type)?obj instanceof MathLib[ucfirst(type)]:obj instanceof glbl[ucfirst(type)]},MathLib.isMathMLSupported=function(){var ns,div,mfrac,hasMathML=!1;return"undefined"!=typeof document&&document.createElementNS&&(ns="http://www.w3.org/1998/Math/MathML",div=document.createElement("div"),div.style.position="absolute",mfrac=div.appendChild(document.createElementNS(ns,"math")).appendChild(document.createElementNS(ns,"mfrac")),mfrac.appendChild(document.createElementNS(ns,"mi")).appendChild(document.createTextNode("xx")),mfrac.appendChild(document.createElementNS(ns,"mi")).appendChild(document.createTextNode("yy")),document.body.appendChild(div),hasMathML=div.offsetHeight>div.offsetWidth,document.body.removeChild(div)),hasMathML},MathLib.writeMathML=function(id,math){var formula;document.getElementById(id).innerHTML="<math>"+math+"</math>","undefined"!=typeof MathJax&&(formula=MathJax.Hub.getAllJax(id)[0],MathJax.Hub.Queue(["Typeset",MathJax.Hub,id]))},MathLib.loadMathJax=function(config){var script=document.createElement("script");script.type="text/javascript",script.src="http://cdn.mathjax.org/mathjax/latest/MathJax.js",config=config||'MathJax.Hub.Config({config: ["MMLorHTML.js"],jax: ["input/TeX", "input/MathML", "output/HTML-CSS", "output/NativeMML"],extensions: ["tex2jax.js", "mml2jax.js", "MathMenu.js", "MathZoom.js"],TeX: {extensions: ["AMSmath.js", "AMSsymbols.js", "noErrors.js", "noUndefined.js"]}});',window.opera?script.innerHTML=config:script.text=config,document.getElementsByTagName("head")[0].appendChild(script)};var nAryFunctions={and:function(args){return args.every(function(x){return!!x})},arithMean:function(n){return MathLib.plus(n)/n.length},gcd:function(a){var min,reduction=function(x){return x!==min?x%min:x},isntZero=function(x){return 0!==x};if(a=a.filter(isntZero).map(Math.abs),0===a.length)return 0;for(;a.length>1;)min=MathLib.min(a),a=a.map(reduction).filter(isntZero);return a[0]||min},geoMean:function(n){return MathLib.root(MathLib.times(n),n.length)},harmonicMean:function(n){return n.length/MathLib.plus(n.map(function(entry){return MathLib.inverse(entry)}))},hypot:function(n){var a,b,max,min;return 1===n.length?Math.abs(n[0]):n.length>2?n.reduce(function(a,b){return MathLib.hypot(a,b)}):(a=MathLib.abs(n[0]),b=MathLib.abs(n[1]),1/0===a||1/0===b?1/0:0===a&&0===b?0:(max=Math.max(a,b),min=Math.min(a,b),max*Math.sqrt(1+Math.pow(min/max,2))))},hypot2:function(n){return n.some(function(x){return 1/0===x||x===-1/0})?1/0:n.reduce(function(old,cur){return old+cur*cur},0)},isEqual:function(n){return n.every(function(a,i,args){return a===args[0]?!0:"number"==typeof a&&"number"==typeof args[0]?Math.abs(a-args[0])<=3e-15:"object"==typeof a?a.isEqual(args[0]):"object"==typeof args[0]?args[0].isEqual(a):!1})},lcm:function(n){return 0===n.length?0:1===n.length?n[0]:2===n.length?MathLib.times(n)/MathLib.gcd(n):n.length>2?n.reduce(function(x,y){return MathLib.lcm(x,y)}):void 0},max:function(n){return Math.max.apply(null,n)},min:function(n){return Math.min.apply(null,n)},or:function(args){return args.some(function(x){return!!x})},plus:function(n){return 0===n.length?0:n.reduce(function(a,b){var f1,f2,aExpr,bExpr;return"number"==typeof a&&"number"==typeof b?a+b:"functn"===a.type||"functn"===b.type?(f1=a,f2=b,aExpr=a.expression?a.expression.content[0]:{},bExpr=b.expression?b.expression.content[0]:{},"functn"!==a.type?(f1=function(){return a},aExpr=new MathLib.Expression({value:a,subtype:"number"})):"functn"!==b.type&&(f2=function(){return b},bExpr=new MathLib.Expression({value:b,subtype:"number"})),MathLib.Functn(function(x){return MathLib.plus(f1(x),f2(x))},{expression:new MathLib.Expression({subtype:"functionDefinition",args:["x"],content:[new MathLib.Expression({content:[aExpr,bExpr],subtype:"naryOperator",value:"+",name:"plus"})]})})):"object"==typeof a?a.plus(b):"object"==typeof b?b.plus(a):void 0})},times:function(n){return 0===n.length?1:n.reduce(function(a,b){var f1,f2,aExpr,bExpr;return"number"==typeof a&&"number"==typeof b?a*b:"functn"===a.type||"functn"===b.type?(f1=a,f2=b,aExpr=a.expression?a.expression.content[0]:{},bExpr=b.expression?b.expression.content[0]:{},"functn"!==a.type?(f1=function(){return a},aExpr=new MathLib.Expression({value:a,subtype:"number"})):"functn"!==b.type&&(f2=function(){return b},bExpr=new MathLib.Expression({value:b,subtype:"number"})),MathLib.Functn(function(x){return MathLib.times(f1(x),f2(x))},{expression:new MathLib.Expression({subtype:"functionDefinition",args:["x"],content:[new MathLib.Expression({content:[aExpr,bExpr],subtype:"naryOperator",value:"*",name:"times"})]})})):"object"==typeof a?a.times(b):"object"==typeof b?b.times(a):void 0})},xor:function(args){return args.reduce(function(x,y){return x+!!y},0)%2!==0}},createNaryFunction=function(f){return function(n){return"set"===MathLib.type(n)?f(n.slice()):("array"!==MathLib.type(n)&&(n=Array.prototype.slice.apply(arguments)),f(n))}};for(func in nAryFunctions)nAryFunctions.hasOwnProperty(func)&&Object.defineProperty(exports,func,{value:createNaryFunction(nAryFunctions[func])});var args,fn;for(var fnName in fns)fns.hasOwnProperty(fnName)&&(fn=fns[fnName],args="args"in fn?fn.args.map(function(x){return MathLib.Expression.variable(x)}):"arity"in fn?["x","y","z"].slice(0,fn.arity).map(function(x){return MathLib.Expression.variable(x)}):[MathLib.Expression.variable("x")],Object.defineProperty(exports,fnName,{value:MathLib.Functn(fns[fnName].functn,{name:fnName,arity:args.length,expression:new MathLib.Expression({subtype:"functionDefinition",args:args,content:[new MathLib.Expression({subtype:"functionCall",content:args,value:fnName,cdgroup:fn.cdgroup,contentMathMLName:fn.contentMathMLName||fnName})]})}),writable:!0,enumerable:!0,configurable:!0}),"toContentMathML"in fn&&(exports[fnName].expression.content[0].toContentMathML=function(fn){return function(){for(var MathML="<apply>",i=0,ii=fn.toContentMathML.length-1;ii>i;i++)MathML+=fn.toContentMathML[i]+this.content[i].toContentMathML();return MathML+=fn.toContentMathML[i],MathML+="</apply>"}}(fn)),"toLaTeX"in fn&&(exports[fnName].expression.content[0].toLaTeX=function(fn){return function(){for(var LaTeX="",i=0,ii=fn.toLaTeX.length-1;ii>i;i++)LaTeX+=fn.toLaTeX[i]+this.content[i].toLaTeX();return LaTeX+=fn.toLaTeX[i]}}(fn)),"toMathML"in fn&&(exports[fnName].expression.content[0].toMathML=function(fn){return function(){for(var MathML="<mrow>",i=0,ii=fn.toMathML.length-1;ii>i;i++)MathML+=fn.toMathML[i]+this.content[i].toMathML();return MathML+=fn.toMathML[i],MathML+="</mrow>"}}(fn)),fn.hasOwnProperty("toString")&&(exports[fnName].expression.content[0].toString=function(fn){return function(){for(var str="",i=0,ii=fn.toString.length-1;ii>i;i++)str+=fn.toString[i]+this.content[i].toString();return str+=fn.toString[i]}}(fn)));MathLib.abs=exports.abs,MathLib.arccos=exports.arccos,MathLib.arccot=exports.arccot,MathLib.arccsc=exports.arccsc,MathLib.arcosh=exports.arcosh,MathLib.arcoth=exports.arcoth,MathLib.arcsch=exports.arcsch,MathLib.arcsec=exports.arcsec,MathLib.arcsin=exports.arcsin,MathLib.arctan=exports.arctan,MathLib.arsech=exports.arsech,MathLib.arsinh=exports.arsinh,MathLib.artanh=exports.artanh,MathLib.binomial=exports.binomial,MathLib.ceil=exports.ceil,MathLib.cbrt=exports.cbrt,MathLib.conjugate=exports.conjugate,MathLib.copy=exports.copy,MathLib.cos=exports.cos,MathLib.cosh=exports.cosh,MathLib.cot=exports.cot,MathLib.coth=exports.coth,MathLib.csc=exports.csc,MathLib.csch=exports.csch,MathLib.degToRad=exports.degToRad,MathLib.exp=exports.exp,MathLib.factorial=exports.factorial,MathLib.floor=exports.floor,MathLib.identity=exports.identity,MathLib.inverse=exports.inverse,MathLib.isFinite=exports.isFinite,MathLib.isInt=exports.isInt,MathLib.isNaN=exports.isNaN,MathLib.isNegZero=exports.isNegZero,MathLib.isOne=exports.isOne,MathLib.isPosZero=exports.isPosZero,MathLib.isPrime=exports.isPrime,MathLib.isReal=exports.isReal,MathLib.isZero=exports.isZero,MathLib.lg=exports.lg,MathLib.ln=exports.ln,MathLib.logGamma=exports.logGamma,MathLib.negative=exports.negative,MathLib.not=exports.not,MathLib.radToDeg=exports.radToDeg,MathLib.rem=exports.rem,MathLib.sec=exports.sec,MathLib.sech=exports.sech,MathLib.sign=exports.sign,MathLib.sin=exports.sin,MathLib.sinh=exports.sinh,MathLib.sqrt=exports.sqrt,MathLib.tan=exports.tan,MathLib.tanh=exports.tanh,MathLib.arctan2=exports.arctan2,MathLib.divide=exports.divide,MathLib.equivalent=exports.equivalent,MathLib.implies=exports.implies,MathLib.log=exports.log,MathLib.minus=exports.minus,MathLib.mod=exports.mod,MathLib.pow=exports.pow,MathLib.root=exports.root,MathLib.divisors=exports.divisors,MathLib.factor=exports.factor,MathLib.fallingFactorial=exports.fallingFactorial,MathLib.fibonacci=exports.fibonacci,MathLib.risingFactorial=exports.risingFactorial,MathLib.round=exports.round,MathLib.trunc=exports.trunc,MathLib.and=exports.and,MathLib.arithMean=exports.arithMean,MathLib.gcd=exports.gcd,MathLib.geoMean=exports.geoMean,MathLib.harmonicMean=exports.harmonicMean,MathLib.hypot=exports.hypot,MathLib.hypot2=exports.hypot2,MathLib.isEqual=exports.isEqual,MathLib.lcm=exports.lcm,MathLib.max=exports.max,MathLib.min=exports.min,MathLib.or=exports.or,MathLib.plus=exports.plus,MathLib.times=exports.times,MathLib.xor=exports.xor}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var template=function(data){var p=[];return p.push(' <figure class="MathLib_figure" aria-describedby="MathLib_figcaption_'),p.push(data.uuid),p.push('">     <div class="MathLib_wrapper" style="width: '),p.push(data.width),p.push("px; height: "),p.push(data.height),p.push('px" tabindex="0" aria-hidden="true">   <div class="MathLib_info_message">Your browser does not seem to support WebGL.<br>   Please update your browser to see the plot.</div>  </div>      '),data.figcaption&&(p.push('   <figcaption class="MathLib_figcaption" id="MathLib_figcaption_'),p.push(data.uuid),p.push('">'),p.push(data.figcaption),p.push("</figcaption>  ")),p.push("  </figure>  "),data.contextMenu&&(p.push('  <div class="MathLib_contextMenuOverlay">   <menu class="MathLib_menu MathLib_mainmenu">          '),data.contextMenu.screenshot&&p.push('     <div class="MathLib_screenshot MathLib_menuItem">Save Screenshot</div>    '),p.push("      "),data.contextMenu.fullscreen&&p.push('     <div class="MathLib_fullscreen MathLib_menuItem">      <span class="needs-nofullscreen">Enter Fullscreen</span>      <span class="needs-fullscreen">Exit Fullscreen</span>     </div>    '),p.push("      "),data.contextMenu.grid&&(p.push('     <div class="MathLib_menuItem MathLib_hasSubmenu">      Grid      <menu class="MathLib_menu MathLib_submenu">       <div class="MathLib_needs2D">        <label class="MathLib_menuItem">         <input type="radio" name="MathLib_grid_type_'),p.push(data.uuid),p.push('" class="MathLib_radio MathLib_grid_type" value="cartesian">cartesian        </label>        <label class="MathLib_menuItem">         <input type="radio" name="MathLib_grid_type_'),p.push(data.uuid),p.push('" class="MathLib_radio MathLib_grid_type" value="polar">polar        </label>        <label class="MathLib_menuItem">         <input type="radio" name="MathLib_grid_type_'),p.push(data.uuid),p.push('" class="MathLib_radio MathLib_grid_type" value="none">none        </label>       </div>        <div class="MathLib_needs3D MathLib_menuItem MathLib_is_disabled" style="font-size: 0.7em">        Gridoptions for 3D are coming soon.       </div>      </menu>     </div>    ')),p.push('      <hr class="MathLib_separator">    <div class="MathLib_is_disabled MathLib_menuItem MathLib_is_centered" style="font-size:0.83em">     Plot generated by MathLib.js    </div>   </menu>  </div> ')),p.push(""),p.join("")},Screen=function(){function Screen(id,options){"undefined"==typeof options&&(options={});var _this=this;this.type="screen";var fullscreenchange,that=this,defaults={height:500,width:500,contextMenu:{screenshot:!0,fullscreen:!0,grid:!0},figcaption:""},opts=MathLib.extendObject(defaults,options),container=document.getElementById(id),innerHTMLContextMenu="";opts.uuid=+new Date,container.innerHTML=template(opts),container.className+=" MathLib_container",this.height=opts.height,this.width=opts.width,this.options=opts,this.container=container,this.figure=container.getElementsByClassName("MathLib_figure")[0],this.wrapper=container.getElementsByClassName("MathLib_wrapper")[0],this.contextMenu=container.getElementsByClassName("MathLib_mainmenu")[0],this.contextMenuOverlay=container.getElementsByClassName("MathLib_contextMenuOverlay")[0],this.innerHTMLContextMenu=innerHTMLContextMenu,this.wrapper.addEventListener("click",function(){return _this.wrapper.focus()}),options.contextMenu&&(this.wrapper.oncontextmenu=function(evt){return _this.oncontextmenu(evt)},!opts.contextMenu.screenshot||"opera"in window||(this.contextMenu.getElementsByClassName("MathLib_screenshot")[0].onclick=function(){var dataURI,a=document.createElement("a");if("Canvas"===that.options.renderer&&"screen2D"===that.type){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.height=that.height,canvas.width=that.width,ctx.drawImage(that.layer.back.element,0,0),ctx.drawImage(that.layer.grid.element,0,0),ctx.drawImage(that.layer.axes.element,0,0),ctx.drawImage(that.layer.main.element,0,0),dataURI=canvas.toDataURL("image/png"),"download"in a?(a.href=dataURI,a.download="plot.png",a.click()):window.location.href=dataURI.replace("image/png","image/octet-stream")}"WebGL"===that.options.renderer&&"screen3D"===that.type?(dataURI=that.element.toDataURL("image/png"),"download"in a?(a.href=dataURI,a.download="plot.png",a.click()):window.location.href=dataURI.replace("image/png","image/octet-stream")):"SVG"===that.options.renderer&&(dataURI="data:image/svg+xml,"+that.element.parentElement.innerHTML,"download"in a?(a.href=dataURI,a.download="plot.svg",a.click()):window.location.href=dataURI.replace("image/svg+xml","image/octet-stream"))}),opts.contextMenu.fullscreen&&"requestFullScreen"in document.body&&(this.contextMenu.getElementsByClassName("MathLib_fullscreen")[0].onclick=function(){document.fullscreenElement?document.exitFullScreen():that.container.requestFullScreen()}),opts.contextMenu.grid&&(this.contextMenu.getElementsByClassName("MathLib_grid_type")[0].onchange=function(){that.options.grid.type="cartesian",that.draw()},this.contextMenu.getElementsByClassName("MathLib_grid_type")[1].onchange=function(){that.options.grid.type="polar",that.draw()},this.contextMenu.getElementsByClassName("MathLib_grid_type")[2].onchange=function(){that.options.grid.type=!1,that.draw()})),fullscreenchange=function(){document.fullscreenElement?(that.origWidth=that.width,that.origHeight=that.height,that.resize(window.outerWidth,window.outerHeight)):(that.resize(that.origWidth,that.origHeight),delete that.origWidth,delete that.origHeight)},"onfullscreenchange"in this.container?this.container.addEventListener("fullscreenchange",fullscreenchange):"onmozfullscreenchange"in this.container?this.container.addEventListener("mozfullscreenchange",fullscreenchange):"onwebkitfullscreenchange"in this.container&&this.container.addEventListener("webkitfullscreenchange",fullscreenchange)}return Screen.prototype.oncontextmenu=function(evt){var listener,_this=this,menu=this.contextMenu,overlay=this.contextMenuOverlay;evt.preventDefault&&evt.preventDefault(),evt.returnValue=!1,menu.style.setProperty("top",evt.clientY-20+"px"),menu.style.setProperty("left",evt.clientX+"px"),overlay.style.setProperty("display","block"),listener=function(){overlay.style.setProperty("display","none"),Array.prototype.forEach.call(_this.contextMenu.getElementsByClassName("MathLib_temporaryMenuItem"),function(x){_this.contextMenu.removeChild(x)}),overlay.removeEventListener("click",listener)},overlay.addEventListener("click",listener)},Screen}();MathLib.Screen=Screen}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Layer=function(){function Layer(screen,id,zIndex){var _this=this;this.screen=screen,this.id=id,this.zIndex=zIndex,this.stack=[],this.transformation=screen.transformation;var element,devicePixelRatio=window.devicePixelRatio||1;if("Canvas"===screen.options.renderer)element=document.createElement("canvas"),element.className+=" MathLib_screen",element.width=screen.width*devicePixelRatio,element.height=screen.height*devicePixelRatio,1!==devicePixelRatio&&(element.style.transformOrigin="top left",element.style["-ms-transformOrigin"]="top left",element.style.transform="scale("+1/devicePixelRatio+")",element.style["-ms-transform"]="scale("+1/devicePixelRatio+")",element.style["-webkit-transform"]="scale("+1/devicePixelRatio+")"),screen.wrapper.appendChild(element),this.element=element,this.ctx=element.getContext("2d"),this.applyTransformation=function(){var m=_this.transformation;_this.ctx.setTransform(devicePixelRatio*m[0][0],m[1][0],m[0][1],devicePixelRatio*m[1][1],devicePixelRatio*m[0][2],devicePixelRatio*m[1][2])},this.applyTransformation(),"back"===id?this.draw=function(){var top=-screen.translation.y/screen.scale.y,bottom=(screen.height-screen.translation.y)/screen.scale.y,left=-screen.translation.x/screen.scale.x,right=(screen.width-screen.translation.x)/screen.scale.x;this.ctx.fillStyle=MathLib.colorConvert(screen.options.background),this.ctx.fillRect(left,bottom,right-left,top-bottom),this.stack.forEach(function(x){"conic"===x.type?x.object.draw(_this,x.options,!0):"text"===x.type?_this.text(x.object,x.x,x.y,x.options,!0):"pixel"===x.type?_this.pixel(x.object,x.t,x.r,x.b,x.l,x.options,!0):_this[x.type](x.object,x.options,!0)})}:"grid"===id?(this.ctx.strokeStyle=MathLib.colorConvert(screen.options.grid.color)||"#cccccc",this.ctx.fillStyle="rgba(255, 255, 255, 0)",this.draw=function(){_this.screen.drawGrid()}):"axes"===id?(this.ctx.strokeStyle=MathLib.colorConvert(screen.options.axes.color)||"#000000",this.draw=function(){_this.ctx.lineWidth=4/(screen.scale.x-screen.scale.y),_this.screen.drawAxes()}):(this.ctx.strokeStyle="#000000",this.ctx.fillStyle="rgba(255, 255, 255, 0)",this.draw=function(){_this.ctx.lineWidth=4/(screen.scale.x-screen.scale.y),this.stack.forEach(function(x){"conic"===x.type?x.object.draw(_this,x.options,!0):"text"===x.type?_this.text(x.object,x.x,x.y,x.options,!0):"pixel"===x.type?_this.pixel(x.object,x.t,x.r,x.b,x.l,x.options,!0):_this[x.type](x.object,x.options,!0)
})}),this.circle=MathLib.Canvas.circle,this.line=MathLib.Canvas.line,this.path=MathLib.Canvas.path,this.pixel=MathLib.Canvas.pixel,this.point=MathLib.Canvas.point,this.text=MathLib.Canvas.text;else if("SVG"===screen.options.renderer){var ctx=document.createElementNS("http://www.w3.org/2000/svg","g"),m=screen.transformation;ctx.className.baseVal="MathLib_layer_"+id,ctx.setAttribute("transform","matrix("+m[0][0]+", "+m[1][0]+", "+m[0][1]+", "+m[1][1]+", "+m[0][2]+", "+m[1][2]+")"),screen.element.appendChild(ctx),this.ctx=ctx,"back"===id?this.draw=function(){this.stack.forEach(function(x){"conic"===x.type?x.object.draw(_this,x.options,!0):"text"===x.type?_this.text(x.object,x.x,x.y,x.options,!0):"pixel"===x.type?_this.pixel(x.object,x.t,x.r,x.b,x.l,x.options,!0):_this[x.type](x.object,x.options,!0)})}:"grid"===id?(ctx.setAttribute("stroke",MathLib.colorConvert(screen.options.grid.color)||"#cccccc"),this.draw=function(){ctx.setAttribute("stroke-width",4/(screen.scale.x-screen.scale.y)+""),_this.screen.drawGrid()}):"axes"===id?(ctx.setAttribute("stroke",MathLib.colorConvert(screen.options.axes.color)||"#000000"),this.draw=function(){ctx.setAttribute("stroke-width",4/(screen.scale.x-screen.scale.y)+""),_this.screen.drawAxes()}):this.draw=function(){this.stack.forEach(function(x){"conic"===x.type?x.object.draw(_this,x.options,!0):"text"===x.type?_this.text(x.object,x.x,x.y,x.options,!0):"pixel"===x.type?_this.pixel(x.object,x.t,x.r,x.b,x.l,x.options,!0):_this[x.type](x.object,x.options,!0)})},this.circle=MathLib.SVG.circle,this.line=MathLib.SVG.line,this.path=MathLib.SVG.path,this.pixel=MathLib.SVG.pixel,this.point=MathLib.SVG.point,this.text=MathLib.SVG.text}screen.layer.splice(zIndex,0,this)}return Layer.prototype.clear=function(){return this.screen.renderer.clear(this),this},Layer}();MathLib.Layer=Layer}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";MathLib.Canvas={applyTransformation:function(){var m=this.transformation,devicePixelRatio=window.devicePixelRatio||1;this.layer.forEach(function(l){l.ctx.setTransform(devicePixelRatio*m[0][0],m[1][0],m[0][1],devicePixelRatio*m[1][1],devicePixelRatio*m[0][2],devicePixelRatio*m[1][2])})},circle:function(circle,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var prop,opts,screen=this.screen,ctx=this.ctx;if(ctx.save(),ctx.lineWidth=(options.lineWidth||4)/(screen.scale.x-screen.scale.y),options){opts=MathLib.Canvas.convertOptions(options);for(prop in opts)opts.hasOwnProperty(prop)&&(ctx[prop]=opts[prop]);"setLineDash"in ctx&&ctx.setLineDash("dash"in options?options.dash:[]),"lineDashOffset"in ctx&&(ctx.lineDashOffset="dashOffset"in options?options.dashOffset:0)}return ctx.beginPath(),ctx.arc(circle.center[0],circle.center[1],circle.radius,0,2*Math.PI),ctx.closePath(),ctx.fill(),ctx.stroke(),ctx.restore(),redraw||this.stack.push({type:"circle",object:circle,options:options}),this},clear:function(layer){var screen=layer.screen,left=-screen.translation.x/screen.scale.x,top=-screen.translation.y/screen.scale.y,width=screen.width/screen.scale.x,height=screen.height/screen.scale.y;layer.ctx.clearRect(left,top,width,height)},convertOptions:function(options){var convertedOptions={};return"fillColor"in options?convertedOptions.fillStyle=MathLib.colorConvert(options.fillColor):"color"in options&&(convertedOptions.fillStyle=MathLib.colorConvert(options.color)),"font"in options&&(convertedOptions.font=options.font),"fontSize"in options&&(convertedOptions.fontSize=options.fontSize),"lineColor"in options?convertedOptions.strokeStyle=MathLib.colorConvert(options.lineColor):"color"in options&&(convertedOptions.strokeStyle=MathLib.colorConvert(options.color)),convertedOptions},line:function(line,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var points,prop,opts,screen=this.screen,ctx=this.ctx;if(ctx.save(),ctx.lineWidth=(options.lineWidth||4)/(screen.scale.x-screen.scale.y),"line"===line.type&&MathLib.isZero(line[0])&&MathLib.isZero(line[1]))return this;if(points=this.screen.getLineEndPoints(line),options){opts=MathLib.Canvas.convertOptions(options);for(prop in opts)opts.hasOwnProperty(prop)&&(ctx[prop]=opts[prop]);"setLineDash"in ctx&&ctx.setLineDash("dash"in options?options.dash:[]),"lineDashOffset"in ctx&&(ctx.lineDashOffset="dashOffset"in options?options.dashOffset:0)}return ctx.beginPath(),ctx.moveTo(points[0][0],points[0][1]),ctx.lineTo(points[1][0],points[1][1]),ctx.stroke(),ctx.closePath(),ctx.restore(),redraw||this.stack.push({type:"line",object:line,options:options}),this},path:function(curve,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var prop,opts,path,x,y,i,fx,fxold,from,to,screen=this.screen,ctx=this.ctx,paths=[],step=2/(screen.scale.x-screen.scale.y);if(ctx.save(),ctx.lineWidth=(options.lineWidth||4)/(screen.scale.x-screen.scale.y),options){opts=MathLib.Canvas.convertOptions(options);for(prop in opts)opts.hasOwnProperty(prop)&&(ctx[prop]=opts[prop]);"setLineDash"in ctx&&ctx.setLineDash("dash"in options?options.dash:[]),"lineDashOffset"in ctx&&(ctx.lineDashOffset="dashOffset"in options?options.dashOffset:0)}if("function"==typeof curve){path=[],from=("from"in options?options.from:-screen.translation.x/screen.scale.x)-step,to=("to"in options?options.to:(screen.width-screen.translation.x)/screen.scale.x)+step;for(i=from;to>=i;i+=step)fx=curve(i),fx!==fx||MathLib.abs((fxold-fx)/step)>=100&&(fx-curve(i-step/2))*(fxold-curve(i-step/2))>=0?path.length&&(paths.push(path),path=[]):path.push([i,fx]),fxold=fx;path.length&&paths.push(path)}else if("function"==typeof curve[0]){path=[],x=curve[0],y=curve[1],from=("from"in options?options.from:0)-step,to=("to"in options?options.to:2*Math.PI)+step;for(i=from;to>=i;i+=step)path.push([x(i),y(i)]);paths.push(path)}else path=curve;return(options.fillColor||"transparent"!==options.fillColor)&&(ctx.beginPath(),ctx.lineTo(from,0),paths.forEach(function(path){ctx.lineTo(path[0][0],0),path.forEach(function(x){ctx.lineTo(x[0],x[1])}),ctx.lineTo(path[path.length-1][0],0)}),ctx.fill()),(options.lineColor||"transparent"!==options.lineColor)&&(ctx.beginPath(),paths.forEach(function(path){ctx.moveTo(path[0][0],path[0][1]),path.forEach(function(x){ctx.lineTo(x[0],x[1])})}),ctx.stroke()),ctx.restore(),redraw||this.stack.push(options.conic?{type:"conic",object:options.conic,options:options}:{type:"path",object:curve,options:options}),this},pixel:function(f,t,r,b,l,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var x,y,i,screen=this.screen,top=-screen.translation.y/screen.scale.y,bottom=(screen.height-screen.translation.y)/screen.scale.y,left=-screen.translation.x/screen.scale.x,right=(screen.width-screen.translation.x)/screen.scale.x,ctx=this.ctx;t=Math.min(top,t),r=Math.min(right,r),b=Math.max(bottom,b),l=Math.max(left,l);var pxl,tPxl=Math.floor(-t*screen.scale.y),rPxl=Math.floor(r*screen.scale.x),bPxl=Math.floor(-b*screen.scale.y),lPxl=Math.floor(l*screen.scale.x),w=rPxl-lPxl,h=bPxl-tPxl,imgData=ctx.createImageData(w,h);for(y=tPxl,i=0;y>bPxl;y--)for(x=lPxl;rPxl>x;x++,i++)pxl=f(x/screen.scale.x,y/screen.scale.y),imgData.data[4*i]=pxl[0],imgData.data[4*i+1]=pxl[1],imgData.data[4*i+2]=pxl[2],imgData.data[4*i+3]=pxl[3];return ctx.putImageData(imgData,(left-l)*screen.scale.x,(t-top)*screen.scale.y),redraw||this.stack.push({type:"pixel",object:f,t:t,r:r,b:b,l:l,options:options}),this},point:function(point,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var prop,opts,dist,screen=this.screen,ctx=this.ctx;if(ctx.save(),ctx.lineWidth=(options.lineWidth||4)/(screen.scale.x-screen.scale.y),options){opts=MathLib.Canvas.convertOptions(options),"fillColor"in options||"color"in options||(opts.fillStyle="black");for(prop in opts)opts.hasOwnProperty(prop)&&(ctx[prop]=opts[prop]);"setLineDash"in ctx&&ctx.setLineDash("dash"in options?options.dash:[]),"lineDashOffset"in ctx&&(ctx.lineDashOffset="dashOffset"in options?options.dashOffset:0)}return ctx.beginPath(),ctx.arc(point[0]/point[2],point[1]/point[2],(options.size||10)/(screen.scale.x-screen.scale.y),0,2*Math.PI),ctx.closePath(),ctx.fill(),ctx.stroke(),ctx.restore(),options.label&&(dist=1.75*(options.size||10)+.75*(options.lineWidth||4),screen.text(options.label,point[0]/point[2]+dist/(screen.scale.x-screen.scale.y),point[1]/point[2]+dist/(screen.scale.x-screen.scale.y),options,!0)),redraw||this.stack.push({type:"point",object:point,options:options}),this},text:function(str,x,y,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var ctx,prop,opts,defaults={font:"Helvetica",fontSize:12,textColor:"rgba(0, 0, 0, 1)"};ctx=this.ctx,opts=MathLib.Canvas.convertOptions(MathLib.extendObject(defaults,options));for(prop in opts)opts.hasOwnProperty(prop)&&(ctx[prop]=opts[prop]);ctx.fillStyle=MathLib.colorConvert(options.textColor||options.color||defaults.textColor),ctx.strokeStyle=MathLib.colorConvert(options.textColor||options.color||defaults.textColor),ctx.font=opts.fontSize+"px "+opts.font,ctx.textAlign="center",ctx.textBaseline="middle";var tf=this.screen.transformation;return ctx.save(),ctx.transform(1/tf[0][0],0,0,1/tf[1][1],0,0),ctx.fillText(str,tf[0][0]*x,tf[1][1]*y),ctx.restore(),redraw||this.stack.push({type:"text",object:str,x:x,y:y,options:options}),this}}}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";MathLib.SVG={applyTransformation:function(){var m=this.transformation;this.layer.forEach(function(l){l.ctx.setAttribute("transform","matrix("+m[0][0]+", "+m[1][0]+", "+m[0][1]+", "+m[1][1]+", "+m[0][2]+", "+m[1][2]+")")})},circle:function(circle,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var prop,opts,screen=this.screen,svgCircle=document.createElementNS("http://www.w3.org/2000/svg","circle");if(svgCircle.setAttribute("cx",circle.center[0]),svgCircle.setAttribute("cy",circle.center[1]),svgCircle.setAttribute("r",circle.radius),options){svgCircle.setAttribute("stroke-width",(options.lineWidth||4)/(screen.scale.x-screen.scale.y)+""),opts=MathLib.SVG.convertOptions(options);for(prop in opts)opts.hasOwnProperty(prop)&&svgCircle.setAttribute(prop,opts[prop])}return this.ctx.appendChild(svgCircle),redraw||this.stack.push({type:"circle",object:circle,options:options}),this},clear:function(layer){layer.ctx.textContent=""},convertOptions:function(options){var convertedOptions={};return"fillColor"in options?convertedOptions.fill=MathLib.colorConvert(options.fillColor):"color"in options&&(convertedOptions.fill=MathLib.colorConvert(options.color)),"font"in options&&(convertedOptions.font=options.font),"fontSize"in options&&(convertedOptions.fontSize=options.fontSize),"lineColor"in options?convertedOptions.stroke=MathLib.colorConvert(options.lineColor):"color"in options&&(convertedOptions.stroke=MathLib.colorConvert(options.color)),"dash"in options&&0!==options.dash.length&&(convertedOptions["stroke-dasharray"]=options.dash),"dashOffset"in options&&0!==options.dashOffset&&(convertedOptions["stroke-dashoffset"]=options.dashOffset),convertedOptions},line:function(line,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var points,prop,opts,screen=this.screen,svgLine=document.createElementNS("http://www.w3.org/2000/svg","line");if("line"===line.type&&MathLib.isZero(line[0])&&MathLib.isZero(line[1]))return this;if(points=this.screen.getLineEndPoints(line),svgLine.setAttribute("x1",points[0][0]),svgLine.setAttribute("y1",points[0][1]),svgLine.setAttribute("x2",points[1][0]),svgLine.setAttribute("y2",points[1][1]),options){svgLine.setAttribute("stroke-width",(options.lineWidth||4)/(screen.scale.x-screen.scale.y)+""),opts=MathLib.SVG.convertOptions(options);for(prop in opts)opts.hasOwnProperty(prop)&&svgLine.setAttribute(prop,opts[prop])}return this.ctx.appendChild(svgLine),redraw||this.stack.push({type:"line",object:line,options:options}),this},path:function(curve,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var pathStringFill,pathStringStroke,from,to,prop,opts,x,y,i,path,fx,fxold,screen=this.screen,svgPathStroke=document.createElementNS("http://www.w3.org/2000/svg","path"),svgPathFill=document.createElementNS("http://www.w3.org/2000/svg","path"),step=2/(screen.scale.x-screen.scale.y),paths=[];if("function"==typeof curve){path=[],from=("from"in options?options.from:-screen.translation.x/screen.scale.x)-step,to=("to"in options?options.to:(screen.width-screen.translation.x)/screen.scale.x)+step;for(i=from;to>=i;i+=step)fx=curve(i),fx!==fx||MathLib.abs((fxold-fx)/step)>=100&&(fx-curve(i-step/2))*(fxold-curve(i-step/2))>=0?path.length&&(paths.push(path),path=[]):path.push([i,fx]),fxold=fx;path.length&&paths.push(path)}else if("function"==typeof curve[0]){path=[],x=curve[0],y=curve[1],from=("from"in options?options.from:0)-step,to=("to"in options?options.to:2*Math.PI)+step;for(i=from;to>=i;i+=step)path.push([x(i),y(i)]);paths.push(path)}else path=curve;if(pathStringFill="M"+from+" 0 "+paths.reduce(function(previ,path){return previ+" L "+path[0][0]+" 0 "+path.reduce(function(prev,cur){return prev+" L "+cur.join(" ")},"")+" L "+path[path.length-1][0]+" 0 "},""),pathStringStroke=paths.reduce(function(previ,path){return previ+" M "+path[0].join(" ")+path.reduce(function(prev,cur){return prev+" L "+cur.join(" ")},"")},""),""!==pathStringFill&&svgPathFill.setAttribute("d",pathStringFill),pathStringStroke&&svgPathStroke.setAttribute("d",pathStringStroke),svgPathStroke.setAttribute("stroke-width",(options.lineWidth||4)/(screen.scale.x-screen.scale.y)+""),options){opts=MathLib.SVG.convertOptions(options);for(prop in opts)opts.hasOwnProperty(prop)&&(svgPathFill.setAttribute(prop,opts[prop]),svgPathStroke.setAttribute(prop,opts[prop]))}return svgPathFill.setAttribute("stroke","transparent"),svgPathStroke.setAttribute("fill","transparent"),this.ctx.appendChild(svgPathFill),this.ctx.appendChild(svgPathStroke),redraw||this.stack.push(options.conic?{type:"conic",object:options.conic,options:options}:{type:"path",object:curve,options:options}),this},pixel:function(f,t,r,b,l,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var x,y,i,pxl,screen=this.screen,top=-screen.translation.y/screen.scale.y,bottom=(screen.height-screen.translation.y)/screen.scale.y,left=-screen.translation.x/screen.scale.x,right=(screen.width-screen.translation.x)/screen.scale.x,canvas=document.createElement("canvas"),canvasCtx=canvas.getContext("2d"),svgImage=document.createElementNS("http://www.w3.org/2000/svg","image"),svgContainer=document.createElementNS("http://www.w3.org/2000/svg","g"),m=screen.transformation;canvas.width=screen.width,canvas.height=screen.height,canvasCtx.setTransform(m[0][0],m[1][0],m[0][1],m[1][1],m[0][2],m[1][2]),svgContainer.setAttribute("transform","matrix("+1/m[0][0]+", 0, 0, "+1/m[1][1]+", -"+m[0][2]/m[0][0]+", "+-m[1][2]/m[1][1]+")"),svgImage.setAttribute("width",screen.width+"px"),svgImage.setAttribute("height",screen.height+"px"),svgImage.setAttribute("x","0"),svgImage.setAttribute("y","0"),t=Math.min(top,t),r=Math.min(right,r),b=Math.max(bottom,b),l=Math.max(left,l);var tPxl=Math.floor(-t*screen.scale.y),rPxl=Math.floor(r*screen.scale.x),bPxl=Math.floor(-b*screen.scale.y),lPxl=Math.floor(l*screen.scale.x),w=rPxl-lPxl,h=tPxl-bPxl,imgData=canvasCtx.createImageData(w,h);for(y=tPxl,i=0;y>bPxl;y--)for(x=lPxl;rPxl>x;x++,i++)pxl=f(x/screen.scale.x,y/screen.scale.y),imgData.data[4*i]=pxl[0],imgData.data[4*i+1]=pxl[1],imgData.data[4*i+2]=pxl[2],imgData.data[4*i+3]=pxl[3];return canvasCtx.putImageData(imgData,0,0),svgImage.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",canvas.toDataURL()),svgContainer.appendChild(svgImage),this.ctx.appendChild(svgContainer),redraw||this.stack.push({type:"pixel",object:f,t:t,r:r,b:b,l:l,options:options}),this},point:function(point,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var prop,opts,dist,screen=this.screen,svgPoint=document.createElementNS("http://www.w3.org/2000/svg","circle");if(svgPoint.setAttribute("cx",point[0]/point[2]+""),svgPoint.setAttribute("cy",point[1]/point[2]+""),svgPoint.setAttribute("r",(options.size||10)/(screen.scale.x-screen.scale.y)+""),options){svgPoint.setAttribute("stroke-width",(options.lineWidth||4)/(screen.scale.x-screen.scale.y)+""),opts=MathLib.SVG.convertOptions(options),"fillOpacity"in options||(opts["fill-opacity"]="1"),"fillColor"in options||"color"in options||(opts.fill="black");for(prop in opts)opts.hasOwnProperty(prop)&&svgPoint.setAttribute(prop,opts[prop])}return options.moveable&&(svgPoint.setAttribute("cursor","move"),svgPoint.addEventListener("mousedown",function(){screen.options.interaction.type="move";var invTransformation=screen.transformation.inverse(),move=function(evt){evt.stopPropagation();var evtPoint=invTransformation.times(screen.getEventPoint(evt));point[0]=evtPoint[0],point[1]=evtPoint[1],screen.draw()},up=function(){screen.options.interaction.type="",document.body.removeEventListener("mousemove",move),document.body.removeEventListener("mouseup",up)};document.body.addEventListener("mousemove",move),document.body.addEventListener("mouseup",up)})),this.ctx.appendChild(svgPoint),options.label&&(dist=1.75*(options.size||10)+.75*(options.lineWidth||4),screen.text(options.label,point[0]/point[2]+dist/(screen.scale.x-screen.scale.y),point[1]/point[2]+dist/(screen.scale.x-screen.scale.y),options,!0)),svgPoint.addEventListener("contextmenu",function(){screen.options.interaction.type="contextmenu";var x=svgPoint.cx.baseVal.value,y=svgPoint.cy.baseVal.value;screen.contextMenu.innerHTML='<div class="MathLib_menuItem MathLib_temporaryMenuItem MathLib_is_disabled MathLib_is_centered">Point</div><div class="MathLib_menuItem MathLib_temporaryMenuItem MathLib_hasSubmenu">Coordinates<menu class="MathLib_menu MathLib_submenu"><div class="MathLib_menuItem">cartesian: <span class="MathLib_is_selectable MathLib_is_right">('+x.toFixed(3)+", "+y.toFixed(3)+')</span></div><div class="MathLib_menuItem">polar: <span class="MathLib_is_selectable MathLib_is_right">('+MathLib.hypot(x,y).toFixed(3)+", "+Math.atan2(y,x).toFixed(3)+')</span></div></menu></div><div class="MathLib_menuItem MathLib_temporaryMenuItem MathLib_hasSubmenu">Options<menu class="MathLib_menu MathLib_submenu"><div class="MathLib_menuItem">Moveable:<input type="checkbox" class="MathLib_is_right"></div><div class="MathLib_menuItem">Size:<input type="spinner" class="MathLib_is_right"></div><div class="MathLib_menuItem">Fill color:<input type="color" class="MathLib_is_right"></div><div class="MathLib_menuItem">Line color:<input type="color" class="MathLib_is_right"></div></menu></div><hr class="MathLib_separator MathLib_temporaryMenuItem">'+screen.contextMenu.innerHTML}),redraw||this.stack.push({type:"point",object:point,options:options}),this},text:function(str,x,y,options,redraw){"undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1);var opts,defaults={font:"Helvetica",fontSize:12,textColor:"rgba(0, 0, 0, 1)"},screen=this.screen,svgText=document.createElementNS("http://www.w3.org/2000/svg","text"),svgTspan=document.createElementNS("http://www.w3.org/2000/svg","tspan");return opts=MathLib.SVG.convertOptions(MathLib.extendObject(defaults,options)),svgTspan.textContent=str,svgTspan.setAttribute("x",x*screen.scale.x+""),svgTspan.setAttribute("y",y*screen.scale.y+""),svgText.setAttribute("transform","matrix("+1/screen.scale.x+", 0, 0, "+1/screen.scale.y+", 0, 0)"),svgText.setAttribute("font-family",opts.font),svgText.setAttribute("font-size",opts.fontSize),svgText.setAttribute("fill",MathLib.colorConvert(options.textColor||options.color)||defaults.textColor),svgText.setAttribute("fill-opacity","1"),svgText.setAttribute("stroke",MathLib.colorConvert(options.textColor||options.color)||defaults.textColor),svgText.setAttribute("text-anchor","middle"),svgTspan.setAttribute("alignment-baseline","middle"),svgText.appendChild(svgTspan),this.ctx.appendChild(svgText),redraw||this.stack.push({type:"text",object:str,x:x,y:y,options:options}),this}}}(MathLib||(MathLib={}));var __extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},MathLib;!function(MathLib){"use strict";var Screen2D=function(_super){function Screen2D(id,options){"undefined"==typeof options&&(options={});var _this=this;_super.call(this,id,options),this.type="screen2D";var element,defaults={axes:{color:0,lineColor:0,textColor:0,label:{fontSize:12,font:"Helvetica",x:!0,y:!0},x:!0,y:!0},grid:{type:"cartesian",lineColor:13421772,lineWidth:4,dash:[],dashOffset:0,x:{tick:1,lineColor:13421772,lineWidth:4,dash:[],dashOffset:0},y:{tick:1,lineColor:13421772,lineWidth:4,dash:[],dashOffset:0},r:{tick:1,lineColor:13421772,lineWidth:4,dash:[],dashOffset:0},angle:{tick:Math.PI/8,lineColor:13421772,lineWidth:4,dash:[],dashOffset:0}},interaction:{allowPan:!0,allowZoom:!0,zoomSpeed:1},background:16777215,lookAt:{x:0,y:0},range:{x:1,y:1},figcaption:"",renderer:"Canvas",transformation:new MathLib.Matrix([[Math.min(this.height,this.width)/2,0,this.width/2],[0,-Math.min(this.height,this.width)/2,this.height/2],[0,0,1]])},opts=MathLib.extendObject(defaults,options),transformation=opts.transformation,that=this;if(this.options=opts,this.renderer=MathLib[opts.renderer],this.circle=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.circle.apply(_this.layer.main,args)},this.line=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.line.apply(_this.layer.main,args)},this.path=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.path.apply(_this.layer.main,args)},this.pixel=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.pixel.apply(_this.layer.main,args)},this.point=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.point.apply(_this.layer.main,args)},this.text=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.text.apply(_this.layer.main,args)},this.wrapper.innerHTML="",this.container.className+=" MathLib_screen2D",this.applyTransformation=function(){},this.translation={},this.scale={},this.transformation=transformation,Object.defineProperty(this.translation,"x",{get:function(){return that.transformation[0][2]},set:function(x){that.transformation[0][2]=x,that.applyTransformation()}}),Object.defineProperty(this.translation,"y",{get:function(){return that.transformation[1][2]},set:function(y){that.transformation[1][2]=y,that.applyTransformation()}}),Object.defineProperty(this.scale,"x",{get:function(){return that.transformation[0][0]},set:function(x){that.transformation[0][0]=x,that.applyTransformation()}}),Object.defineProperty(this.scale,"y",{get:function(){return that.transformation[1][1]},set:function(y){that.transformation[1][1]=y,that.applyTransformation()}}),this.lookAt={},this.range={},Object.defineProperty(this.lookAt,"x",{get:function(){return(that.width/2-that.transformation[0][2])/that.transformation[0][0]},set:function(x){that.transformation[0][2]=that.width/2-x*that.transformation[0][0],that.applyTransformation()}}),Object.defineProperty(this.lookAt,"y",{get:function(){return(that.height/2-that.transformation[1][2])/that.transformation[1][1]},set:function(y){that.transformation[1][2]=that.height/2-y*that.transformation[1][1],that.applyTransformation()}}),Object.defineProperty(this.range,"x",{get:function(){return that.width/(2*that.transformation[0][0])},set:function(x){that.transformation[0][0]=.5*that.width/x,that.applyTransformation()}}),Object.defineProperty(this.range,"y",{get:function(){return-that.height/(2*that.transformation[1][1])},set:function(y){that.transformation[1][1]=-.5*that.height/y,that.applyTransformation()}}),this.range.x=opts.range.x,this.range.y=opts.range.y,this.lookAt.x=opts.lookAt.x,this.lookAt.y=opts.lookAt.y,"SVG"===opts.renderer){element=document.createElementNS("http://www.w3.org/2000/svg","svg"),element.className.baseVal="MathLib_screen",element.setAttribute("xmlns","http://www.w3.org/2000/svg"),element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),element.setAttribute("height",this.height+"px"),element.setAttribute("width",this.width+"px"),element.setAttribute("version","1.1"),element.setAttribute("stroke","#000000"),element.setAttribute("stroke-opacity","1"),element.setAttribute("fill","transparent"),this.element=element,this.wrapper.appendChild(element);var background=document.createElementNS("http://www.w3.org/2000/svg","rect");background.setAttribute("x","0px"),background.setAttribute("y","0px"),background.setAttribute("width",this.width+"px"),background.setAttribute("height",this.height+"px"),background.setAttribute("stroke","transparent"),background.setAttribute("fill","background"in options?MathLib.colorConvert(options.background):"white"),background.setAttribute("fill-opacity","1"),this.element.appendChild(background)}if(this.layer=[],this.layer.back=new MathLib.Layer(this,"back",0),this.layer.grid=new MathLib.Layer(this,"grid",1),this.layer.axes=new MathLib.Layer(this,"axes",2),this.layer.main=new MathLib.Layer(this,"main",3),this.wrapper.addEventListener("keydown",function(evt){return _this.onkeydown(evt)},!1),this.wrapper.addEventListener("mouseup",function(evt){return _this.onmouseup(evt)},!1),this.wrapper.addEventListener("mousedown",function(evt){return _this.onmousedown(evt)},!1),this.wrapper.addEventListener("mousemove",function(evt){return _this.onmousemove(evt)},!1),this.wrapper.addEventListener("mousewheel",function(evt){return _this.onmousewheel(evt)},!1),this.wrapper.addEventListener("DOMMouseScroll",function(evt){return _this.onmousewheel(evt)},!1),this.applyTransformation=this.renderer.applyTransformation,this.draw=function(x,options){var _this=this;"undefined"==typeof options&&(options={}),0===arguments.length?this.layer.forEach(function(l){l.clear().draw()}):"circle"===x.type?this.circle(x,options):"line"===x.type?this.line(x,options):Array.isArray(x)&&x.forEach(function(y){return _this[y.type](y,options)})},this.options.contextMenu){var gridType=opts.grid.type?opts.grid.type:"none";this.contextMenu.querySelectorAll(".MathLib_grid_type[value="+gridType+"]")[0].checked=!0}this.draw()}return __extends(Screen2D,_super),Screen2D.prototype.drawAxes=function(){var i,_this=this,line=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.line.apply(_this.layer.axes,args)},text=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.text.apply(_this.layer.axes,args)},options={lineColor:MathLib.colorConvert(this.options.axes.color),"stroke-width":-1/this.transformation[1][1]},textOptions={font:this.options.axes&&"label"in this.options.axes?this.options.axes.label.font:"",fontSize:this.options.axes&&"label"in this.options.axes?this.options.axes.label.fontSize:"",strokeStyle:MathLib.colorConvert(this.options.axes.textColor),fillStyle:MathLib.colorConvert(this.options.axes.textColor)},top=-this.translation.y/this.scale.y,bottom=(this.height-this.translation.y)/this.scale.y,left=-this.translation.x/this.scale.x,right=(this.width-this.translation.x)/this.scale.x,lengthX=10/this.transformation[0][0],lengthY=-10/this.transformation[1][1],yExp=1-Math.floor(Math.log(-this.transformation[1][1])/Math.LN10-.3),xExp=1-Math.floor(Math.log(this.transformation[0][0])/Math.LN10-.3),yTick=Math.pow(10,yExp),xTick=Math.pow(10,xExp),xLen=Math.max(0,Math.min(20,-xExp)),yLen=Math.max(0,Math.min(20,-yExp));if(!this.options.axes)return this;if(this.options.axes.x&&line([[left,0],[right,0]],options,!0),this.options.axes.y&&line([[0,bottom],[0,top]],options,!0),this.options.axes.x){for(i=0;i>=left;i-=yTick)line([[i,-lengthY],[i,lengthY]],options,!0);for(i=yTick;right>=i;i+=yTick)line([[i,-lengthY],[i,lengthY]],options,!0)}if(this.options.axes.y){for(i=0;i>=bottom;i-=xTick)line([[-lengthX,i],[lengthX,i]],options,!0);for(i=xTick;top>=i;i+=xTick)line([[-lengthX,i],[lengthX,i]],options,!0)}if(this.options.axes.label){if(this.options.axes.x){for(i=-yTick;i>=left;i-=yTick)text(i.toFixed(yLen),i,-2*lengthY,textOptions,!0);for(i=yTick;right>=i;i+=yTick)text(i.toFixed(yLen),i,-2*lengthY,textOptions,!0)}if(this.options.axes.y){for(i=-xTick;i>=bottom;i-=xTick)text(i.toFixed(xLen),-2*lengthX,i,textOptions,!0);for(i=xTick;top>=i;i+=xTick)text(i.toFixed(xLen),-2*lengthX,i,textOptions,!0)}else text(0..toFixed(yLen),0,-2*lengthY,textOptions,!0)}return this},Screen2D.prototype.drawGrid=function(){var _this=this;if(!this.options.grid)return this;var i,ii,min,max,line=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.line.apply(_this.layer.grid,args)},circle=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return _this.renderer.circle.apply(_this.layer.grid,args)},top=-this.translation.y/this.scale.y,bottom=(this.height-this.translation.y)/this.scale.y,left=-this.translation.x/this.scale.x,right=(this.width-this.translation.x)/this.scale.x,yTick=Math.pow(10,1-Math.floor(Math.log(-this.transformation[1][1])/Math.LN10-.3)),xTick=Math.pow(10,1-Math.floor(Math.log(this.transformation[0][0])/Math.LN10-.3));if("cartesian"===this.options.grid.type){if(this.options.grid.x)for(i=left-left%xTick;right>=i;i+=xTick)line([[i,bottom],[i,top]],MathLib.extendObject(this.options.grid,this.options.grid.x),!0);if(this.options.grid.y)for(i=bottom-bottom%yTick;top>=i;i+=yTick)line([[left,i],[right,i]],MathLib.extendObject(this.options.grid,this.options.grid.y),!0)}else if("polar"===this.options.grid.type){if(max=Math.sqrt(Math.max(top*top,bottom*bottom)+Math.max(left*left,right*right)),min=0,this.options.grid.angle)for(i=0,ii=2*Math.PI;ii>i;i+=this.options.grid.angle.tick)line([[0,0],[max*Math.cos(i),max*Math.sin(i)]],MathLib.extendObject(this.options.grid,this.options.grid.angle),!0);if(this.options.grid.r)for(i=min;max>=i;i+=Math.min(xTick,yTick))circle(new MathLib.Circle([0,0,1],i),MathLib.extendObject(this.options.grid,this.options.grid.r),!0)}return this},Screen2D.prototype.getEventPoint=function(evt){var x,y;return evt.offsetX?(x=evt.offsetX,y=evt.offsetY):(x=evt.layerX,y=evt.layerY),"Canvas"===this.options.renderer&&(x/=window.devicePixelRatio,y/=window.devicePixelRatio),new MathLib.Point([x,y,1])},Screen2D.prototype.getLineEndPoints=function(l){if("line"===l.type){var top=-this.translation.y/this.scale.y,bottom=(this.height-this.translation.y)/this.scale.y,left=-this.translation.x/this.scale.x,right=(this.width-this.translation.x)/this.scale.x,lineRight=-(l[2]+l[0]*right)/l[1],lineTop=-(l[2]+l[1]*top)/l[0],lineLeft=-(l[2]+l[0]*left)/l[1],lineBottom=-(l[2]+l[1]*bottom)/l[0],points=[];return top>=lineRight&&lineRight>=bottom&&points.push([right,lineRight]),top>=lineLeft&&lineLeft>=bottom&&points.push([left,lineLeft]),right>lineTop&&lineTop>left&&points.push([lineTop,top]),right>lineBottom&&lineBottom>left&&points.push([lineBottom,bottom]),points}return l},Screen2D.prototype.onkeydown=function(evt){var keyCode,keyTable={Left:37,Up:38,Right:39,Down:40};if(evt.key){if(-1===["Up","Right","Down","Left"].indexOf(evt.key))return;keyCode=keyTable[evt.key]}else{if(!evt.keyCode)return;if(-1===[37,38,39,40].indexOf(evt.keyCode))return;keyCode=evt.keyCode}evt.preventDefault(),this.options.interaction.startTransformation=this.transformation.copy(),this.translation.x=this.options.interaction.startTransformation[0][2]-2*((evt.keyCode-38)%2),this.translation.y=this.options.interaction.startTransformation[1][2]-2*((evt.keyCode-39)%2),this.draw()
},Screen2D.prototype.onmousedown=function(evt){0===evt.button&&(evt.preventDefault(),this.options.interaction.allowPan&&!this.options.interaction.type&&(this.options.interaction.type="pan",this.options.interaction.startPoint=this.getEventPoint(evt),this.options.interaction.startTransformation=this.transformation.copy()))},Screen2D.prototype.onmousemove=function(evt){var p,devicePixelRatio=window.devicePixelRatio||1;evt.preventDefault(),"pan"===this.options.interaction.type&&(p=this.getEventPoint(evt).minus(this.options.interaction.startPoint),this.translation.x=this.options.interaction.startTransformation[0][2]+p[0]/devicePixelRatio,this.translation.y=this.options.interaction.startTransformation[1][2]+p[1]/devicePixelRatio,this.draw())},Screen2D.prototype.onmouseup=function(evt){evt.preventDefault(),"pan"===this.options.interaction.type&&(delete this.options.interaction.type,delete this.options.interaction.startPoint,delete this.options.interaction.startTransformation)},Screen2D.prototype.onmousewheel=function(evt){var delta,s,p,z;this.options.interaction.allowZoom&&(evt.preventDefault(),delta=evt.wheelDelta?evt.wheelDelta/360:evt.detail/-9,z=Math.pow(1+this.options.interaction.zoomSpeed,delta),p=this.transformation.inverse().times(this.getEventPoint(evt)),s=new MathLib.Matrix([[z,0,p[0]-p[0]*z],[0,z,p[1]-p[1]*z],[0,0,1]]),this.transformation=this.transformation.times(s),this.applyTransformation(),this.draw())},Screen2D.prototype.resize=function(width,height){var lookAtX=this.lookAt.x,lookAtY=this.lookAt.y;return this.height=height,this.width=width,"Canvas"===this.options.renderer?(this.layer.back.element.width=width,this.layer.back.element.height=height,this.layer.back.ctx.fillStyle="rgba(255, 255, 255, 0)",this.layer.grid.element.width=width,this.layer.grid.element.height=height,this.layer.grid.ctx.fillStyle="rgba(255, 255, 255, 0)",this.layer.grid.ctx.strokeStyle=MathLib.colorConvert(this.options.grid.color)||"#cccccc",this.layer.axes.element.width=width,this.layer.axes.element.height=height,this.layer.axes.ctx.fillStyle="rgba(255, 255, 255, 0)",this.layer.axes.ctx.strokeStyle=MathLib.colorConvert(this.options.axes.color)||"#000000",this.layer.main.element.width=width,this.layer.main.element.height=height,this.layer.main.ctx.fillStyle="rgba(255, 255, 255, 0)"):"SVG"===this.options.renderer&&(this.element.setAttribute("width",width+"px"),this.element.setAttribute("height",height+"px")),this.lookAt.x=lookAtX,this.lookAt.y=lookAtY,this.applyTransformation(),this.draw(),this},Screen2D}(MathLib.Screen);MathLib.Screen2D=Screen2D}(MathLib||(MathLib={}));var __extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},MathLib;!function(MathLib){"use strict";var to3js=function(x){return 2===x.length?new THREE.Vector2(x[0],x[1]):3===x.length?new THREE.Vector3(x[0],x[1],x[2]):void 0},Screen3D=function(_super){function Screen3D(id,options){function animate(){requestAnimationFrame(animate),render(),update()}function update(){controls.update()}function render(){renderer.render(scene,camera)}"undefined"==typeof options&&(options={}),_super.call(this,id,options),this.type="screen3D";var camera,renderer,controls,viewAngle,aspect,near,far,defaults={anaglyphMode:!1,axes:!0,background:16777215,camera:{lookAt:[0,0,0],position:[10,10,10]},grid:{xy:{angle:Math.PI/8,color:13421772,type:"none",tick:{x:1,y:1,r:1}},xz:{angle:Math.PI/8,color:13421772,type:"none",tick:{x:1,z:1,r:1}},yz:{angle:Math.PI/8,color:13421772,type:"none",tick:{y:1,z:1,r:1}}},height:500,renderer:"WebGL",width:500},opts=MathLib.extendObject(defaults,options),scene=new THREE.Scene;this.options=opts,this.scene=scene,viewAngle=45,aspect=opts.width/opts.height,near=.1,far=2e4,camera=new THREE.PerspectiveCamera(viewAngle,aspect,near,far),camera.position=to3js(opts.camera.position),camera.lookAt(to3js(opts.camera.lookAt)),camera.up=new THREE.Vector3(0,0,1),scene.add(camera),renderer=new THREE[opts.renderer+"Renderer"]({antialias:!0,preserveDrawingBuffer:!0}),this.wrapper.innerHTML="",this.wrapper.appendChild(renderer.domElement),opts.anaglyphMode&&(renderer=new THREE.AnaglyphEffect(renderer)),renderer.setSize(opts.width,opts.height),controls=opts.controls?new THREE[opts.controls+"Controls"](camera,renderer.domElement):{update:function(){}};var light1=new THREE.PointLight(16777215);light1.position.set(0,0,200),scene.add(light1);var light2=new THREE.PointLight(16777215);if(light2.position.set(0,0,-200),scene.add(light2),renderer.setClearColor(opts.background,1),renderer.clear(),opts.grid&&this.drawGrid(),opts.axes){var axes=new THREE.AxisHelper(10);scene.add(axes)}animate(),this.options=opts,this.element=renderer.domElement,this.renderer=renderer,this.camera=camera,this.container.className+=" MathLib_screen3D"}return __extends(Screen3D,_super),Screen3D.prototype.drawGrid=function(){if(!this.options.grid)return this;var _this=this,gridDrawer=function(opts,rotX,rotY){var i,ii,tickX,tickY,lines,circles,rays,size=10,grid=new THREE.Object3D,color=new THREE.Color(opts.color);if("cartesian"===opts.type){tickX="x"in opts.tick?opts.tick.x:opts.tick.y,tickY="z"in opts.tick?opts.tick.z:opts.tick.y,lines=new THREE.Shape;for(i=-size;size>=i;i+=tickX)lines.moveTo(-size,i),lines.lineTo(size,i);for(i=-size;size>=i;i+=tickY)lines.moveTo(i,-size),lines.lineTo(i,size);grid.add(new THREE.Line(lines.createPointsGeometry(),new THREE.LineBasicMaterial({color:color}),THREE.LinePieces)),grid.rotation.x=rotX,grid.rotation.y=rotY,_this.scene.add(grid)}else if("polar"===opts.type){for(circles=new THREE.Shape,rays=new THREE.Shape,i=0;size>=i;i+=opts.tick.r)circles.moveTo(i,0),circles.absarc(0,0,i,0,2*Math.PI+.001,!1);for(grid.add(new THREE.Line(circles.createPointsGeometry(),new THREE.LineBasicMaterial({color:color}))),i=0,ii=2*Math.PI;ii>i;i+=opts.angle)rays.moveTo(0,0),rays.lineTo(size*Math.cos(i),size*Math.sin(i));grid.add(new THREE.Line(rays.createPointsGeometry(),new THREE.LineBasicMaterial({color:color}))),grid.rotation.x=rotX,grid.rotation.y=rotY,_this.scene.add(grid)}};return gridDrawer(this.options.grid.xy,0,0),gridDrawer(this.options.grid.xz,Math.PI/2,0),gridDrawer(this.options.grid.yz,0,Math.PI/2),this},Screen3D.prototype.parametricPlot3D=function(f,options){var defaults={closed:!1,debug:!1,min:0,max:1,pointNum:1e3,radius:.05,segmentsRadius:6,material:{type:"MeshLambert"}},opts=MathLib.extendObject(defaults,options),Curve=THREE.Curve.create(function(){},function(t){t=(opts.max-opts.min)*t+opts.min;var ft=f(t);return new THREE.Vector3(ft[0],ft[1],ft[2])}),mesh=new THREE.Mesh(new THREE.TubeGeometry(new Curve,opts.pointNum,opts.radius,opts.segmentsRadius,opts.closed,opts.debug),new THREE[opts.material.type+"Material"](opts.material));return this.scene.add(mesh),this},Screen3D.prototype.plot3D=function(f,options){return this.surfacePlot3D(function(u,v){return[u,v,f(u,v)]},options)},Screen3D.prototype.resize=function(width,height){return this.renderer.setSize(width,height),this.camera.aspect=width/height,this.camera.updateProjectionMatrix(),this},Screen3D.prototype.surfacePlot3D=function(f,options){var mesh,defaults={material:{type:"MeshLambert"},pointNumX:100,pointNumY:100,xmin:0,xmax:1,ymin:0,ymax:1},opts=MathLib.extendObject(defaults,options),map=function(u,v){u=(opts.xmax-opts.xmin)*u+opts.xmin,v=(opts.ymax-opts.ymin)*v+opts.ymin;var fuv=f(u,v);return new THREE.Vector3(fuv[0],fuv[1],fuv[2])},material=new THREE[opts.material.type+"Material"](opts.material);return material.side=THREE.DoubleSide,mesh=new THREE.Mesh(new THREE.ParametricGeometry(map,opts.pointNumX,opts.pointNumY,!1),material),this.scene.add(mesh),this},Screen3D}(MathLib.Screen);MathLib.Screen3D=Screen3D}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Vector=function(){function Vector(coords){var _this=this;this.type="vector",Array.prototype.forEach.call(coords,function(x,i){_this[i]=x}),this.length=coords.length}return Vector.prototype.compare=function(v){var i,ii;if(this.length!==v.length)return MathLib.sign(this.length-v.length);for(i=0,ii=this.length;ii>i;i++)if(v[i]-this[i])return MathLib.sign(this[i]-v[i]);return 0},Vector.prototype.evaluate=function(){return this.map(MathLib.evaluate)},Vector.prototype.every=function(f){return Array.prototype.every.call(this,f)},Vector.prototype.forEach=function(f){Array.prototype.forEach.call(this,f)},Vector.prototype.isEqual=function(v){return this.length!==v.length?!1:this.every(function(x,i){return MathLib.isEqual(x,v[i])})},Vector.prototype.isZero=function(){return this.every(MathLib.isZero)},Vector.prototype.map=function(f){return new(MathLib[this.type.slice(0,1).toUpperCase()+this.type.slice(1)])(Array.prototype.map.call(this,f))},Vector.prototype.minus=function(v){if(this.length===v.length)return this.plus(v.negative());throw new MathLib.EvaluationError("Vector sizes not matching",{method:"Vector#minus"})},Vector.prototype.negative=function(){return this.map(function(entry){return MathLib.negative(entry)})},Vector.prototype.norm=function(p){return"undefined"==typeof p&&(p=2),2===p?MathLib.hypot.apply(null,this.toArray()):1/0===p?Math.max.apply(null,this.map(Math.abs).toArray()):MathLib.root(this.reduce(function(prev,curr){return prev+Math.pow(Math.abs(curr),p)},0),p)},Vector.prototype.outerProduct=function(v){return new MathLib.Matrix(this.map(function(x){return v.map(function(y){return MathLib.times(x,y)})}))},Vector.prototype.plus=function(v){if(this.length===v.length)return new MathLib.Vector(this.map(function(x,i){return MathLib.plus(x,v[i])}));throw new MathLib.EvaluationError("Vector sizes not matching",{method:"Vector#plus"})},Vector.prototype.reduce=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.reduce.apply(this,args)},Vector.prototype.scalarProduct=function(v){if(this.length===v.length)return this.reduce(function(old,cur,i,w){return MathLib.plus(old,MathLib.times(w[i],v[i]))},0);throw new MathLib.EvaluationError("Vector sizes not matching",{method:"Vector#scalarProduct"})},Vector.prototype.slice=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.slice.apply(this,args)},Vector.prototype.times=function(n){var i,ii,colVectors,product=[];if("rational"===n.type&&(n=n.coerceTo("number")),"number"==typeof n||"complex"===n.type)return this.map(function(x){return MathLib.times(n,x)});if("matrix"===n.type){if(this.length===n.rows){for(colVectors=n.toColVectors(),i=0,ii=colVectors.length;ii>i;i++)product[i]=this.scalarProduct(colVectors[i]);return new MathLib.Vector(product)}throw MathLib.EvaluationError("Vector/Matrix sizes not matching",{method:"Vector.prototype.times"})}},Vector.prototype.toArray=function(){return Array.prototype.slice.call(this)},Vector.prototype.toContentMathML=function(options){return"undefined"==typeof options&&(options={}),options.strict?this.reduce(function(old,cur){return old+MathLib.toContentMathML(cur,options)},'<apply><csymbol cd="linalg2">vector</csymbol>')+"</apply>":this.reduce(function(old,cur){return old+MathLib.toContentMathML(cur,options)},"<vector>")+"</vector>"},Vector.prototype.toLaTeX=function(options){return"undefined"==typeof options&&(options={}),"\\begin{pmatrix}\n	"+this.reduce(function(old,cur){return old+"\\\\\n	"+MathLib.toLaTeX(cur,options)})+"\n\\end{pmatrix}"},Vector.prototype.toMathML=function(options){return"undefined"==typeof options&&(options={}),this.reduce(function(old,cur){return old+"<mtr><mtd>"+MathLib.toMathML(cur,options)+"</mtd></mtr>"},"<mrow><mo>(</mo><mtable>")+"</mtable><mo>)</mo></mrow>"},Vector.prototype.toString=function(options){return"undefined"==typeof options&&(options={}),"("+this.reduce(function(old,cur){return old+", "+MathLib.toString(cur,options)})+")"},Vector.prototype.vectorProduct=function(v){if(3===this.length&&3===v.length)return new MathLib.Vector([MathLib.minus(MathLib.times(this[1],v[2]),MathLib.times(this[2],v[1])),MathLib.minus(MathLib.times(this[2],v[0]),MathLib.times(this[0],v[2])),MathLib.minus(MathLib.times(this[0],v[1]),MathLib.times(this[1],v[0]))]);throw new MathLib.EvaluationError("Vectors are not three-dimensional",{method:"Vector.prototype.vectorProduct"})},Vector.areLinearIndependent=function(vectors){var n=vectors.length,m=vectors[0].length;return n>m?!1:vectors.every(function(x){return x.length===m})?new MathLib.Matrix(vectors).rank()===n:void 0},Vector.zero=function(n){var i,vector=[];for(i=0;n>i;i++)vector.push(0);return new MathLib.Vector(vector)},Vector}();MathLib.Vector=Vector}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Circle=function(){function Circle(center,radius){this.type="circle",void 0===center.type&&(center=new MathLib.Point(center.concat(1))),this.center=center,this.radius=radius}return Circle.prototype.area=function(){return this.radius*this.radius*Math.PI},Circle.prototype.circumference=function(){return 2*this.radius*Math.PI},Circle.prototype.compare=function(circle){return MathLib.sign(this.center.compare(circle.center))||MathLib.sign(this.radius-circle.radius)},Circle.prototype.draw=function(screen,options){if(Array.isArray(screen)){var circle=this;screen.forEach(function(x){x.circle(circle,options)})}else screen.circle(this,options);return this},Circle.prototype.isEqual=function(circle){return MathLib.isEqual(this.radius,circle.radius)&&this.center.isEqual(circle.center)},Circle.prototype.positionOf=function(point){var diff;return"point"===point.type&&2===point.dimension?(diff=point.distanceTo(this.center)-this.radius,MathLib.isZero(diff)?"on":0>diff?"in":"out"):void 0},Circle.prototype.reflectAt=function(a){return new MathLib.Circle(this.center.reflectAt(a),this.radius)},Circle.prototype.toLaTeX=function(){return"B_{"+MathLib.toLaTeX(this.radius)+"}\\left("+this.center.toLaTeX()+"\\right)"},Circle.prototype.toMatrix=function(){var x=this.center[0]/this.center[2],y=this.center[1]/this.center[2],r=this.radius;return new MathLib.Matrix([[1,0,-x],[0,1,-y],[-x,-y,x*x+y*y-r*r]])},Circle}();MathLib.Circle=Circle}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Complex=function(){function Complex(re,im){"undefined"==typeof im&&(im=0),this.type="complex",MathLib.isNaN(re)||MathLib.isNaN(im)?(this.re=0/0,this.im=0/0):MathLib.isFinite(re)&&MathLib.isFinite(im)?(this.re=re,this.im=im):(this.re=1/0,this.im=1/0)}return Complex.characteristic=function(){return new MathLib.Integer(0)},Complex.toContentMathML=function(options){return"undefined"==typeof options&&(options={}),options.strict?'<csymbol cd="setname1">C</csymbol>':"<complexes/>"},Complex.toLaTeX=function(){return"Complex Field $\\mathbb{C}$"},Complex.toMathML=function(){return'<mrow><mtext>Complex Field</mtext><mi mathvariant="double-struck">C</mi></mrow>'},Complex.toString=function(){return"Complex Field ℂ"},Complex.prototype.abs=function(){return MathLib.hypot(this.re,this.im)},Complex.prototype.arccos=function(){return new MathLib.Complex(Math.PI/2,-0).minus(this.arcsin())},Complex.prototype.arccot=function(){return this.isZero()?new MathLib.Complex(MathLib.sign(1/this.re)*Math.PI/2,-this.im):this.inverse().arctan()},Complex.prototype.arccsc=function(){return this.isZero()?new MathLib.Complex(1/0):this.inverse().arcsin()},Complex.prototype.arcosh=function(){var arccos;return this.isZero()?new MathLib.Complex(0,1.5707963267948966):(arccos=this.arccos(),arccos=arccos.times(new MathLib.Complex(0,arccos.im>0?-1:1)),MathLib.isNegZero(this.im)&&this.re>=-1&&(arccos.im=-arccos.im),arccos)},Complex.prototype.arcoth=function(){var one=new MathLib.Complex(1,-0);if(MathLib.isZero(this.re)){if(MathLib.isPosZero(this.im))return new MathLib.Complex(this.re,-1.5707963267948966);if(MathLib.isNegZero(this.im))return new MathLib.Complex(this.re,1.5707963267948966)}return 1/0===this.re?new MathLib.Complex(0,0):MathLib.times(.5,this.plus(one).divide(this.minus(one)).ln())},Complex.prototype.arcsch=function(){return this.inverse().arsinh()},Complex.prototype.arcsec=function(){return this.isZero()?new MathLib.Complex(1/0):this.inverse().arccos()},Complex.prototype.arcsin=function(){var a=this.re,b=this.im,aa=a*a,bb=b*b,sqrt=Math.sqrt(Math.pow(aa+bb-1,2)+4*bb),sgn=function(x){return x>0?1:0>x?-1:1/x===1/0?1:1/x===-1/0?-1:void 0};return 1/0===a?new MathLib.Complex(1/0):new MathLib.Complex(sgn(a)/2*MathLib.arccos(sqrt-(aa+bb)),sgn(b)/2*MathLib.arcosh(sqrt+(aa+bb)))},Complex.prototype.arctan=function(){var res,one=new MathLib.Complex(1,-0),iz=new MathLib.Complex(-this.im,this.re);return this.isZero()?new MathLib.Complex(this.re,this.im):(res=MathLib.times(new MathLib.Complex(0,-.5),MathLib.plus(one,iz).divide(MathLib.minus(one,iz)).ln()),MathLib.isNegZero(this.re)&&1/0!==res.re&&(this.im<0||this.im>1)&&(res.re=-res.re),res)},Complex.prototype.arg=function(){return 1/0===this.re?0/0:Math.atan2(this.im,this.re)},Complex.prototype.arsech=function(){return 1/0===this.re?new MathLib.Complex(0/0):this.inverse().arcosh()},Complex.prototype.arsinh=function(){var a=this.re,b=this.im,aa=a*a,bb=b*b,sqrt=Math.sqrt(Math.pow(aa+bb-1,2)+4*aa),sgn=function(x){return x>0?1:0>x?-1:1/x===1/0?1:1/x===-1/0?-1:void 0};return 1/0===a?new MathLib.Complex(1/0):new MathLib.Complex(sgn(a)/2*MathLib.arcosh(sqrt+(aa+bb)),sgn(b)/2*MathLib.arccos(sqrt-(aa+bb)))},Complex.prototype.artanh=function(){var one=new MathLib.Complex(1,-0);return this.isZero()?new MathLib.Complex(this.re,this.im):1/0===this.re?new MathLib.Complex(0/0):MathLib.times(.5,MathLib.minus(one.plus(this).ln(),one.minus(this).ln()))},Complex.prototype.coerceTo=function(type){if("complex"===type)return this.copy();if(MathLib.isZero(this.im))return MathLib.coerceTo(this.re,type);throw"integer"===type?new MathLib.CoercionError("Cannot coerce the complex number to an integer, since the imaginary part is not zero.",{method:"Complex.prototype.coerceTo"}):"rational"===type?new MathLib.CoercionError("Cannot coerce the complex number to a rational number, since the imaginary part is not zero.",{method:"Complex.prototype.coerceTo"}):"number"===type?new MathLib.CoercionError("Cannot coerce the complex number to a number, since the imaginary part is not zero.",{method:"Complex.prototype.coerceTo"}):new MathLib.CoercionError('Cannot coerce the complex number to "'+type+'".',{method:"Complex.prototype.coerceTo"})},Complex.prototype.compare=function(x){var a=MathLib.sign(this.abs()-x.abs());return MathLib.isNaN(this.re)?MathLib.isNaN(x.re)?0:-1:1/0===this.re?1/0===x.re?0:1:a?a:MathLib.sign(this.arg()-x.arg())},Complex.prototype.conjugate=function(){return new MathLib.Complex(this.re,MathLib.negative(this.im))},Complex.prototype.copy=function(){return new MathLib.Complex(MathLib.copy(this.re),MathLib.copy(this.im))},Complex.prototype.cos=function(){return new MathLib.Complex(MathLib.cos(this.re)*MathLib.cosh(this.im),-MathLib.sin(this.re)*MathLib.sinh(this.im))},Complex.prototype.cosh=function(){return new MathLib.Complex(MathLib.cos(this.im)*MathLib.cosh(this.re),MathLib.sin(this.im)*MathLib.sinh(this.re))},Complex.prototype.cot=function(){var aa=2*this.re,bb=2*this.im,d=MathLib.cos(aa)-MathLib.cosh(bb);return this.isZero()?new MathLib.Complex(1/0):new MathLib.Complex(-MathLib.sin(aa)/d,MathLib.sinh(bb)/d)},Complex.prototype.coth=function(){var aa=2*this.re,bb=2*this.im,d=MathLib.cosh(aa)-MathLib.cos(bb);return this.isZero()?new MathLib.Complex(1/0):new MathLib.Complex(MathLib.sinh(aa)/d,-MathLib.sin(bb)/d)},Complex.prototype.csc=function(){var a=this.re,b=this.im,d=MathLib.cos(2*a)-MathLib.cosh(2*b);return this.isZero()?new MathLib.Complex(1/0):new MathLib.Complex(-2*MathLib.sin(a)*MathLib.cosh(b)/d,2*MathLib.cos(a)*MathLib.sinh(b)/d)},Complex.prototype.csch=function(){var a=this.re,b=this.im,d=MathLib.cosh(2*a)-MathLib.cos(2*b);return this.isZero()?new MathLib.Complex(1/0):new MathLib.Complex(2*MathLib.sinh(a)*MathLib.cos(b)/d,-2*MathLib.cosh(a)*MathLib.sin(b)/d)},Complex.prototype.divide=function(divisor){return this.times(MathLib.inverse(divisor))},Complex.prototype.exp=function(){return new MathLib.Complex(MathLib.exp(this.re)*MathLib.cos(this.im),MathLib.exp(this.re)*MathLib.sin(this.im))},Complex.prototype.inverse=function(){var d=MathLib.plus(MathLib.pow(this.re,2),MathLib.pow(this.im,2));return this.isZero()?new MathLib.Complex(1/0):1/0===this.re?new MathLib.Complex(0):new MathLib.Complex(MathLib.divide(this.re,d),MathLib.divide(MathLib.negative(this.im),d))},Complex.prototype.isEqual=function(n){return"complex"!==n.type?MathLib.isZero(this.im)?MathLib.isEqual.apply(null,MathLib.coerce(this.re,n)):!1:MathLib.isEqual(this.re,n.re)&&MathLib.isEqual(this.im,n.im)},Complex.prototype.isFinite=function(){return MathLib.isFinite(this.re)},Complex.prototype.isZero=function(){return MathLib.isZero(this.re)&&MathLib.isZero(this.im)},Complex.prototype.ln=function(){return 1/0===this.re?new MathLib.Complex(1/0):new MathLib.Complex(MathLib.ln(this.abs()),this.arg())},Complex.prototype.minus=function(subtrahend){return this.plus(MathLib.negative(subtrahend))},Complex.prototype.negative=function(){return new MathLib.Complex(MathLib.negative(this.re),MathLib.negative(this.im))},Complex.prototype.plus=function(summand){return"complex"!==summand.type?new MathLib.Complex(MathLib.plus.apply(null,MathLib.coerce(this.re,summand)),this.im):new MathLib.Complex(MathLib.plus(this.re,summand.re),MathLib.plus(this.im,summand.im))},Complex.prototype.pow=function(c){var re,im,abs,arg;if("complex"===MathLib.type(c))return re=c.re,im=c.im,abs=this.abs(),arg=this.arg(),!this.isZero()&&1/0!==this.re||c.isZero()||1/0===c.re||MathLib.isNaN(c.re)?MathLib.Complex.polar(MathLib.times(MathLib.pow(abs,re),MathLib.exp(MathLib.negative(MathLib.times(im,arg)))),MathLib.plus(MathLib.times(re,arg),MathLib.times(im,MathLib.ln(abs)))):new MathLib.Complex(this.re,this.im);var i,int=MathLib.floor(Math.abs(c)),res=new MathLib.Complex(1),power=this,bin=int.toString(2);if(c%1)return abs=this.abs(),arg=this.arg(),MathLib.Complex.polar(MathLib.pow(abs,c),MathLib.times(arg,c));if(MathLib.isZero(c))return new MathLib.Complex(1,c);for(i=bin.length-1;i>=0;i--)"1"===bin[i]&&(res=MathLib.times(res,power)),power=MathLib.times(power,power);return 0>c&&(res=res.inverse()),res},Complex.prototype.sec=function(){var a=this.re,b=this.im,d=MathLib.cos(2*a)+MathLib.cosh(2*b);return new MathLib.Complex(2*MathLib.cos(a)*MathLib.cosh(b)/d,2*MathLib.sin(a)*MathLib.sinh(b)/d)},Complex.prototype.sech=function(){var a=this.re,b=this.im,d=MathLib.cosh(2*a)+MathLib.cos(2*b);return new MathLib.Complex(2*MathLib.cosh(a)*MathLib.cos(b)/d,-2*MathLib.sinh(a)*MathLib.sin(b)/d)},Complex.prototype.sign=function(){return this.isZero()||MathLib.isNaN(this.re)?this:1/0===this.re?new MathLib.Complex(0/0):MathLib.Complex.polar(1,this.arg())},Complex.prototype.sin=function(){return new MathLib.Complex(MathLib.sin(this.re)*MathLib.cosh(this.im),MathLib.cos(this.re)*MathLib.sinh(this.im))},Complex.prototype.sinh=function(){return new MathLib.Complex(MathLib.cos(this.im)*MathLib.sinh(this.re),MathLib.sin(this.im)*MathLib.cosh(this.re))},Complex.prototype.sqrt=function(){return MathLib.Complex.polar(Math.sqrt(this.abs()),this.arg()/2)},Complex.prototype.tan=function(){var aa=2*this.re,bb=2*this.im,d=MathLib.cos(aa)+MathLib.cosh(bb);return new MathLib.Complex(MathLib.sin(aa)/d,MathLib.sinh(bb)/d)},Complex.prototype.tanh=function(){var aa=2*this.re,bb=2*this.im,d=MathLib.cosh(aa)+MathLib.cos(bb);return new MathLib.Complex(MathLib.sinh(aa)/d,MathLib.sin(bb)/d)},Complex.prototype.times=function(factor){return"complex"===factor.type?1/0===this.re?new MathLib.Complex(factor.isZero()||MathLib.isNaN(factor.re)?0/0:1/0):1/0===factor.re?new MathLib.Complex(this.isZero()||MathLib.isNaN(this.re)?0/0:1/0):new MathLib.Complex(MathLib.minus(MathLib.times(this.re,factor.re),MathLib.times(this.im,factor.im)),MathLib.plus(MathLib.times(this.re,factor.im),MathLib.times(this.im,factor.re))):("rational"===factor.type&&(factor=factor.coerceTo("number")),"number"==typeof factor?new MathLib.Complex(MathLib.times(this.re,factor),MathLib.times(this.im,factor)):void 0)},Complex.prototype.toContentMathML=function(){return this.isFinite()?"<apply><plus />"+MathLib.toContentMathML(this.re)+"<apply><times />"+MathLib.toContentMathML(this.im)+"<imaginaryi /></apply></apply>":'<csymbol cd="nums1">'+(1/0===this.re?"infinity":"NaN")+"</csymbol>"},Complex.prototype.toLaTeX=function(options){"undefined"==typeof options&&(options={});var option,str="",reFlag=!MathLib.isZero(this.re),passOptions={};if(!this.isFinite())return(options.sign?"+":"")+"\\text{Complex"+this.re+"}";if(!MathLib.isZero(this.im)){for(option in options)options.hasOwnProperty(option)&&"sign"!==option&&(passOptions[option]=options[option]);passOptions.sign=reFlag||options.sign,str+=MathLib.toLaTeX(this.im,passOptions)+"i"}return(reFlag||0===str.length)&&(str=MathLib.toLaTeX(this.re,options)+str),str},Complex.prototype.toMathML=function(options){"undefined"==typeof options&&(options={});var option,str="",reFlag=!MathLib.isZero(this.re),passOptions={};if(!this.isFinite())return(options.sign?"<mo>+</mo>":"")+"<mi>Complex"+this.re+"</mi>";if(!MathLib.isZero(this.im)){for(option in options)options.hasOwnProperty(option)&&"sign"!==option&&(passOptions[option]=options[option]);reFlag||options.sign?(passOptions.sign=!1,str+="<mo>"+MathLib.toString(this.im,{sign:!0}).slice(0,1)+"</mo><mrow>"+MathLib.toMathML(MathLib.abs(this.im),passOptions)+"<mo>&#x2062;</mo><mi>i</mi></mrow>"):str+="<mrow>"+MathLib.toMathML(this.im,passOptions)+"<mo>&#x2062;</mo><mi>i</mi></mrow>"}return(reFlag||0===str.length)&&(str=MathLib.toMathML(this.re,options)+str),str},Complex.prototype.toPoint=function(){return new MathLib.Point(1/0===this.re||MathLib.isNaN(this.re)?[0,0,0]:[this.re,this.im,1])},Complex.prototype.toString=function(options){"undefined"==typeof options&&(options={});var option,str="",reFlag=!MathLib.isZero(this.re),passOptions={};if(!this.isFinite())return(options.sign?"+":"")+"Complex"+this.re;if(!MathLib.isZero(this.im)){for(option in options)options.hasOwnProperty(option)&&"sign"!==option&&(passOptions[option]=options[option]);passOptions.sign=reFlag||options.sign,str+=MathLib.toString(this.im,passOptions)+"i"}return(reFlag||0===str.length)&&(str=MathLib.toString(this.re,options)+str),str},Complex.polar=function(abs,arg){return 1/0===abs?new MathLib.Complex(1/0):new MathLib.Complex(abs*Math.cos(arg),abs*Math.sin(arg))},Complex}();MathLib.Complex=Complex}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Integer=function(){function Integer(integer,options){"undefined"==typeof options&&(options={}),this.type="integer";var i,res,factor,blocksize,inputBase=options.base||10,base=Math.pow(2,26),data=[],sign="+";if(Array.isArray(integer)){for(i=integer.length-1;0===integer[i];)i--;data=integer.slice(0,i+1)}if("number"==typeof integer)if(0===integer)sign=MathLib.isPosZero(integer)?"+":"-",data.push(0);else for(0>integer&&(sign="-",integer=-integer);integer;)data.push(integer%base),integer=Math.floor(integer/base);else if("string"==typeof integer){for(("+"===integer[0]||"-"===integer[0])&&(sign=integer[0],integer=integer.slice(1)),data=[],blocksize=Math.floor(Math.log(Math.pow(2,53))/Math.log(inputBase));integer.length>blocksize;)data.push(new MathLib.Integer(parseInt(integer.slice(-blocksize),inputBase))),integer=integer.slice(0,-blocksize);for(data.push(new MathLib.Integer(parseInt(integer,inputBase))),res=data[data.length-1],factor=new MathLib.Integer(Math.pow(inputBase,blocksize)),i=data.length-2;i>=0;i--)res=res.times(factor).plus(data[i]);data=res.data}"sign"in options&&(sign=options.sign),this.data=data,this.sign=sign}return Integer.characteristic=function(){return new MathLib.Integer(0)},Integer.randomElement=function(start,end){var i,endMinusStart,arr=[],base=Math.pow(2,26);for(endMinusStart=1===arguments.length?start:end.minus(start),i=1;i<endMinusStart.data.length;i++)arr.push(Math.floor(Math.random()*base));return arr.push(Math.floor(Math.random()*(endMinusStart.data[endMinusStart.data.length-1]+1))),1===arguments.length?new MathLib.Integer(arr,{sign:start.sign}):new MathLib.Integer(arr).plus(start)},Integer.toContentMathML=function(options){return"undefined"==typeof options&&(options={}),options.strict?'<csymbol cd="setname1">Z</csymbol>':"<integers/>"},Integer.toLaTeX=function(){return"Integer Ring $\\mathbb{Z}$"},Integer.toMathML=function(){return'<mrow><mtext>Integer Ring</mtext><mi mathvariant="double-struck">Z</mi></mrow>'},Integer.toString=function(){return"Integer Ring ℤ"},Integer.prototype.abs=function(){return new MathLib.Integer(this.data,{sign:"+"})},Integer.prototype.ceil=function(){return this.copy()},Integer.prototype.coerceTo=function(type){var num;if("integer"===type)return this.copy();if("rational"===type)return new MathLib.Rational(this,1);if("complex"===type)return new MathLib.Complex(this,0);if("number"===type)return num=this.data.reduce(function(old,cur,i){return old+cur*Math.pow(1e7,i)},0),"-"===this.sign&&(num=-num),num;throw new MathLib.CoercionError('Cannot coerce the integer to "'+type+'".',{method:"Integer.prototype.coerceTo"})},Integer.prototype.compare=function(n){var i;if(this.sign!==n.sign)return this.isZero()&&n.isZero()?0:"+"===this.sign?1:-1;if(this.data.length!==n.data.length)return MathLib.sign("+"===this.sign?this.data.length-n.data.length:n.data.length-this.data.length);for(i=this.data.length-1;i>=0;i--)if(this.data[i]!==n.data[i])return MathLib.sign("+"===this.sign?this.data[i]-n.data[i]:n.data[i]-this.data[i]);return 0},Integer.prototype.conjugate=function(){return this.copy()},Integer.prototype.copy=function(){return new MathLib.Integer(this.data,{sign:this.sign})},Integer.prototype.digitSum=function(base){return"undefined"==typeof base&&(base=10),new MathLib.Integer(this.digits(base).reduce(function(x,y){return x+y}))},Integer.prototype.digits=function(base){"undefined"==typeof base&&(base=10);var div,rem,temp,factor=new MathLib.Integer(base),n=this.abs(),digits=[];if(n.isZero())return[0];for(;!n.isZero();)temp=n.divrem(factor),div=temp[0],rem=temp[1],digits.unshift(rem.data[0]),n=div;return digits},Integer.prototype.divide=function(divisor){var divrem;return"integer"!==divisor.type?MathLib.divide.apply(null,MathLib.coerce(this,divisor)):(divrem=this.divrem(divisor),divrem[1].isZero()?divrem[0]:new MathLib.Rational(this,divisor))},Integer.prototype.divrem=function(divisor){var main,subroutine,quot,mult,temp,rem,base=Math.pow(2,26);return subroutine=function(A,B){var q,T,temp,B1,n=A.data.length-1;return A.data[n]>=B.data[n-1]?(B1=B.copy(),B1.data.unshift(0),temp=subroutine(A.minus(B1),B),[temp[0].plus(new MathLib.Integer(base)),temp[1]]):(q=new MathLib.Integer(Math.min(Math.floor((A.data[n]*base+A.data[n-1])/B.data[n-1]),base-1)),T=B.times(q),1===T.compare(A)&&(q=q.minus(new MathLib.Integer(1)),T=T.minus(B)),1===T.compare(A)&&(q=q.minus(new MathLib.Integer(1)),T=T.minus(B)),[q,A.minus(T)])},main=function(A,B){var q,r,q1,r1,temp,A1,s,m=A.data.length-1,n=B.data.length-1;return n>m?[new MathLib.Integer(0),A.copy()]:m===n?-1===A.compare(B)?[new MathLib.Integer(0),A.copy()]:[new MathLib.Integer(1),A.minus(B)]:m===n+1?subroutine(A,B):(A1=new MathLib.Integer(A.data.slice(m-n-1)),s=new MathLib.Integer(A.data.slice(0,m-n-1)),temp=subroutine(A1,B),q1=temp[0],r1=temp[1],temp=main(new MathLib.Integer(s.data.concat(r1.data)),B),q=temp[0],r=temp[1],[new MathLib.Integer(q.data.concat(q1.data)),r])},this.isZero()?[new MathLib.Integer(0),new MathLib.Integer(0)]:(divisor.data[divisor.data.length-1]<base/2?(mult=new MathLib.Integer(Math.ceil(base/(2*divisor.data[divisor.data.length-1]))),temp=main(this.abs().times(mult),divisor.abs().times(mult)),quot=temp[0],rem=new MathLib.Integer(temp[1].data[0]/mult.data[0])):(temp=main(this.abs(),divisor.abs()),quot=temp[0],rem=temp[1]),"-"!==this.sign||rem.isZero()||(quot=quot.plus(new MathLib.Integer(1)),rem=divisor.abs().minus(rem)),this.sign!==divisor.sign&&(quot=quot.negative()),[quot,rem])
},Integer.prototype.factorial=function(){if(this.isZero())return new MathLib.Integer("1");if("-"===this.sign)return new MathLib.Complex(1/0);for(var factorial=this,n=this.minus(new MathLib.Integer("1"));!n.isZero();)factorial=factorial.times(n),n=n.minus(new MathLib.Integer("1"));return factorial},Integer.prototype.floor=function(){return this.copy()},Integer.prototype.isEqual=function(n){var i,ii;if("integer"!==n.type)return MathLib.isEqual(MathLib.coerce(this,n));if(this.sign!==n.sign)return this.isZero()&&n.isZero()?!0:!1;if(this.data.length!==n.data.length)return!1;for(i=0,ii=this.data.length;ii>i;i++)if(this.data[i]!==n.data[i])return!1;return!0},Integer.prototype.isFinite=function(){return!0},Integer.prototype.isNaN=function(){return!1},Integer.prototype.isUnit=function(){var i,ii;for(i=1,ii=this.data.length;ii>i;i++)if(0!==this.data[i])return!1;return 1===this.data[0]?!0:!1},Integer.prototype.isZero=function(){return this.data.every(function(x){return 0===x})},Integer.prototype.isqrt=function(){for(var y,two=new MathLib.Integer("2"),numberofbits=25*(this.data.length-1)+1+Math.log(this.data[this.data.length-1])/Math.log(2),x=new MathLib.Integer(2).pow(new MathLib.Integer(Math.ceil(numberofbits/2)));;){if(y=x.plus(this.divrem(x)[0]).divrem(two)[0],y.minus(x).isZero())return x;x=y}},Integer.prototype.minus=function(n){var i,ii,temp,resPos,A,B,data=[],carry=0,sign="+",base=Math.pow(2,26);if("integer"!==n.type)return MathLib.minus.apply(null,MathLib.coerce(this,n));if("-"===this.sign)return"-"===n.sign?n.negative().minus(this.negative()):(temp=this.negative().plus(n),temp.sign="-",temp);if("-"===n.sign)return this.plus(n.negative());if(this.data.length!==n.data.length){for(resPos=this.data.length>n.data.length;this.data.length<n.data.length;)this.data.push(0);for(;this.data.length>n.data.length;)n.data.push(0)}else{for(i=this.data.length-1;i>=0;i--)if(this.data[i]!==n.data[i]){resPos=this.data[i]>n.data[i];break}if("undefined"==typeof resPos)return new MathLib.Integer(0)}for(resPos?(A=this,B=n,sign="+"):(A=n,B=this,sign="-"),i=0,ii=A.data.length;ii>i;i++)temp=A.data[i]-B.data[i]+carry,carry=Math.floor(temp/base),data[i]=MathLib.mod(temp,base);return new MathLib.Integer(data,{sign:sign})},Integer.prototype.mod=function(n){return"integer"!==n.type?MathLib.mod.apply(null,MathLib.coerce(this,n)):this.divrem(n)[1]},Integer.prototype.negative=function(){return new MathLib.Integer(this.data,{sign:"-"===this.sign?"+":"-"})},Integer.prototype.plus=function(n){var i,ii,temp,data=[],carry=0,base=Math.pow(2,26);if("integer"!==n.type)return MathLib.plus(MathLib.coerce(this,n));if("-"===this.sign){if("+"===n.sign)return n.minus(this.negative())}else if("-"===n.sign)return this.minus(n.negative());if(this.data.length!==n.data.length){for(;this.data.length<n.data.length;)this.data.push(0);for(;this.data.length>n.data.length;)n.data.push(0)}for(i=0,ii=this.data.length;ii>i;i++)temp=this.data[i]+n.data[i]+carry,data[i]=temp%base,carry=Math.floor(temp/base);return 0!==carry&&(data[i]=carry),new MathLib.Integer(data,{sign:this.sign})},Integer.prototype.pow=function(exponent){var powInt,result;return"integer"!==exponent.type?MathLib.pow.apply(null,MathLib.coerce(this,exponent)):(powInt=function(b,e){var res,i,half=[],carry=0;if(1===e.data.length&&1===e.data[0])return b;for(i=e.data.length-1;i>=0;i--)half[i]=Math.floor(e.data[i]/2)+carry,carry=e.data[i]%2?5e6:0;return res=powInt(b,new MathLib.Integer(half)),res=res.times(res),e.data[0]%2&&(res=res.times(b)),res},exponent.isZero()?new MathLib.Integer(1):(result=powInt(this,exponent),"-"===exponent.sign?new MathLib.Rational(new MathLib.Integer("1"),result):result))},Integer.prototype.times=function(n){var i,ii,j,jj,temp,data=[],carry=0,base=Math.pow(2,26);if("integer"!==n.type)return MathLib.times(MathLib.coerce(this,n));for(i=0,ii=this.data.length;ii>i;i++)for(j=0,jj=n.data.length;jj>j;j++)void 0===data[i+j]?data[i+j]=this.data[i]*n.data[j]:data[i+j]+=this.data[i]*n.data[j];for(i=0,ii=this.data.length+n.data.length-1;ii>i;i++)temp=data[i]+carry,carry=Math.floor(temp/base),data[i]=temp%base;return data[i]=carry,new MathLib.Integer(data,{sign:this.sign===n.sign?"+":"-"})},Integer.prototype.toContentMathML=function(options){"undefined"==typeof options&&(options={});var base=options.base||10;return 10===base?'<cn type="integer">'+this.toString()+"</cn>":options.strict?'<apply><csymbol cd="nums1">based_integer</csymbol><cn>'+base+"</cn><cs>"+this.toString({base:base})+"</cs></apply>":'<cn type="integer" base="'+base+'">'+this.toString({base:base})+"</cn>"},Integer.prototype.toLaTeX=function(options){"undefined"==typeof options&&(options={});var option,str,base=options.base||10,passOptions={};for(option in options)options.hasOwnProperty(option)&&"baseSubscript"!==option&&(passOptions[option]=options[option]);return str=this.toString(passOptions),options.baseSubscript&&(str+="_{"+base+"}"),str},Integer.prototype.toMathML=function(options){"undefined"==typeof options&&(options={});var str,option,base=options.base||10,passOptions={};for(option in options)options.hasOwnProperty(option)&&"baseSubscript"!==option&&(passOptions[option]=options[option]);return str="<mn>"+this.toString(passOptions)+"</mn>",options.baseSubscript&&(str="<msub>"+str+"<mn>"+base+"</mn></msub>"),str},Integer.prototype.toString=function(options){"undefined"==typeof options&&(options={});var div,rem,temp,base=options.base||10,blocksize=Math.floor(Math.log(Math.pow(2,26)-1)/Math.log(base)),factor=new MathLib.Integer(Math.pow(base,blocksize)),n=this.abs(),str="";if(n.isZero())str="0";else{for(;!n.isZero();)temp=n.divrem(factor),div=temp[0],rem=temp[1],str=("000000"+rem.data[0].toString(base)).slice(-blocksize)+str,n=div;str=str.replace(/^0+/,""),"-"===this.sign&&(str="-"+str)}return options.sign&&("+"===this.sign||this.isZero())&&(str="+"+str),options.baseSubscript&&(base>9&&(str+="&#x208"+Math.floor(base/10)+";"),str+="&#x208"+base%10+";"),str},Integer}();MathLib.Integer=Integer}(MathLib||(MathLib={}));var __extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},MathLib;!function(MathLib){"use strict";var Line=function(_super){function Line(coords){_super.call(this,coords),this.type="line",this.dimension=2}return __extends(Line,_super),Line.prototype.draw=function(screen,options){if("undefined"==typeof options&&(options={}),Array.isArray(screen)){var line=this;screen.forEach(function(x){x.line(line,options)})}else screen.line(this,options);return this},Line.prototype.isEqual=function(l){var p=this.normalize();return l=l.normalize(),this.length!==l.length?!1:p.every(function(x,i){return MathLib.isEqual(x,l[i])})},Line.prototype.isFinite=function(){return!MathLib.isZero(this[0])||!MathLib.isZero(this[1])},Line.prototype.isParallelTo=function(l){return MathLib.isZero(this[0]*l[1]-this[1]*l[0])},Line.prototype.meet=function(l){var point,k=this;return 2===this.dimension&&2===l.dimension?(point=new MathLib.Point(this.vectorProduct(l).toArray()),Object.defineProperties(point,{0:{get:function(){return k[1]*l[2]-k[2]*l[1]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent point.",method:"Line#meet"})},enumerable:!0},1:{get:function(){return k[2]*l[0]-k[0]*l[2]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent point.",method:"Line#meet"})},enumerable:!0},2:{get:function(){return k[0]*l[1]-k[1]*l[0]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent point.",method:"Line#meet"})},enumerable:!0}}),point):void 0},Line.prototype.normalize=function(){var h=MathLib.hypot(this[0],this[1]);return 0!==h?this.map(function(x){return x/h}):new MathLib.Line([0,0,1])},Line.prototype.parallelThrough=function(p){var l=this,parallel=new MathLib.Line([0,0,0]);return Object.defineProperties(parallel,{0:{get:function(){return-l[0]*p[2]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent line.",method:"Line#parallelThrough"})},enumerable:!0},1:{get:function(){return-l[1]*p[2]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent line.",method:"Line#parallelThrough"})},enumerable:!0},2:{get:function(){return l[1]*p[1]+l[0]*p[0]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent line.",method:"Line#parallelThrough"})},enumerable:!0}}),parallel},Line}(MathLib.Vector);MathLib.Line=Line}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Matrix=function(){function Matrix(matrix){var _this=this;if(this.type="matrix","string"==typeof matrix){if(matrix.indexOf("<")>-1)return MathLib.Expression.parseContentMathML(matrix).evaluate();matrix=matrix.trim().replace(/;?\n/g,"],["),matrix=JSON.parse("[["+matrix+"]]")}matrix.forEach(function(x,i){_this[i]=x}),this.length=matrix.length,this.cols=matrix[0].length,this.rows=matrix.length}return Matrix.prototype.LU=function(){var i,j,k,t,p,LU=this.toArray(),m=this.rows,n=this.cols,permutation=[];for(k=0;n>k;k++){for(p=k,i=k+1;m>i;i++)Math.abs(LU[i][k])>Math.abs(LU[p][k])&&(p=i);if(p!==k&&(permutation.unshift([p,k]),t=LU[p],LU[p]=LU[k],LU[k]=t),0!==LU[k][k])for(i=k+1;m>i;i++)for(LU[i][k]=MathLib.divide(LU[i][k],LU[k][k]),j=k+1;n>j;j++)LU[i][j]=MathLib.minus(LU[i][j],MathLib.times(LU[i][k],LU[k][j]))}return LU=new MathLib.Matrix(LU),this.LU=function(){return LU},this.LUpermutation=new MathLib.Permutation(permutation),LU},Matrix.prototype.adjoint=function(){return this.map(function(entry){return MathLib.conjugate(entry)}).transpose()},Matrix.prototype.adjugate=function(){return this.map(function(x,r,c,m){return MathLib.times(m.remove(c,r).determinant(),1-(r+c)%2*2)})},Matrix.prototype.cholesky=function(){var i,ii,j,jj,k,kk,sum,choleskyMatrix,cholesky=[];for(i=0,ii=this.rows;ii>i;i++)cholesky.push([]);for(i=0,ii=this.rows;ii>i;i++){for(j=0;i>j;j++){for(sum=0,k=0,kk=j;kk>k;k++)sum=MathLib.plus(sum,MathLib.times(cholesky[i][k],cholesky[j][k]));cholesky[i][j]=(this[i][j]-sum)/cholesky[j][j]}for(sum=0,k=0,kk=j;kk>k;k++)sum=MathLib.plus(sum,MathLib.times(cholesky[i][k],cholesky[i][k]));for(cholesky[i][j]=Math.sqrt(this[j][j]-sum),j++,jj=this.cols;jj>j;j++)cholesky[i][j]=0}return choleskyMatrix=new MathLib.Matrix(cholesky),this.cholesky=function(){return choleskyMatrix},choleskyMatrix},Matrix.prototype.compare=function(m){var i,ii,j,jj;if(this.rows!==m.rows)return MathLib.sign(this.rows-m.rows);if(this.cols!==m.cols)return MathLib.sign(this.cols-m.cols);for(i=0,ii=this.rows;ii>i;i++)for(j=0,jj=this.cols;jj>j;j++)if(this[i][j]-m[i][j])return MathLib.sign(this[i][j]-m[i][j]);return 0},Matrix.prototype.copy=function(){return this.map(function(entry){return MathLib.copy(entry)})},Matrix.prototype.determinant=function(){var LU,determinant;if(!this.isSquare())throw new MathLib.EvaluationError("Determinant of non square matrix",{method:"Matrix.prototype.determinant"});return this.rank()<this.rows?determinant=0:(LU=this.LU(),determinant=MathLib.times(this.LUpermutation.sgn(),MathLib.times.apply(null,LU.diag()))),this.determinant=function(){return determinant},determinant},Matrix.prototype.diag=function(){var i,ii,diagonal=[];for(i=0,ii=Math.min(this.rows,this.cols);ii>i;i++)diagonal.push(this[i][i]);return diagonal},Matrix.prototype.divide=function(n){return this.times(MathLib.inverse(n))},Matrix.prototype.evaluate=function(){return this.map(MathLib.evaluate)},Matrix.prototype.every=function(f){return Array.prototype.every.call(this,function(x,i){return Array.prototype.every.call(x,function(y,j){return f(y,i,j,this)})})},Matrix.prototype.forEach=function(f){Array.prototype.forEach.call(this,function(x,i){return Array.prototype.forEach.call(x,function(y,j){return f(y,i,j,this)})})},Matrix.prototype.gershgorin=function(){var i,ii,c=[],rc=[],rr=[],circles=[];for(i=0,ii=this.rows;ii>i;i++)rc.push(0),rr.push(0);for(this.forEach(function(x,i,j){i===j?c.push(MathLib.is(x,"complex")?x.toPoint():new MathLib.Point([x,0,1])):(rc[j]+=MathLib.abs(x),rr[i]+=MathLib.abs(x))}),i=0,ii=this.rows;ii>i;i++)circles.push(new MathLib.Circle(c[i],Math.min(rc[i],rr[i])));return circles},Matrix.prototype.givens=function(){var c,s,rho,i,j,k,ri,rj,qi,qj,rows=this.rows,cols=this.cols,R=this.copy(),Q=MathLib.Matrix.identity(rows);for(i=0;cols>i;i++)for(j=i+1;rows>j;j++)if(!MathLib.isZero(R[j][i])){for(rho=(R[i][i]<0?-1:1)*MathLib.hypot(R[i][i],R[j][i]),c=R[i][i]/rho,s=R[j][i]/rho,ri=[],rj=[],qi=[],qj=[],k=0;cols>k;k++)ri.push(R[i][k]),rj.push(R[j][k]);for(k=0;cols>k;k++)R[i][k]=rj[k]*s+ri[k]*c,R[j][k]=rj[k]*c-ri[k]*s;for(k=0;rows>k;k++)qi.push(Q[k][i]),qj.push(Q[k][j]);for(k=0;rows>k;k++)Q[k][i]=qi[k]*c+qj[k]*s,Q[k][j]=-qi[k]*s+qj[k]*c}return[Q,R]},Matrix.prototype.inverse=function(){var i,ii,res,inverse,col=[],matrix=[],n=this.rows;if(!this.isSquare())throw MathLib.EvaluationError("Inverse of non square matrix",{method:"Matrix.prototype.inverse"});for(i=0,ii=n-1;ii>i;i++)matrix.push([]),col.push(0);for(matrix.push([]),col.push(1),col=col.concat(col).slice(0,-1),i=0,ii=n;ii>i;i++){if(res=this.solve(col.slice(n-i-1,2*n-i-1)),void 0===res)return;res.forEach(function(x,i){matrix[i].push(x)})}return inverse=new MathLib.Matrix(matrix),this.inverse=function(){return inverse},inverse},Matrix.prototype.isBandMatrix=function(l,u){return 1===arguments.length&&(u=l),this.every(function(x,i,j){return j>=i-l&&i+u>=j||MathLib.isZero(x)})},Matrix.prototype.isDiag=function(){var i,j,ii,jj;if(Number(this.hasOwnProperty("isUpper")&&this.isUpper())+Number(this.hasOwnProperty("isLower")&&this.isLower())+Number(this.hasOwnProperty("isSymmetric")&&this.isSymmetric())>1)return!0;for(i=0,ii=this.rows;ii>i;i++)for(j=0,jj=this.cols;jj>j;j++)if(i!==j&&!MathLib.isZero(this[i][j]))return!1;return!0},Matrix.prototype.isEqual=function(matrix){var i,j,ii,jj;if(this===matrix)return!0;if(this.rows===matrix.rows&&this.cols===matrix.cols){for(i=0,ii=this.rows;ii>i;i++)for(j=0,jj=this.cols;jj>j;j++)if(!MathLib.isEqual(this[i][j],matrix[i][j]))return!1;return!0}return!1},Matrix.prototype.isIdentity=function(){if(!this.isSquare())return!1;var isIdentity=this.every(function(x,r,c){return r===c?MathLib.isOne(x):MathLib.isZero(x)});return this.isIdentity=function(){return isIdentity},isIdentity},Matrix.prototype.isInvertible=function(){return this.isSquare()&&this.rank()===this.rows},Matrix.prototype.isLower=function(){return this.slice(0,-1).every(function(x,i){return x.slice(i+1).every(MathLib.isZero)})},Matrix.prototype.isNegDefinite=function(){return this.isSquare()?1===this.rows?this[0][0]<0:this.rows%2===0?this.determinant()>0&&this.remove(this.rows-1,this.cols-1).isNegDefinite():this.determinant()<0&&this.remove(this.rows-1,this.cols-1).isNegDefinite():void 0},Matrix.prototype.isOrthogonal=function(){return this.transpose().times(this).isIdentity()},Matrix.prototype.isPermutation=function(){var rows=[],cols=[];return this.every(function(x,r,c){return MathLib.isOne(x)?rows[r]||cols[c]?!1:(rows[r]=!0,cols[c]=!0,!0):MathLib.isZero(x)?!0:!1})&&rows.length===this.rows&&cols.length===this.cols},Matrix.prototype.isPosDefinite=function(){return this.isSquare()?1===this.rows?this[0][0]>0:this.determinant()>0&&this.remove(this.rows-1,this.cols-1).isPosDefinite():void 0},Matrix.prototype.isReal=function(){return this.every(MathLib.isReal)},Matrix.prototype.isScalar=function(){var i,ii,diag=this.diag;if(this.hasOwnProperty("isIdentity")&&this.hasOwnProperty("isZero"))return this.isIdentity()||this.isZero()?!0:!1;if(this.isDiag()){for(i=1,ii=this.rows;ii>i;i++)if(!MathLib.isEqual(diag[0],diag[i]))return!1;return!0}return!1},Matrix.prototype.isSquare=function(){return this.cols===this.rows},Matrix.prototype.isSymmetric=function(){var i,ii,j,jj,isSymmetric=!0;if(this.isSquare()){lp:for(i=0,ii=this.rows;ii>i;i++)for(j=i+1,jj=this.cols;jj>j;j++)if(!MathLib.isEqual(this[i][j],this[j][i])){isSymmetric=!1;break lp}}else isSymmetric=!1;return this.isSymmetric=function(){return isSymmetric},isSymmetric},Matrix.prototype.isUpper=function(){return this.slice(1).every(function(x,i){return x.slice(0,i+1).every(MathLib.isZero)})},Matrix.prototype.isVector=function(){return 1===this.rows||1===this.cols},Matrix.prototype.isZero=function(){var isZero=this.every(MathLib.isZero);return this.isZero=function(){return isZero},isZero},Matrix.prototype.map=function(f){var m=this;return new MathLib.Matrix(Array.prototype.map.call(this,function(x,i){return Array.prototype.map.call(x,function(y,j){return f(y,i,j,m)})}))},Matrix.prototype.minor=function(r,c){return this.remove(r,c).determinant()},Matrix.prototype.minus=function(subtrahend){if(this.rows===subtrahend.rows&&this.cols===subtrahend.cols)return this.plus(subtrahend.negative());throw MathLib.EvaluationError("Matrix sizes not matching",{method:"Matrix.prototype.minus"})},Matrix.prototype.negative=function(){var i,ii,negative=[];for(i=0,ii=this.rows;ii>i;i++)negative.push(this[i].map(function(entry){return MathLib.negative(entry)}));return new MathLib.Matrix(negative)},Matrix.prototype.plus=function(summand){var i,ii,j,jj,sum=[];if(this.rows===summand.rows&&this.cols===summand.cols){for(i=0,ii=this.rows;ii>i;i++)for(sum[i]=[],j=0,jj=this.cols;jj>j;j++)sum[i][j]=MathLib.plus(this[i][j],summand[i][j]);return new MathLib.Matrix(sum)}throw MathLib.EvaluationError("Matrix sizes not matching",{method:"Matrix.prototype.plus"})},Matrix.prototype.rank=function(){var i,j,rank=0,mat=this.rref();rankloop:for(i=Math.min(this.rows,this.cols)-1;i>=0;i--)for(j=this.cols-1;j>=i;j--)if(!MathLib.isZero(mat[i][j])){rank=i+1;break rankloop}return this.rank=function(){return rank},rank},Matrix.prototype.reduce=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.reduce.apply(this,args)},Matrix.prototype.remove=function(row,col){var rest=this.toArray();return(row||0===row)&&("number"==typeof row&&(row=[row]),rest=rest.filter(function(x,i){return-1===row.indexOf(i)})),(col||0===col)&&("number"==typeof col&&(col=[col]),col=col.sort().reverse(),col.forEach(function(n){rest=rest.map(function(x){return x.splice(n,1),x})})),new MathLib.Matrix(rest)},Matrix.prototype.rref=function(){var i,ii,j,jj,k,kk,pivot,factor,swap,lead=0,rref=this.toArray();for(i=0,ii=this.rows;ii>i;i++){if(this.cols<=lead)return new MathLib.Matrix(rref);for(j=i;0===rref[j][lead];)if(j++,this.rows===j&&(j=i,lead++,this.cols===lead))return new MathLib.Matrix(rref);for(i!==j&&(swap=rref[j],rref[j]=rref[i],rref[i]=swap),pivot=rref[i][lead],j=lead,jj=this.cols;jj>j;j++)rref[i][j]/=pivot;for(j=0,jj=this.rows;jj>j;j++)if(j!==i)for(factor=rref[j][lead],k=0,kk=this.cols;kk>k;k++)rref[j][k]=MathLib.minus(rref[j][k],MathLib.times(factor,rref[i][k]));lead++}return new MathLib.Matrix(rref)},Matrix.prototype.slice=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.slice.apply(this,args)},Matrix.prototype.solve=function(b){var i,j,LU=this.LU(),n=b.length,x=[],y=[];for(b=this.LUpermutation.applyTo(b),i=0;n>i;i++)for(y[i]=b[i],j=0;i>j;j++)y[i]=MathLib.minus(y[i],MathLib.times(LU[i][j],y[j]));for(i=n-1;i>=0;i--){for(x[i]=y[i],j=i+1;n>j;j++)x[i]=MathLib.minus(x[i],MathLib.times(LU[i][j],x[j]));if(0===LU[i][i]){if(0!==x[i])return void 0;x[i]=x[i]}else x[i]=MathLib.divide(x[i],LU[i][i])}return"array"===MathLib.type(b)?x:new b.constructor(x)},Matrix.prototype.some=function(f){return Array.prototype.some.call(this,function(x,i){return Array.prototype.some.call(x,function(y,j){return f(y,i,j,this)})})},Matrix.prototype.times=function(a){var i,ii,j,jj,k,kk,entry,product=[];if("rational"===a.type&&(a=a.coerceTo("number")),"number"==typeof a||"complex"===a.type)return this.map(function(x){return MathLib.times(x,a)});if("matrix"===a.type){if(this.cols===a.rows){for(i=0,ii=this.rows;ii>i;i++)for(product[i]=[],j=0,jj=a.cols;jj>j;j++){for(entry=0,k=0,kk=this.cols;kk>k;k++)entry=MathLib.plus(entry,MathLib.times(this[i][k],a[k][j]));product[i][j]=entry}return new MathLib.Matrix(product)}throw MathLib.EvaluationError("Matrix sizes not matching",{method:"Matrix#times"})}if(("point"===a.type||"vector"===a.type)&&this.cols===a.length){for(i=0,ii=this.rows;ii>i;i++){for(entry=0,j=0,jj=this.cols;jj>j;j++)entry=MathLib.plus(entry,MathLib.times(this[i][j],a[j]));product.push(entry)}return new a.constructor(product)}},Matrix.prototype.toArray=function(){return Array.prototype.map.call(this,function(x){return Array.prototype.map.call(x,function(y){return MathLib.copy(y)})})},Matrix.prototype.toColVectors=function(){return this.transpose().toRowVectors()},Matrix.prototype.toContentMathML=function(options){return"undefined"==typeof options&&(options={}),options.strict?this.reduce(function(str,x){return str+'<apply><csymbol cd="linalg2">matrixrow</csymbol>'+x.map(function(entry){return MathLib.toContentMathML(entry,options)}).join("")+"</apply>"},'<apply><csymbol cd="linalg2">matrix</csymbol>')+"</apply>":this.reduce(function(str,x){return str+"<matrixrow>"+x.map(function(entry){return MathLib.toContentMathML(entry,options)}).join("")+"</matrixrow>"},"<matrix>")+"</matrix>"},Matrix.prototype.toLaTeX=function(options){"undefined"==typeof options&&(options={});var passOptions={base:options.base,baseSubscript:options.baseSubscript};return"\\begin{pmatrix}\n"+this.reduce(function(str,x){return str+x.map(function(entry){return MathLib.toLaTeX(entry,passOptions)}).join(" & ")+"\\\n"},"").slice(0,-2)+"\n\\end{pmatrix}"},Matrix.prototype.toMathML=function(options){"undefined"==typeof options&&(options={});var passOptions={base:options.base,baseSubscript:options.baseSubscript};return this.reduce(function(str,x){return str+"<mtr><mtd>"+x.map(function(entry){return MathLib.toMathML(entry,passOptions)}).join("</mtd><mtd>")+"</mtd></mtr>"},"<mrow><mo> ( </mo><mtable>")+"</mtable><mo> ) </mo></mrow>"},Matrix.prototype.toRowVectors=function(){return this.toArray().map(function(v){return new MathLib.Vector(v)})},Matrix.prototype.toString=function(options){"undefined"==typeof options&&(options={});var passOptions={base:options.base,baseSubscript:options.baseSubscript};return this.reduce(function(str,x){return str+x.map(function(entry){return MathLib.toString(entry,passOptions)}).join("	")+"\n"},"").slice(0,-1)},Matrix.prototype.trace=function(){var trace=MathLib.plus.apply(null,this.diag());return this.trace=function(){return trace},trace},Matrix.prototype.transpose=function(){var transposedMatrix,row,i,j,ii,jj,transpose=[];for(i=0,ii=this.cols;ii>i;i++){for(row=[],j=0,jj=this.rows;jj>j;j++)row.push(this[j][i]);transpose.push(row)}return transposedMatrix=new MathLib.Matrix(transpose),this.transpose=function(){return transposedMatrix},transposedMatrix},Matrix.givensMatrix=function(n,i,k,phi){var givens=MathLib.Matrix.identity(n);return givens[k][k]=givens[i][i]=Math.cos(phi),givens[i][k]=Math.sin(phi),givens[k][i]=-givens[i][k],givens},Matrix.identity=function(n){var i,ii,row=[],matrix=[];for(n=n||1,i=0,ii=n-1;ii>i;i++)row.push(0);for(row.push(1),row=row.concat(row),row=row.slice(0,-1),i=0,ii=n;ii>i;i++)matrix.push(row.slice(n-i-1,2*n-i-1));return new MathLib.Matrix(matrix)},Matrix.numbers=function(n,r,c){var i,ii,row=[],matrix=[];for(i=0,ii=c||r||1;ii>i;i++)row.push(n);for(i=0,ii=r||1;ii>i;i++)matrix.push(row.slice(0));return new MathLib.Matrix(matrix)},Matrix.one=function(r,c){return"undefined"==typeof r&&(r=1),"undefined"==typeof c&&(c=r),MathLib.Matrix.numbers(1,r,c)},Matrix.random=function(r,c){var row,i,j,ii,jj,matrix=[];for(i=0,ii=r||1;ii>i;i++){for(row=[],j=0,jj=c||r||1;jj>j;j++)row.push(Math.random());matrix.push(row)}return new MathLib.Matrix(matrix)},Matrix.zero=function(r,c){return"undefined"==typeof r&&(r=1),"undefined"==typeof c&&(c=r),MathLib.Matrix.numbers(0,r,c)},Matrix}();MathLib.Matrix=Matrix}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Permutation=function(){function Permutation(p){var _this=this;this.type="permutation";var cycle,permutation;Array.isArray(p[0])?(cycle=p,permutation=Permutation.cycleToList(cycle)):(permutation=p,cycle=Permutation.listToCycle(permutation)),permutation.forEach(function(x,i){_this[i]=x}),this.length=permutation.length,this.cycle=cycle}return Permutation.cycleToList=function(cycle){var index,cur,i,ii,j,jj,max,list=[];for(max=cycle.map(function(b){return Math.max.apply(null,b)}),max=Math.max.apply(null,max),i=0,ii=max;ii>=i;i++){for(cur=i,j=0,jj=cycle.length;jj>j;j++)index=cycle[j].indexOf(cur),++index&&(cur=cycle[j][index%cycle[j].length]);list.push(cur)}return list},Permutation.listToCycle=function(list){var cur,i,ii,cycle,finished=[],cycles=[];for(i=0,ii=list.length;ii>i;i++){for(cur=i,cycle=[];!finished[cur];)finished[cur]=!0,cycle.push(cur),cur=list[cur];cycle.length&&cycles.push(cycle)}return cycles},Permutation.prototype.applyTo=function(n){var p,permutatedObj;return"number"==typeof n?n>=this.length?n:this[n]:(p=this,permutatedObj=n.map(function(x,i){return n[p.applyTo(i)]}),void 0===n.type?permutatedObj:new n.constructor(permutatedObj))},Permutation.prototype.compare=function(p){var i,ii;if(this.length!==p.length)return MathLib.sign(this.length-p.length);for(i=0,ii=this.length;ii>i;i++)if(p[i]-this[i])return MathLib.sign(this[i]-p[i]);return 0},Permutation.prototype.inverse=function(){var cycle=this.cycle.slice(0);return cycle.reverse().forEach(function(e){e.reverse()}),new MathLib.Permutation(cycle)},Permutation.prototype.map=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return new MathLib.Permutation(Array.prototype.map.apply(this,args))},Permutation.prototype.sgn=function(){var i,ii,count=0;for(i=0,ii=this.cycle.length;ii>i;i++)count+=this.cycle[i].length;return count+=this.cycle.length,-2*(count%2)+1},Permutation.prototype.times=function(p){var a=this;return p.map(function(x){return a[x]})},Permutation.prototype.toMatrix=function(n){var index,i,ii,row=[],matrix=[];for(n=n||this.length,i=0,ii=n-1;ii>i;i++)row.push(0);for(row=row.concat([1]).concat(row),i=0,ii=n;ii>i;i++)index=n-this.applyTo(i)-1,matrix.push(row.slice(index,index+n));return new MathLib.Matrix(matrix)},Permutation.prototype.toString=function(){var str="";return this.cycle.forEach(function(elem){str+="("+elem.toString()+")"}),str},Permutation.id=new Permutation([[]]),Permutation}();MathLib.Permutation=Permutation}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Conic=function(){function Conic(primal,dual){this.type="conic","matrix"!==primal.type&&(primal=new MathLib.Matrix(primal)),this.primal=primal,primal.rank()>1?Object.defineProperties(this,{dual:{get:function(){return this.primal.adjugate()},set:function(){},enumerable:!0,configurable:!0}}):this.dual=dual}return Conic.throughFivePoints=function(p,q,r,s,t){var conic=new MathLib.Conic(new MathLib.Matrix([[1,0,0],[0,1,0],[0,0,1]]));return Object.defineProperties(conic,{primal:{get:function(){var G=p.vectorProduct(r).outerProduct(q.vectorProduct(s)),H=p.vectorProduct(s).outerProduct(q.vectorProduct(r)),M=G.times(t.times(H).scalarProduct(t)).minus(H.times(t.times(G).scalarProduct(t)));return M.transpose().plus(M)},set:function(){},enumerable:!0,configurable:!0}}),conic},Conic.prototype.draw=function(screen,options,redraw){if("undefined"==typeof options&&(options={}),"undefined"==typeof redraw&&(redraw=!1),Array.isArray(screen)){var conic=this;screen.forEach(function(x){conic.draw(x,options)})}else{options.from=0,options.to=2*Math.PI,options.conic=this;var lines,alpha,cos,sin,sgn,a=this.primal[0][0],b=2*this.primal[0][1],c=this.primal[1][1],d=2*this.primal[0][2],e=2*this.primal[1][2],disc=4*a*c-b*b,rank=this.primal.rank(),cx=(b*e-2*c*d)/(4*a*c-b*b),cy=(b*d-2*a*e)/(4*a*c-b*b),normalForm=this.normalize(),A=Math.sqrt(Math.abs(normalForm.primal[2][2]/normalForm.primal[0][0])),C=Math.sqrt(Math.abs(normalForm.primal[2][2]/normalForm.primal[1][1]));if(3===rank){if(alpha=Math.atan2(b,a-c)/2,cos=Math.cos(alpha),sin=Math.sin(alpha),0===disc){options.from=-10,options.to=10;var param=-this.primal[1][2]/(2*this.primal[0][0]);cx=0,cy=this.primal[2][2]/this.primal[0][0],screen.path([function(t){return cx+cos*param*t*t-2*sin*param*t},function(t){return cy+sin*param*t*t+2*cos*param*t}],options,redraw)}else if(disc>0)options.from=0,options.to=2*Math.PI,screen.path([function(t){return cx+cos*Math.cos(t)*A-sin*Math.sin(t)*C},function(t){return cy+sin*Math.cos(t)*A+cos*Math.sin(t)*C}],options,redraw);else if(0>disc){if(options.from=0,options.to=2*Math.PI,sgn=function(t){return 2*+((t+Math.PI/2)%(2*Math.PI)<Math.PI)-1},normalForm.primal[2][2]*normalForm.primal[0][0]>0){var swap=A;A=C,C=swap,cos=Math.cos(alpha+Math.PI/2),sin=Math.sin(alpha+Math.PI/2)}else cos=Math.cos(alpha),sin=Math.sin(alpha);screen.path([function(t){return cx+cos*MathLib.sec(t)*A-sin*MathLib.tan(t)*C*sgn(t)},function(t){return cy+sin*MathLib.sec(t)*A+cos*MathLib.tan(t)*C*sgn(t)}],options,redraw)}}else 2===rank?(lines=this.splitDegenerated(),screen.line(lines[0],options),screen.line(lines[1],options)):1===rank&&(lines=this.splitDegenerated(),screen.line(lines[0],options))}return this},Conic.prototype.eccentricity=function(){var normalform=this.normalize(),a=normalform.primal[0][0],c=normalform.primal[1][1];return this.isDegenerated()?void 0:0===c?1:Math.sqrt(c>0?1-c/a:1-a/c)},Conic.prototype.isDegenerated=function(){return 3!==this.primal.rank()},Conic.prototype.isEqual=function(conic){if(this===conic)return!0;var compare=function(M,N){var i,j,m,n;if(M===N)return!0;nonZeroSearch:for(i=0;3>i;i++)for(j=0;3>j;j++)if(0!==M[i][j])break nonZeroSearch;if(0===N[i][j])return!1;for(m=M[i][j],n=N[i][j],i=0;3>i;i++)for(j=0;3>j;j++)if(n/m*M[i][j]!==N[i][j])return!1;return!0};return compare(this.primal,conic.primal)&&compare(this.dual,conic.dual)},Conic.prototype.latusRectum=function(){var normalForm=this.normalize(),a=normalForm.primal[0][0],c=normalForm.primal[1][1],min=Math.min(Math.abs(a),Math.abs(c)),max=Math.max(Math.abs(a),Math.abs(c));return this.isDegenerated()?void 0:0===c?-2*normalForm.primal[1][2]/a:2*Math.sqrt(max)/min},Conic.prototype.linearEccentricity=function(){var normalForm=this.normalize(),a=normalForm.primal[0][0],c=normalForm.primal[1][1],max=Math.max(Math.abs(a),Math.abs(c)),min=Math.min(Math.abs(a),Math.abs(c));return this.isDegenerated()?void 0:0===c?normalForm.primal[1][2]/(-2*a):Math.sqrt(c>0?1/min-1/max:1/max+1/min)},Conic.prototype.meet=function(x){var B,C,alpha,i,j,p1,p2,Ml,a,b,c,d,Delta0,Delta1,lambda,degenerated,lines,A=this.primal;if("line"===x.type){var setter=function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent point.",method:"Conic#meet"})},recalculate=function(){Ml=new MathLib.Matrix([[0,x[2],-x[1]],[-x[2],0,x[0]],[x[1],-x[0],0]]),B=Ml.transpose().times(A).times(Ml),alpha=MathLib.isZero(x[0])?MathLib.isZero(x[1])?Math.sqrt(B[1][0]*B[0][1]-B[0][0]*B[1][1])/x[2]:Math.sqrt(B[0][2]*B[2][0]-B[2][2]*B[0][0])/x[1]:Math.sqrt(B[2][1]*B[1][2]-B[1][1]*B[2][2])/x[0],C=Ml.times(alpha).plus(B);nonZeroSearch:for(i=0;3>i;i++)for(j=0;3>j;j++)if(0!==C[i][j])break nonZeroSearch};return recalculate(),p1=new MathLib.Point(C[i]),Object.defineProperties(p1,{0:{get:function(){return recalculate(),C[i][0]},set:setter,enumerable:!0},1:{get:function(){return recalculate(),C[i][1]},set:setter,enumerable:!0},2:{get:function(){return recalculate(),C[i][2]},set:setter,enumerable:!0}}),p2=new MathLib.Point([C[0][j],C[1][j],C[2][j]]),Object.defineProperties(p2,{0:{get:function(){return recalculate(),C[0][j]},set:setter,enumerable:!0},1:{get:function(){return recalculate(),C[1][j]},set:setter,enumerable:!0},2:{get:function(){return recalculate(),C[2][j]},set:setter,enumerable:!0}}),[p1,p2]}return"conic"===x.type?(B=x.primal,a=A.determinant(),b=new MathLib.Matrix([A[0],A[1],B[2]]).plus(new MathLib.Matrix([A[0],B[1],A[2]])).plus(new MathLib.Matrix([B[0],A[1],A[2]])).determinant(),c=new MathLib.Matrix([A[0],B[1],B[2]]).plus(new MathLib.Matrix([B[0],A[1],B[2]])).plus(new MathLib.Matrix([B[0],B[1],A[2]])).determinant(),d=B.determinant(),Delta0=b*b-3*a*c,Delta1=2*b*b-9*a*b*c+27*a*a*d,C=MathLib.cbrt((Delta1+Math.sqrt(Math.pow(Delta1,2)-4*Math.pow(Delta0,3)))/2),lambda=-(b+C+Delta0/C)/(3*a),degenerated=new MathLib.Conic(B.times(lambda).plus(A)),lines=degenerated.splitDegenerated(),this.meet(lines[0]).concat(this.meet(lines[1]))):void 0
},Conic.prototype.normalize=function(){var A=this.primal[0][0],B=2*this.primal[0][1],C=this.primal[1][1],D=2*this.primal[0][2],E=2*this.primal[1][2],F=this.primal[2][2],r=Math.atan2(B,A-C)/2,cos=Math.cos(r),sin=Math.sin(r),a=A*cos*cos+B*sin*cos+C*sin*sin,c=A*sin*sin-B*sin*cos+C*cos*cos,d=D*cos+E*sin,e=E*cos-D*sin,f=F;return 0!==a&&(f+=-d*d/(4*a),d=0),0!==c&&(f+=-e*e/(4*c),e=0),0!==f&&(a=-a/f,c=-c/f,d=-d/f,e=-e/f,f=-1),new MathLib.Conic(new MathLib.Matrix([[a,0,d/2],[0,c,e/2],[d/2,e/2,f]]))},Conic.prototype.polarity=function(x){var object,m,c=this;return"line"===x.type?(object=new MathLib.Point([0,0,0]),m="dual"):"point"===x.type&&(object=new MathLib.Line([0,0,0]),m="primal"),Object.defineProperties(object,{0:{get:function(){return c[m][0][0]*x[0]+c[m][0][1]*x[1]+c[m][0][2]*x[2]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent "+object.type+".",method:"Conic#polarity"})},enumerable:!0},1:{get:function(){return c[m][1][0]*x[0]+c[m][1][1]*x[1]+c[m][1][2]*x[2]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent "+object.type+".",method:"Conic#polarity"})},enumerable:!0},2:{get:function(){return c[m][2][0]*x[0]+c[m][2][1]*x[1]+c[m][2][2]*x[2]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent "+object.type+".",method:"Conic#polarity"})},enumerable:!0}}),object},Conic.prototype.splitDegenerated=function(){var n,i,j,B,C,p0,p1,p2,rank=this.primal.rank(),nonZeroSearch=function(C){for(i=0;3>i;i++)for(j=0;3>j;j++)if(0!==C[i][j])return};return 2===rank?(n=0!==this.dual[0][0]?0:0!==this.dual[1][1]?1:2,B=this.dual[n][n]<0?this.dual.negative():this.dual,p0=B[0][n]/Math.sqrt(B[n][n]),p1=B[1][n]/Math.sqrt(B[n][n]),p2=B[2][n]/Math.sqrt(B[n][n]),C=this.primal.plus(new MathLib.Matrix([[0,p2,-p1],[-p2,0,p0],[p1,-p0,0]])),nonZeroSearch(C),[new MathLib.Line(C[i]),new MathLib.Line([C[0][j],C[1][j],C[2][j]])]):1===rank?(nonZeroSearch(this.primal),[new MathLib.Line(this.primal[i]),new MathLib.Line(this.primal[i])]):void 0},Conic}();MathLib.Conic=Conic}(MathLib||(MathLib={}));var __extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},MathLib;!function(MathLib){"use strict";var Point=function(_super){function Point(coords){_super.call(this,arguments.length>1?Array.prototype.slice.call(arguments).concat(1):coords),this.type="point",this.dimension=2}return __extends(Point,_super),Point.prototype.crossRatio=function(a,b,c,d){var xa=this.vectorProduct(a),xb=this.vectorProduct(b);return xa.scalarProduct(c)*xb.scalarProduct(d)/(xa.scalarProduct(d)*xb.scalarProduct(c))},Point.prototype.distanceTo=function(p){return 0===arguments.length?MathLib.hypot.apply(null,this.slice(0,-1))/Math.abs(this[this.dimension]):"point"===p.type&&this.dimension===p.dimension?MathLib.hypot.apply(null,this.normalize().minus(p.normalize()).slice(0,-1)):void 0},Point.prototype.draw=function(screen,options){if("undefined"==typeof options&&(options={}),Array.isArray(screen)){var point=this;screen.forEach(function(x){x.point(point,options)})}else screen.point(this,options);return this},Point.prototype.isEqual=function(q){var p=this.normalize();return q=q.normalize(),this.length!==q.length?!1:p.every(function(x,i){return MathLib.isEqual(x,q[i])})},Point.prototype.isFinite=function(){return!MathLib.isZero(this[this.length-1])},Point.prototype.join=function(q){var line,p=this;return 2===this.dimension&&2===q.dimension?(line=new MathLib.Line(this.vectorProduct(q).toArray()),Object.defineProperties(line,{0:{get:function(){return p[1]*q[2]-p[2]*q[1]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent line.",method:"Point#join"})},enumerable:!0},1:{get:function(){return p[2]*q[0]-p[0]*q[2]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent line.",method:"Point#join"})},enumerable:!0},2:{get:function(){return p[0]*q[1]-p[1]*q[0]},set:function(){MathLib.warning({message:"Trying to change the coordinates of a completely dependent line.",method:"Point#join"})},enumerable:!0}}),line):void 0},Point.prototype.normalize=function(){var last=this[this.dimension]||1;return this.map(function(x){return x/last})},Point.prototype.reflectAt=function(q){var i,ii,reflectedPoint=[],p=this.normalize();if("point"===q.type&&this.dimension===q.dimension){for(q=q.normalize(),i=0,ii=this.dimension;ii>i;i++)reflectedPoint.push(2*q[i]-p[i]);return reflectedPoint.push(1),new MathLib.Point(reflectedPoint)}},Point.prototype.restrictTo=function(l){var p=this.slice();Object.defineProperties(this,{0:{get:function(){return l[1]*l[1]*p[0]-l[0]*(l[1]*p[1]+l[2]*p[2])},set:function(point){p[0]=point},enumerable:!0,configurable:!0},1:{get:function(){return-l[1]*l[2]*p[2]+l[0]*(l[0]*p[1]-l[1]*p[0])},set:function(point){p[1]=point},enumerable:!0,configurable:!0},2:{get:function(){return l[1]*l[1]*p[2]+l[0]*l[0]*p[2]},set:function(point){p[2]=point},enumerable:!0,configurable:!0}})},Point.prototype.toComplex=function(){return 2===this.dimension?MathLib.isZero(this[2])?new MathLib.Complex(1/0):new MathLib.Complex(this[0]/this[2],this[1]/this[2]):void 0},Point.prototype.toLaTeX=function(opt){"undefined"==typeof opt&&(opt=!1);var p=opt?this.toArray():this.normalize().slice(0,-1);return"\\begin{pmatrix}"+p.reduce(function(old,cur){return old+"\\\\"+MathLib.toLaTeX(cur)})+"\\end{pmatrix}"},Point.prototype.toMathML=function(opt){"undefined"==typeof opt&&(opt=!1);var p=opt?this.toArray():this.normalize().slice(0,-1);return p.reduce(function(old,cur){return old+"<mtr><mtd>"+MathLib.toMathML(cur)+"</mtd></mtr>"},"<mrow><mo>(</mo><mtable>")+"</mtable><mo>)</mo></mrow>"},Point.prototype.toString=function(opt){"undefined"==typeof opt&&(opt=!1);var p=opt?this.toArray():this.normalize().slice(0,-1);return"("+p.reduce(function(old,cur){return old+", "+MathLib.toString(cur)})+")"},Point.I=new Point([new MathLib.Complex(0,-1),0,1]),Point.J=new Point([new MathLib.Complex(0,1),0,1]),Point}(MathLib.Vector);MathLib.Point=Point}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Polynomial=function(){function Polynomial(polynomial){var _this=this;this.type="polynomial";var coefficients=[];if(void 0===polynomial||0===polynomial.length)polynomial=[0];else if("number"==typeof polynomial){for(;polynomial--;)coefficients.push(0);coefficients.push(1),polynomial=coefficients}polynomial.forEach(function(x,i){_this[i]=x}),this.length=polynomial.length,this.deg=polynomial.length-1,this.subdeg=function(a){var i=0;if(a.length>1||a[0]){for(;i<a.length&&MathLib.isZero(a[i]);)i++;return i}return 1/0}(polynomial)}return Polynomial.interpolation=function(a,b){var basisPolynomial,i,j,interpolant=new MathLib.Polynomial([0]),n=a.length;for(2===arguments.length&&(a=a.map(function(x,i){return[x,b[i]]})),i=0;n>i;i++){for(basisPolynomial=new MathLib.Polynomial([1]),j=0;n>j;j++)i!==j&&(basisPolynomial=basisPolynomial.times(new MathLib.Polynomial([-a[j][0]/(a[i][0]-a[j][0]),1/(a[i][0]-a[j][0])])));interpolant=interpolant.plus(basisPolynomial.times(a[i][1]))}return interpolant},Polynomial.regression=function(x,y){var m,c,i,length=x.length,xy=0,xi=0,yi=0,x2=0;if(2===arguments.length)for(i=0;length>i;i++)xy+=x[i]*y[i],xi+=x[i],yi+=y[i],x2+=x[i]*x[i];else for(i=0;length>i;i++)xy+=x[i][0]*x[i][1],xi+=x[i][0],yi+=x[i][1],x2+=x[i][0]*x[i][0];return m=(length*xy-xi*yi)/(length*x2-xi*xi),c=(yi*x2-xy*xi)/(length*x2-xi*xi),new MathLib.Polynomial([c,m])},Polynomial.roots=function(zeros){var elemSymPoly,i,ii,coef=[];for("array"===MathLib.type(zeros)&&(zeros=new MathLib.Set(zeros)),elemSymPoly=zeros.powerset(),i=0,ii=zeros.card;ii>i;i++)coef[i]=0;return elemSymPoly.slice(1).forEach(function(x){coef[ii-x.card]=MathLib.plus(coef[ii-x.card],x.times())}),coef=coef.map(function(x,i){return(ii-i)%2?MathLib.negative(x):x}),coef.push(1),new MathLib.Polynomial(coef)},Polynomial.prototype.compare=function(p){var i,ii;if(this.length!==p.length)return MathLib.sign(this.length-p.length);for(i=0,ii=this.length;ii>i;i++)if(p[i]-this[i])return MathLib.sign(this[i]-p[i]);return 0},Polynomial.prototype.differentiate=function(n){"undefined"==typeof n&&(n=1);var i,ii,derivative=[];if(0===n)return this;for(i=0,ii=this.deg-n;ii>=i;i++)derivative[i]=MathLib.times(this[i+n],MathLib.fallingFactorial(i+n,n));return new MathLib.Polynomial(derivative)},Polynomial.prototype.draw=function(screen,options){return"undefined"==typeof options&&(options={}),this.toFunctn().draw(screen,options)},Polynomial.prototype.every=function(f){return Array.prototype.every.call(this,f)},Polynomial.prototype.forEach=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];Array.prototype.forEach.apply(this,args)},Polynomial.prototype.integrate=function(n){"undefined"==typeof n&&(n=1);var i,ii,antiderivative=[];if(MathLib.isZero(n))return this;for(i=0;n>i;i++)antiderivative.push(0);for(i=0,ii=this.deg;ii>=i;i++)antiderivative[i+n]=this[i]/MathLib.fallingFactorial(i+n,n);return new MathLib.Polynomial(antiderivative)},Polynomial.prototype.isEqual=function(p){var i,ii;if(this.deg!==p.deg||this.subdeg!==p.subdeg)return!1;for(i=0,ii=this.deg;ii>=i;i++)if(!MathLib.isEqual(this[i],p[i]))return!1;return!0},Polynomial.prototype.map=function(f){return new MathLib.Polynomial(Array.prototype.map.call(this,f))},Polynomial.prototype.negative=function(){return new MathLib.Polynomial(this.map(function(entry){return MathLib.negative(entry)}))},Polynomial.prototype.plus=function(a){var i,plus=[];if("number"==typeof a)plus=this.slice(),plus[0]=MathLib.plus(plus[0],a);else if("polynomial"===a.type){for(i=0;i<=Math.min(this.deg,a.deg);i++)plus[i]=MathLib.plus(this[i],a[i]);plus=plus.concat((this.deg>a.deg?this:a).slice(i))}return new MathLib.Polynomial(plus)},Polynomial.prototype.slice=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.slice.apply(this,args)},Polynomial.prototype.times=function(a){var i,ii,j,jj,product=[];if("polynomial"===a.type){for(i=0,ii=this.deg;ii>=i;i++)for(j=0,jj=a.deg;jj>=j;j++)product[i+j]=MathLib.plus(product[i+j]?product[i+j]:0,MathLib.times(this[i],a[j]));return new MathLib.Polynomial(product)}return"rational"===a.type&&(a=a.coerceTo("number")),this.map(function(b){return MathLib.times(a,b)})},Polynomial.prototype.toContentMathML=function(){var i,str='<apply><csymbol cd="arith1">plus</csymbol>';for(i=this.deg;i>=0;i--)MathLib.isZero(this[i])||(str+=0===i?MathLib.toContentMathML(this[i]):'<apply><csymbol cd="arith1">times</csymbol>'+MathLib.toContentMathML(this[i],!0),i>1?str+='<apply><csymbol cd="arith1">power</csymbol><ci>x</ci>'+MathLib.toContentMathML(i)+"</apply></apply>":1===i&&(str+="<ci>x</ci></apply>"));return str+="</apply>"},Polynomial.prototype.toExpression=function(){var sum,i,content=[];for(i=this.deg;i>=0;i--)MathLib.isZero(this[i])||(i>1?content.push(new MathLib.Expression({subtype:"naryOperator",value:"^",name:"pow",content:[new MathLib.Expression({subtype:"naryOperator",content:[new MathLib.Expression({subtype:"number",value:this[i].toString()}),new MathLib.Expression({subtype:"variable",value:"x"})],value:"*",name:"times"}),new MathLib.Expression({subtype:"number",value:i.toString()})]})):1===i?content.push(new MathLib.Expression({subtype:"naryOperator",content:[new MathLib.Expression({subtype:"number",value:this[i].toString()}),new MathLib.Expression({subtype:"variable",value:"x"})],value:"*",name:"times"})):0===i&&content.push(new MathLib.Expression({subtype:"number",value:this[i].toString()})));return sum=new MathLib.Expression({content:content,subtype:"naryOperator",value:"+",name:"plus"}),new MathLib.Expression({subtype:"functionDefinition",args:["x"],content:[sum]})},Polynomial.prototype.toFunctn=function(){var i,ii,str="";for(i=0,ii=this.deg;ii>=i;i++)MathLib.isZero(this[i])||(str+=0===i?MathLib.toString(this[i]):MathLib.toString(this[i],{sign:!0}),i>1?str+=" * Math.pow(x, "+MathLib.toString(i)+")":1===i&&(str+=" * x"));return MathLib.Functn(new Function("x","return "+str),{expression:this.toExpression()})},Polynomial.prototype.toLaTeX=function(){var i,str=MathLib.toString(this[this.deg])+"x^{"+this.deg+"}";for(i=this.deg-1;i>=0;i--)MathLib.isZero(this[i])||(str+=MathLib.toLaTeX(this[i],{sign:!0}),i>1?str+="x^{"+MathLib.toLaTeX(i)+"}":1===i&&(str+="x"));return str},Polynomial.prototype.toMathML=function(){var i,str="<mrow>"+MathLib.toMathML(this[this.deg])+"<mo>&#x2062;</mo><msup><mi>x</mi>"+MathLib.toMathML(this.deg)+"</msup>";for(i=this.deg-1;i>=0;i--)MathLib.isZero(this[i])||(str+=MathLib.toMathML(this[i],{sign:!0}),i>1?str+="<mo>&#x2062;</mo><msup><mi>x</mi>"+MathLib.toMathML(i).slice(6,-7)+"</msup>":1===i&&(str+="<mo>&#x2062;</mo><mi>x</mi>"));return str+="</mrow>"},Polynomial.prototype.toString=function(){var i,str=MathLib.toString(this[this.deg])+"*x^"+this.deg;for(i=this.deg-1;i>=0;i--)MathLib.isZero(this[i])||(str+=MathLib.toString(this[i],{sign:!0}),i>1?str+="*x^"+MathLib.toString(i):1===i&&(str+="*x"));return str},Polynomial.prototype.valueAt=function(x){var i,ii,pot=MathLib.is(x,"matrix")?MathLib.Matrix.identity(x.rows):1,value=MathLib.is(x,"matrix")?MathLib.Matrix.zero(x.rows,x.cols):0;for(i=0,ii=this.deg;ii>=i;i++)value=MathLib.plus(value,MathLib.times(this[i],pot)),pot=MathLib.times(pot,x);return value},Polynomial.one=new Polynomial([1]),Polynomial.zero=new Polynomial([0]),Polynomial}();MathLib.Polynomial=Polynomial}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Rational=function(){function Rational(numerator,denominator){if("undefined"==typeof denominator&&(denominator=1),this.type="rational",MathLib.isZero(denominator))throw new MathLib.EvaluationError("The denominator of a rational number cannot be zero.",{method:"Rational.constructor"});if(MathLib.isNaN(numerator))throw new MathLib.EvaluationError("The numerator of a rational number cannot be NaN.",{method:"Rational.constructor"});if(MathLib.isNaN(denominator))throw new MathLib.EvaluationError("The denominator of a rational number cannot be NaN.",{method:"Rational.constructor"});("number"==typeof denominator&&0>denominator||"integer"===denominator.type&&"-"===denominator.sign)&&(numerator=MathLib.negative(numerator),denominator=MathLib.negative(denominator)),this.numerator=numerator,this.denominator=denominator}return Rational.characteristic=function(){return new MathLib.Integer(0)},Rational.toContentMathML=function(options){return"undefined"==typeof options&&(options={}),options.strict?'<csymbol cd="setname1">Q</csymbol>':"<rationals/>"},Rational.toLaTeX=function(){return"Rational Field $\\mathbb{Q}$"},Rational.toMathML=function(){return'<mrow><mtext>Rational Field</mtext><mi mathvariant="double-struck">Q</mi></mrow>'},Rational.toString=function(){return"Rational Field ℚ"},Rational.prototype.coerceTo=function(type){if("integer"===type){if(1===this.denominator)return new MathLib.Integer(this.numerator);throw new MathLib.CoercionError("Cannot coerce the rational number to an integer, since the denominator is not 1.",{method:"Rational.prototype.coerceTo"})}if("rational"===type)return this.copy();if("complex"===type)return new MathLib.Complex(this,0);if("number"===type)return this.numerator/this.denominator;throw new MathLib.CoercionError('Cannot coerce the rational number to "'+type+'".',{method:"Rational.prototype.coerceTo"})},Rational.prototype.compare=function(rational){return MathLib.sign(this.numerator*rational.denominator-this.denominator*rational.numerator)},Rational.prototype.copy=function(){return new MathLib.Rational(MathLib.copy(this.numerator),MathLib.copy(this.denominator))},Rational.prototype.divide=function(divisor){return"rational"===divisor.type?new MathLib.Rational(MathLib.times(this.numerator,divisor.denominator),MathLib.times(this.denominator,divisor.numerator)):"number"==typeof divisor?new MathLib.Rational(this.numerator,MathLib.times(this.denominator,divisor)):divisor.inverse().times(this)},Rational.prototype.inverse=function(){return MathLib.isZero(this.numerator)?void 0:new MathLib.Rational(this.denominator,this.numerator)},Rational.prototype.isEqual=function(n){return"rational"!==n.type?MathLib.isEqual.apply(null,MathLib.coerce(this,n)):MathLib.isEqual(MathLib.times(this.numerator,n.denominator),MathLib.times(this.denominator,n.numerator))},Rational.prototype.isZero=function(){return MathLib.isZero(this.numerator)},Rational.prototype.minus=function(subtrahend){return"rational"!==subtrahend.type?MathLib.minus.apply(null,MathLib.coerce(this,subtrahend)):new MathLib.Rational(MathLib.minus(MathLib.times(this.numerator,subtrahend.denominator),MathLib.times(this.denominator,subtrahend.numerator)),MathLib.times(this.denominator,subtrahend.denominator))},Rational.prototype.negative=function(){return new MathLib.Rational(-this.numerator,this.denominator)},Rational.prototype.plus=function(summand){return"rational"!==summand.type?MathLib.plus.apply(null,MathLib.coerce(this,summand)):new MathLib.Rational(MathLib.plus(MathLib.times(this.denominator,summand.numerator),MathLib.times(this.numerator,summand.denominator)),MathLib.times(this.denominator,summand.denominator))},Rational.prototype.reduce=function(){var gcd=MathLib.sign(this.denominator)*MathLib.gcd([this.numerator,this.denominator]);return new MathLib.Rational(this.numerator/gcd,this.denominator/gcd)},Rational.prototype.times=function(factor){return"rational"===factor.type?new MathLib.Rational(MathLib.times(this.numerator,factor.numerator),MathLib.times(this.denominator,factor.denominator)):"number"==typeof factor?new MathLib.Rational(MathLib.times(this.numerator,factor),this.denominator):factor.times(this)},Rational.prototype.toContentMathML=function(options){"undefined"==typeof options&&(options={});var base;return options.strict?'<apply><csymbol cd="nums1">rational</csymbol>'+MathLib.toContentMathML(this.numerator,options)+MathLib.toContentMathML(this.denominator,options)+"</apply>":(base=options.base||10,'<cn type="rational"'+(10!==base?' base="'+base+'"':"")+">"+MathLib.toString(this.numerator,{base:base})+"<sep/>"+MathLib.toString(this.denominator,{base:base})+"</cn>")},Rational.prototype.toLaTeX=function(options){"undefined"==typeof options&&(options={});var numerator,option,str="",passOptions={};for(option in options)options.hasOwnProperty(option)&&"sign"!==option&&(passOptions[option]=options[option]);return options.sign?(str=MathLib.toString(this.numerator,{sign:!0}).slice(0,1),numerator=MathLib.toLaTeX(MathLib.abs(this.numerator),passOptions)):numerator=MathLib.toLaTeX(this.numerator,passOptions),str+"\\frac{"+numerator+"}{"+MathLib.toLaTeX(this.denominator,passOptions)+"}"},Rational.prototype.toMathML=function(options){"undefined"==typeof options&&(options={});var numerator,option,str="",passOptions={};for(option in options)options.hasOwnProperty(option)&&"sign"!==option&&(passOptions[option]=options[option]);return options.sign?(str="<mo>"+MathLib.toString(this.numerator,{sign:!0}).slice(0,1)+"</mo>",numerator=MathLib.toMathML(MathLib.abs(this.numerator),passOptions)):numerator=MathLib.toMathML(this.numerator,passOptions),str+"<mfrac>"+numerator+MathLib.toMathML(this.denominator,passOptions)+"</mfrac>"},Rational.prototype.toString=function(options){"undefined"==typeof options&&(options={});var option,passOptions={};for(option in options)options.hasOwnProperty(option)&&"sign"!==option&&(passOptions[option]=options[option]);return MathLib.toString(this.numerator,options)+"/"+MathLib.toString(this.denominator,passOptions)},Rational}();MathLib.Rational=Rational}(MathLib||(MathLib={}));var MathLib;!function(MathLib){"use strict";var Set=function(){function Set(elements){var _this=this;this.type="set",this.intersect=Set.createSetOperation(!1,!0,!1),this.union=Set.createSetOperation(!0,!0,!0),this.without=Set.createSetOperation(!0,!1,!1),this.xor=Set.createSetOperation(!0,!1,!0),elements||(elements=[]),elements=elements.sort(MathLib.compare).filter(function(x,i,a){return a.length===i+1||!MathLib.isEqual(x,a[i+1])||"undefined"!=typeof x.isEqual&&!x.isEqual(a[i+1])}),elements.forEach(function(x,i){_this[i]=x}),this.length=elements.length,this.card=elements.length}return Set.prototype.compare=function(x){var a,i,ii;if(this.card!==x.card)return MathLib.sign(this.card-x.card);for(i=0,ii=this.card;ii>i;i++)if(a=MathLib.compare(this[i],x[i]),0!==a)return a;return 0},Set.prototype.evaluate=function(){return this.map(MathLib.evaluate)},Set.prototype.every=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.every.apply(this,args)},Set.prototype.filter=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return new MathLib.Set(Array.prototype.filter.apply(this,args))},Set.prototype.forEach=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];Array.prototype.forEach.apply(this,args)},Set.prototype.indexOf=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.indexOf.apply(this,args)},Set.prototype.insert=function(x){var i=this.locate(x);return this[i]!==x&&(this.splice(i,0,x),this.card++),this},Set.prototype.isEmpty=function(){return 0===this.card},Set.prototype.isEqual=function(set){return this.card!==set.card?!1:this.every(function(y,i){return MathLib.isEqual(y,set[i])})},Set.prototype.isSubsetOf=function(set){return this.every(function(x){return-1!==set.indexOf(x)})},Set.prototype.locate=function(x){var middle,left=0,right=this.card-1,i=this.indexOf(x);if(-1!==i)return i;for(;right>=left;)if(middle=left+Math.floor((right-left)/2),this[middle]<x)left=middle+1;else{if(!(this[middle]>x))return middle;right=middle-1}return left},Set.prototype.map=function(callback,thisArg){return new MathLib.Set(Array.prototype.map.call(this,callback,thisArg))},Set.prototype.plus=function(n){var sum=[];return"set"===n.type?(this.forEach(function(x){n.forEach(function(y){sum.push(MathLib.plus(x,y))})}),new MathLib.Set(sum)):this.map(function(x){return MathLib.plus(x,n)})},Set.prototype.powerset=function(){var flag,subset,i,ii,j,jj,powerset=[];for(i=0,ii=Math.pow(2,this.card);ii>i;i++){for(flag=i.toString(2).split("").reverse(),subset=[],j=0,jj=this.card;jj>j;j++)"1"===flag[j]&&subset.push(this[j]);powerset.push(new MathLib.Set(subset))}return new MathLib.Set(powerset)},Set.prototype.reduce=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.reduce.apply(this,arguments)},Set.prototype.remove=function(element){var i=this.indexOf(element);return-1!==i&&(this.splice(i,1),this.card--),this},Set.prototype.slice=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.slice.apply(this,args)},Set.prototype.some=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.some.apply(this,args)},Set.prototype.splice=function(){for(var args=[],_i=0;_i<arguments.length-0;_i++)args[_i]=arguments[_i+0];return Array.prototype.splice.apply(this,args)},Set.prototype.times=function(n){return this.map(function(x){return MathLib.times(x,n)})},Set.prototype.toArray=function(){return Array.prototype.slice.call(this)},Set.prototype.toContentMathML=function(options){return"undefined"==typeof options&&(options={}),options.strict?this.isEmpty()?'<csymbol cd="set1">emptyset</csymbol>':this.reduce(function(old,cur){return old+MathLib.toContentMathML(cur,options)},'<apply><csymbol cd="set1">set</csymbol>')+"</apply>":this.isEmpty()?"<emptyset/>":this.reduce(function(old,cur){return old+MathLib.toContentMathML(cur,options)},"<set>")+"</set>"},Set.prototype.toLaTeX=function(options){return"undefined"==typeof options&&(options={}),this.isEmpty()?"\\emptyset":this.reduce(function(old,cur){return old+MathLib.toLaTeX(cur,options)+", "},"\\left{").slice(0,-2)+"\\right}"},Set.prototype.toMathML=function(options){return"undefined"==typeof options&&(options={}),this.isEmpty()?"<mi>&#x2205;</mi>":this.reduce(function(old,cur){return old+MathLib.toMathML(cur,options)+"<mo>,</mo>"},"<mrow><mo>{</mo>").slice(0,-10)+"<mo>}</mo></mrow>"},Set.prototype.toString=function(options){return"undefined"==typeof options&&(options={}),this.isEmpty()?"∅":this.reduce(function(old,cur){return old+MathLib.toString(cur,options)+", "},"{").slice(0,-2)+"}"},Set.prototype.total=function(){return MathLib.plus.apply(null,this.toArray())},Set.createSetOperation=function(left,both,right){return function(a){for(var set=[],i=0,j=0,tl=this.card,al=a.card;tl>i&&al>j;)MathLib.compare(this[i],a[j])<0?(left&&set.push(this[i]),i++):MathLib.compare(this[i],a[j])>0?(right&&set.push(a[j]),j++):MathLib.isEqual(this[i],a[j])&&(both&&set.push(this[i]),i++,j++);return left&&j===al?set=set.concat(this.slice(i)):right&&i===tl&&(set=set.concat(a.slice(j))),new MathLib.Set(set)}},Set.fromTo=function(start,end,step){"undefined"==typeof step&&(step=1);var i,set=[];if(end>=start){for(i=start;end>=i;i+=step)set.push(i);return new MathLib.Set(set)}},Set}();MathLib.Set=Set}(MathLib||(MathLib={}));
/* script.js */
for(fn in MathLib)
	window[fn] = MathLib[fn];
var size = Math.min(window.innerWidth, window.innerHeight);
var canvas = new MathLib.Screen2D("canvas", {
	range: {
		x: 10,
		y: 10
	},
	width: size,
	height: size
});
var i = 0;
functions.forEach(function(funcStr) {
	eval("function func(x) { return " + funcStr + "; }");
	var hue = 270 / functions.length * i++;
	canvas.path(func, {
		lineColor: "hsl(" + hue + ", 100%, 35%)"
	});
}, this);